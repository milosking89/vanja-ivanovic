import './polyfills.server.mjs';
import{a as K,b as Ce,c as De,f as I,g as zT}from"./chunk-S6TB4KAW.mjs";var be=I(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});un.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=un.DEFAULT_MAX_SEND_MESSAGE_LENGTH=un.Propagate=un.LogVerbosity=un.Status=void 0;var LM=(function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n})(LM||(un.Status=LM={})),BM=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.ERROR=2]="ERROR",n[n.NONE=3]="NONE",n})(BM||(un.LogVerbosity=BM={})),VM=(function(n){return n[n.DEADLINE=1]="DEADLINE",n[n.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",n[n.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",n[n.CANCELLATION=8]="CANCELLATION",n[n.DEFAULTS=65535]="DEFAULTS",n})(VM||(un.Propagate=VM={}));un.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;un.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var vE=I((Jhe,wq)=>{wq.exports={name:"@grpc/grpc-js",version:"1.9.15",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.186","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","@typescript-eslint/eslint-plugin":"^5.59.11","@typescript-eslint/parser":"^5.59.11","@typescript-eslint/typescript-estree":"^5.59.11","clang-format":"^1.0.55",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^10.9.1",typescript:"^5.1.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.8","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var Ue=I(Ft=>{"use strict";var EE,_E,CE,bE;Object.defineProperty(Ft,"__esModule",{value:!0});Ft.isTracerEnabled=Ft.trace=Ft.log=Ft.setLoggerVerbosity=Ft.setLogger=Ft.getLogger=void 0;var ai=be(),Iq=De("process"),Aq=vE().version,Nq={error:(n,...e)=>{console.error("E "+n,...e)},info:(n,...e)=>{console.error("I "+n,...e)},debug:(n,...e)=>{console.error("D "+n,...e)}},Ts=Nq,jo=ai.LogVerbosity.ERROR,Mq=(_E=(EE=process.env.GRPC_NODE_VERBOSITY)!==null&&EE!==void 0?EE:process.env.GRPC_VERBOSITY)!==null&&_E!==void 0?_E:"";switch(Mq.toUpperCase()){case"DEBUG":jo=ai.LogVerbosity.DEBUG;break;case"INFO":jo=ai.LogVerbosity.INFO;break;case"ERROR":jo=ai.LogVerbosity.ERROR;break;case"NONE":jo=ai.LogVerbosity.NONE;break;default:}var Rq=()=>Ts;Ft.getLogger=Rq;var xq=n=>{Ts=n};Ft.setLogger=xq;var Oq=n=>{jo=n};Ft.setLoggerVerbosity=Oq;var kq=(n,...e)=>{let t;if(n>=jo){switch(n){case ai.LogVerbosity.DEBUG:t=Ts.debug;break;case ai.LogVerbosity.INFO:t=Ts.info;break;case ai.LogVerbosity.ERROR:t=Ts.error;break}t||(t=Ts.error),t&&t.bind(Ts)(...e)}};Ft.log=kq;var Pq=(bE=(CE=process.env.GRPC_NODE_TRACE)!==null&&CE!==void 0?CE:process.env.GRPC_TRACE)!==null&&bE!==void 0?bE:"",SE=new Set,UM=new Set;for(let n of Pq.split(","))n.startsWith("-")?UM.add(n.substring(1)):SE.add(n);var Fq=SE.has("all");function Lq(n,e,t){jM(e)&&(0,Ft.log)(n,new Date().toISOString()+" | v"+Aq+" "+Iq.pid+" | "+e+" | "+t)}Ft.trace=Lq;function jM(n){return!UM.has(n)&&(Fq||SE.has(n))}Ft.isTracerEnabled=jM});var Df=I(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.getErrorCode=qo.getErrorMessage=void 0;function Bq(n){return n instanceof Error?n.message:String(n)}qo.getErrorMessage=Bq;function Vq(n){return typeof n=="object"&&n!==null&&"code"in n&&typeof n.code=="number"?n.code:null}qo.getErrorCode=Vq});var Ut=I(If=>{"use strict";Object.defineProperty(If,"__esModule",{value:!0});If.Metadata=void 0;var Uq=Ue(),jq=be(),qq=Df(),Hq=/^[0-9a-z_.-]+$/,$q=/^[ -~]*$/;function zq(n){return Hq.test(n)}function Gq(n){return $q.test(n)}function HM(n){return n.endsWith("-bin")}function Wq(n){return!n.startsWith("grpc-")}function wf(n){return n.toLowerCase()}function qM(n,e){if(!zq(n))throw new Error('Metadata key "'+n+'" contains illegal characters');if(e!=null)if(HM(n)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!Gq(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var TE=class n{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){e=wf(e),qM(e,t),this.internalRepr.set(e,[t])}add(e,t){e=wf(e),qM(e,t);let r=this.internalRepr.get(e);r===void 0?this.internalRepr.set(e,[t]):r.push(t)}remove(e){e=wf(e),this.internalRepr.delete(e)}get(e){return e=wf(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,r]of this.internalRepr)if(r.length>0){let i=r[0];e[t]=Buffer.isBuffer(i)?Buffer.from(i):i}return e}clone(){let e=new n(this.options),t=e.internalRepr;for(let[r,i]of this.internalRepr){let s=i.map(o=>Buffer.isBuffer(o)?Buffer.from(o):o);t.set(r,s)}return e}merge(e){for(let[t,r]of e.internalRepr){let i=(this.internalRepr.get(t)||[]).concat(r);this.internalRepr.set(t,i)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,r]of this.internalRepr)e[t]=r.map(Kq);return e}toJSON(){let e={};for(let[t,r]of this.internalRepr)e[t]=r;return e}static fromHttp2Headers(e){let t=new n;for(let r of Object.keys(e)){if(r.charAt(0)===":")continue;let i=e[r];try{HM(r)?Array.isArray(i)?i.forEach(s=>{t.add(r,Buffer.from(s,"base64"))}):i!==void 0&&(Wq(r)?i.split(",").forEach(s=>{t.add(r,Buffer.from(s.trim(),"base64"))}):t.add(r,Buffer.from(i,"base64"))):Array.isArray(i)?i.forEach(s=>{t.add(r,s)}):i!==void 0&&t.add(r,i)}catch(s){let o=`Failed to add metadata entry ${r}: ${i}. ${(0,qq.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,Uq.log)(jq.LogVerbosity.ERROR,o)}}return t}};If.Metadata=TE;var Kq=n=>Buffer.isBuffer(n)?n.toString("base64"):n});var NE=I(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0});Af.CallCredentials=void 0;var AE=Ut();function Qq(n){return"getRequestHeaders"in n&&typeof n.getRequestHeaders=="function"}var Ho=class n{static createFromMetadataGenerator(e){return new wE(e)}static createFromGoogleCredential(e){return n.createFromMetadataGenerator((t,r)=>{let i;Qq(e)?i=e.getRequestHeaders(t.service_url):i=new Promise((s,o)=>{e.getRequestMetadata(t.service_url,(a,c)=>{if(a){o(a);return}if(!c){o(new Error("Headers not set by metadata plugin"));return}s(c)})}),i.then(s=>{let o=new AE.Metadata;for(let a of Object.keys(s))o.add(a,s[a]);r(null,o)},s=>{r(s)})})}static createEmpty(){return new IE}};Af.CallCredentials=Ho;var DE=class n extends Ho{constructor(e){super(),this.creds=e}async generateMetadata(e){let t=new AE.Metadata,r=await Promise.all(this.creds.map(i=>i.generateMetadata(e)));for(let i of r)t.merge(i);return t}compose(e){return new n(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof n?this.creds.every((t,r)=>t._equals(e.creds[r])):!1}},wE=class n extends Ho{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,r)=>{this.metadataGenerator(e,(i,s)=>{s!==void 0?t(s):r(i)})})}compose(e){return new DE([this,e])}_equals(e){return this===e?!0:e instanceof n?this.metadataGenerator===e.metadataGenerator:!1}},IE=class n extends Ho{generateMetadata(e){return Promise.resolve(new AE.Metadata)}compose(e){return e}_equals(e){return e instanceof n}}});var RE=I($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.getDefaultRootsData=$o.CIPHER_SUITES=void 0;var Yq=De("fs");$o.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var $M=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,ME=null;function Zq(){return $M?(ME===null&&(ME=Yq.readFileSync($M)),ME):null}$o.getDefaultRootsData=Zq});var Rf=I(Mf=>{"use strict";Object.defineProperty(Mf,"__esModule",{value:!0});Mf.ChannelCredentials=void 0;var Jq=De("tls"),Xq=NE(),zM=RE();function xE(n,e){if(n&&!(n instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var zo=class{constructor(e){this.callCredentials=e||Xq.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,r,i){var s;if(xE(e,"Root certificate"),xE(t,"Private key"),xE(r,"Certificate chain"),t&&!r)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&r)throw new Error("Certificate chain must be given with accompanying private key");let o=(0,Jq.createSecureContext)({ca:(s=e??(0,zM.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:t??void 0,cert:r??void 0,ciphers:zM.CIPHER_SUITES});return new Nf(o,i??{})}static createFromSecureContext(e,t){return new Nf(e,t??{})}static createInsecure(){return new OE}};Mf.ChannelCredentials=zo;var OE=class n extends zo{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof n}},Nf=class n extends zo{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},t?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){let t=this.callCredentials.compose(e);return new kE(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},kE=class n extends zo{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new n(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var li=I(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.validateLoadBalancingConfig=Tt.getFirstUsableConfig=Tt.isLoadBalancerNameRegistered=Tt.createLoadBalancer=Tt.registerDefaultLoadBalancerType=Tt.registerLoadBalancerType=Tt.createChildChannelControlHelper=void 0;function e6(n,e){var t,r,i,s,o,a,c,l,u,d;return{createSubchannel:(r=(t=e.createSubchannel)===null||t===void 0?void 0:t.bind(e))!==null&&r!==void 0?r:n.createSubchannel.bind(n),updateState:(s=(i=e.updateState)===null||i===void 0?void 0:i.bind(e))!==null&&s!==void 0?s:n.updateState.bind(n),requestReresolution:(a=(o=e.requestReresolution)===null||o===void 0?void 0:o.bind(e))!==null&&a!==void 0?a:n.requestReresolution.bind(n),addChannelzChild:(l=(c=e.addChannelzChild)===null||c===void 0?void 0:c.bind(e))!==null&&l!==void 0?l:n.addChannelzChild.bind(n),removeChannelzChild:(d=(u=e.removeChannelzChild)===null||u===void 0?void 0:u.bind(e))!==null&&d!==void 0?d:n.removeChannelzChild.bind(n)}}Tt.createChildChannelControlHelper=e6;var ci={},PE=null;function t6(n,e,t){ci[n]={LoadBalancer:e,LoadBalancingConfig:t}}Tt.registerLoadBalancerType=t6;function n6(n){PE=n}Tt.registerDefaultLoadBalancerType=n6;function r6(n,e){let t=n.getLoadBalancerName();return t in ci?new ci[t].LoadBalancer(e):null}Tt.createLoadBalancer=r6;function i6(n){return n in ci}Tt.isLoadBalancerNameRegistered=i6;function s6(n,e=!1){for(let t of n)if(t.getLoadBalancerName()in ci)return t;return e&&PE?new ci[PE].LoadBalancingConfig:null}Tt.getFirstUsableConfig=s6;function o6(n){if(!(n!==null&&typeof n=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(n);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let t=e[0];if(t in ci)return ci[t].LoadBalancingConfig.createFromJson(n[t]);throw new Error(`Unrecognized load balancing config name ${t}`)}Tt.validateLoadBalancingConfig=o6});var FE=I(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.extractAndSelectServiceConfig=ui.validateServiceConfig=ui.validateRetryThrottling=void 0;var a6=De("os"),xf=be(),c6=li(),Of=/^\d+(\.\d{1,9})?s$/,l6="node";function u6(n){if("service"in n&&n.service!==""){if(typeof n.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof n.service}`);if("method"in n&&n.method!==""){if(typeof n.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof n.service}`);return{service:n.service,method:n.method}}else return{service:n.service}}else{if("method"in n&&n.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function d6(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in n)||typeof n.initialBackoff!="string"||!Of.test(n.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in n)||typeof n.maxBackoff!="string"||!Of.test(n.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in n)||typeof n.backoffMultiplier!="number"||n.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in n&&Array.isArray(n.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(n.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of n.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(xf.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(xf.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:n.maxAttempts,initialBackoff:n.initialBackoff,maxBackoff:n.maxBackoff,backoffMultiplier:n.backoffMultiplier,retryableStatusCodes:n.retryableStatusCodes}}function f6(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in n&&(typeof n.hedgingDelay!="string"||!Of.test(n.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in n&&Array.isArray(n.nonFatalStatusCodes))for(let t of n.nonFatalStatusCodes)if(typeof t=="number"){if(!Object.values(xf.Status).includes(t))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof t=="string"){if(!Object.values(xf.Status).includes(t.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:n.maxAttempts};return n.hedgingDelay&&(e.hedgingDelay=n.hedgingDelay),n.nonFatalStatusCodes&&(e.nonFatalStatusCodes=n.nonFatalStatusCodes),e}function h6(n){var e;let t={name:[]};if(!("name"in n)||!Array.isArray(n.name))throw new Error("Invalid method config: invalid name array");for(let r of n.name)t.name.push(u6(r));if("waitForReady"in n){if(typeof n.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");t.waitForReady=n.waitForReady}if("timeout"in n)if(typeof n.timeout=="object"){if(!("seconds"in n.timeout)||typeof n.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in n.timeout)||typeof n.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");t.timeout=n.timeout}else if(typeof n.timeout=="string"&&Of.test(n.timeout)){let r=n.timeout.substring(0,n.timeout.length-1).split(".");t.timeout={seconds:r[0]|0,nanos:((e=r[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in n){if(typeof n.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxRequestBytes=n.maxRequestBytes}if("maxResponseBytes"in n){if(typeof n.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxResponseBytes=n.maxResponseBytes}if("retryPolicy"in n){if("hedgingPolicy"in n)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");t.retryPolicy=d6(n.retryPolicy)}else"hedgingPolicy"in n&&(t.hedgingPolicy=f6(n.hedgingPolicy));return t}function GM(n){if(!("maxTokens"in n)||typeof n.maxTokens!="number"||n.maxTokens<=0||n.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in n)||typeof n.tokenRatio!="number"||n.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+n.maxTokens.toFixed(3),tokenRatio:+n.tokenRatio.toFixed(3)}}ui.validateRetryThrottling=GM;function WM(n){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in n)if(typeof n.loadBalancingPolicy=="string")e.loadBalancingPolicy=n.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in n)if(Array.isArray(n.loadBalancingConfig))for(let r of n.loadBalancingConfig)e.loadBalancingConfig.push((0,c6.validateLoadBalancingConfig)(r));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in n&&Array.isArray(n.methodConfig))for(let r of n.methodConfig)e.methodConfig.push(h6(r));"retryThrottling"in n&&(e.retryThrottling=GM(n.retryThrottling));let t=[];for(let r of e.methodConfig)for(let i of r.name){for(let s of t)if(i.service===s.service&&i.method===s.method)throw new Error(`Invalid service config: duplicate name ${i.service}/${i.method}`);t.push(i)}return e}ui.validateServiceConfig=WM;function p6(n){if(!("serviceConfig"in n))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:WM(n.serviceConfig)};if("clientLanguage"in n)if(Array.isArray(n.clientLanguage)){e.clientLanguage=[];for(let r of n.clientLanguage)if(typeof r=="string")e.clientLanguage.push(r);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in n)if(Array.isArray(n.clientHostname)){e.clientHostname=[];for(let r of n.clientHostname)if(typeof r=="string")e.clientHostname.push(r);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in n)if(typeof n.percentage=="number"&&0<=n.percentage&&n.percentage<=100)e.percentage=n.percentage;else throw new Error("Invalid service config choice: invalid percentage");let t=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let r in n)if(!t.includes(r))throw new Error(`Invalid service config choice: unexpected field ${r}`);return e}function g6(n,e){if(!Array.isArray(n))throw new Error("Invalid service config list");for(let t of n){let r=p6(t);if(!(typeof r.percentage=="number"&&e>r.percentage)){if(Array.isArray(r.clientHostname)){let i=!1;for(let s of r.clientHostname)s===a6.hostname()&&(i=!0);if(!i)continue}if(Array.isArray(r.clientLanguage)){let i=!1;for(let s of r.clientLanguage)s===l6&&(i=!0);if(!i)continue}return r.serviceConfig}}throw new Error("No matching service config found")}function m6(n,e){for(let t of n)if(t.length>0&&t[0].startsWith("grpc_config=")){let r=t.join("").substring(12),i=JSON.parse(r);return g6(i,e)}return null}ui.extractAndSelectServiceConfig=m6});var dn=I(kf=>{"use strict";Object.defineProperty(kf,"__esModule",{value:!0});kf.ConnectivityState=void 0;var KM=(function(n){return n[n.IDLE=0]="IDLE",n[n.CONNECTING=1]="CONNECTING",n[n.READY=2]="READY",n[n.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",n[n.SHUTDOWN=4]="SHUTDOWN",n})(KM||(kf.ConnectivityState=KM={}))});var Qt=I(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.uriToString=di.splitHostPort=di.parseUri=void 0;var y6=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function v6(n){let e=y6.exec(n);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}di.parseUri=v6;var QM=/^\d+$/;function E6(n){if(n.startsWith("[")){let e=n.indexOf("]");if(e===-1)return null;let t=n.substring(1,e);if(t.indexOf(":")===-1)return null;if(n.length>e+1)if(n[e+1]===":"){let r=n.substring(e+2);return QM.test(r)?{host:t,port:+r}:null}else return null;else return{host:t}}else{let e=n.split(":");return e.length===2?QM.test(e[1])?{host:e[0],port:+e[1]}:null:{host:n}}}di.splitHostPort=E6;function _6(n){let e="";return n.scheme!==void 0&&(e+=n.scheme+":"),n.authority!==void 0&&(e+="//"+n.authority+"/"),e+=n.path,e}di.uriToString=_6});var Qn=I(fn=>{"use strict";Object.defineProperty(fn,"__esModule",{value:!0});fn.mapUriDefaultScheme=fn.getDefaultAuthority=fn.createResolver=fn.registerDefaultScheme=fn.registerResolver=void 0;var BE=Qt(),Go={},LE=null;function C6(n,e){Go[n]=e}fn.registerResolver=C6;function b6(n){LE=n}fn.registerDefaultScheme=b6;function S6(n,e,t){if(n.scheme!==void 0&&n.scheme in Go)return new Go[n.scheme](n,e,t);throw new Error(`No resolver could be created for target ${(0,BE.uriToString)(n)}`)}fn.createResolver=S6;function T6(n){if(n.scheme!==void 0&&n.scheme in Go)return Go[n.scheme].getDefaultAuthority(n);throw new Error(`Invalid target ${(0,BE.uriToString)(n)}`)}fn.getDefaultAuthority=T6;function D6(n){return n.scheme===void 0||!(n.scheme in Go)?LE!==null?{scheme:LE,authority:void 0,path:(0,BE.uriToString)(n)}:null:n}fn.mapUriDefaultScheme=D6});var hi=I(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.QueuePicker=fi.UnavailablePicker=fi.PickResultType=void 0;var w6=Ut(),I6=be(),Pf=(function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.QUEUE=1]="QUEUE",n[n.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",n[n.DROP=3]="DROP",n})(Pf||(fi.PickResultType=Pf={})),VE=class{constructor(e){this.status=Object.assign({code:I6.Status.UNAVAILABLE,details:"No connection established",metadata:new w6.Metadata},e)}pick(e){return{pickResultType:Pf.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};fi.UnavailablePicker=VE;var UE=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:Pf.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};fi.QueuePicker=UE});var al=I(Ff=>{"use strict";Object.defineProperty(Ff,"__esModule",{value:!0});Ff.BackoffTimeout=void 0;var A6=1e3,N6=1.6,M6=12e4,R6=.2;function x6(n,e){return Math.random()*(e-n)+n}var jE=class{constructor(e,t){this.callback=e,this.initialDelay=A6,this.multiplier=N6,this.maxDelay=M6,this.jitter=R6,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,r;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(r=(t=this.timerId).unref)===null||r===void 0||r.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+x6(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,(t=(e=this.timerId).ref)===null||t===void 0||t.call(e)}unref(){var e,t;this.hasRef=!1,(t=(e=this.timerId).unref)===null||t===void 0||t.call(e)}getEndTime(){return this.endTime}};Ff.BackoffTimeout=jE});var Bf=I(Lf=>{"use strict";Object.defineProperty(Lf,"__esModule",{value:!0});Lf.ChildLoadBalancerHandler=void 0;var O6=li(),k6=dn(),P6="child_load_balancer_helper",qE=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(t){this.parent=t,this.child=null}createSubchannel(t,r){return this.parent.channelControlHelper.createSubchannel(t,r)}updateState(t,r){var i;if(this.calledByPendingChild()){if(t===k6.ConnectivityState.CONNECTING)return;(i=this.parent.currentChild)===null||i===void 0||i.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(t,r)}requestReresolution(){var t;let r=(t=this.parent.pendingChild)!==null&&t!==void 0?t:this.parent.currentChild;this.child===r&&this.parent.channelControlHelper.requestReresolution()}setChild(t){this.child=t}addChannelzChild(t){this.parent.channelControlHelper.addChannelzChild(t)}removeChannelzChild(t){this.parent.channelControlHelper.removeChannelzChild(t)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,r){let i;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let s=new this.ChildPolicyHelper(this),o=(0,O6.createLoadBalancer)(t,s);s.setChild(o),this.currentChild===null?(this.currentChild=o,i=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=o,i=this.pendingChild)}else this.pendingChild===null?i=this.currentChild:i=this.pendingChild;this.latestConfig=t,i.updateAddressList(e,t,r)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return P6}};Lf.ChildLoadBalancerHandler=qE});var ZM=I(Vf=>{"use strict";Object.defineProperty(Vf,"__esModule",{value:!0});Vf.ResolvingLoadBalancer=void 0;var F6=li(),L6=FE(),jt=dn(),B6=Qn(),Wo=hi(),V6=al(),HE=be(),U6=Ut(),j6=Ue(),q6=be(),H6=Qt(),$6=Bf(),z6="resolving_load_balancer";function YM(n){j6.trace(q6.LogVerbosity.DEBUG,z6,n)}var G6=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function W6(n,e,t,r){for(let i of t.name)switch(r){case"EMPTY":if(!i.service&&!i.method)return!0;break;case"SERVICE":if(i.service===n&&!i.method)return!0;break;case"SERVICE_AND_METHOD":if(i.service===n&&i.method===e)return!0}return!1}function K6(n,e,t,r){for(let i of t)if(W6(n,e,i,r))return i;return null}function Q6(n){return function(t,r){var i,s;let o=t.split("/").filter(l=>l.length>0),a=(i=o[0])!==null&&i!==void 0?i:"",c=(s=o[1])!==null&&s!==void 0?s:"";if(n&&n.methodConfig)for(let l of G6){let u=K6(a,c,n.methodConfig,l);if(u)return{methodConfig:u,pickInformation:{},status:HE.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:HE.Status.OK,dynamicFilterFactories:[]}}}var $E=class{constructor(e,t,r,i,s){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=i,this.onFailedResolution=s,this.latestChildState=jt.ConnectivityState.IDLE,this.latestChildPicker=new Wo.QueuePicker(this),this.currentState=jt.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,r["grpc.service_config"]?this.defaultServiceConfig=(0,L6.validateServiceConfig)(JSON.parse(r["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(jt.ConnectivityState.IDLE,new Wo.QueuePicker(this)),this.childLoadBalancer=new $6.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?(YM("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,c)=>{this.latestChildState=a,this.latestChildPicker=c,this.updateState(a,c)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,B6.createResolver)(e,{onSuccessfulResolution:(a,c,l,u,d)=>{var f;this.backoffTimeout.stop(),this.backoffTimeout.reset();let h=null;c===null?l===null?(this.previousServiceConfig=null,h=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(l):h=this.previousServiceConfig:(h=c,this.previousServiceConfig=c);let _=(f=h?.loadBalancingConfig)!==null&&f!==void 0?f:[],b=(0,F6.getFirstUsableConfig)(_,!0);if(b===null){this.handleResolutionFailure({code:HE.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new U6.Metadata});return}this.childLoadBalancer.updateAddressList(a,b,d);let T=h??this.defaultServiceConfig;this.onSuccessfulResolution(T,u??Q6(T))},onError:a=>{this.handleResolutionFailure(a)}},r);let o={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new V6.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},o),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===jt.ConnectivityState.IDLE&&this.updateState(jt.ConnectivityState.CONNECTING,new Wo.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){YM((0,H6.uriToString)(this.target)+" "+jt.ConnectivityState[this.currentState]+" -> "+jt.ConnectivityState[e]),e===jt.ConnectivityState.IDLE&&(t=new Wo.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===jt.ConnectivityState.IDLE&&(this.updateState(jt.ConnectivityState.TRANSIENT_FAILURE,new Wo.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===jt.ConnectivityState.IDLE||this.currentState===jt.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=jt.ConnectivityState.IDLE,this.latestChildPicker=new Wo.QueuePicker(this),this.currentState=jt.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};Vf.ResolvingLoadBalancer=$E});var JM=I(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.channelOptionsEqual=Ko.recognizedOptions=void 0;Ko.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0};function Y6(n,e){let t=Object.keys(n).sort(),r=Object.keys(e).sort();if(t.length!==r.length)return!1;for(let i=0;i<t.length;i+=1)if(t[i]!==r[i]||n[t[i]]!==e[r[i]])return!1;return!0}Ko.channelOptionsEqual=Y6});var Zn=I(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.stringToSubchannelAddress=Yn.subchannelAddressToString=Yn.subchannelAddressEqual=Yn.isTcpSubchannelAddress=void 0;var Z6=De("net");function cl(n){return"port"in n}Yn.isTcpSubchannelAddress=cl;function J6(n,e){return!n&&!e?!0:!n||!e?!1:cl(n)?cl(e)&&n.host===e.host&&n.port===e.port:!cl(e)&&n.path===e.path}Yn.subchannelAddressEqual=J6;function X6(n){return cl(n)?n.host+":"+n.port:n.path}Yn.subchannelAddressToString=X6;var eH=443;function tH(n,e){return(0,Z6.isIP)(n)?{host:n,port:e??eH}:{path:n}}Yn.stringToSubchannelAddress=tH});var Uf=I(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.addAdminServicesToServer=Qo.registerAdminService=void 0;var XM=[];function nH(n,e){XM.push({getServiceDefinition:n,getHandlers:e})}Qo.registerAdminService=nH;function rH(n){for(let{getServiceDefinition:e,getHandlers:t}of XM)n.addService(e(),t())}Qo.addAdminServicesToServer=rH});var eR=I(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});hn.ClientDuplexStreamImpl=hn.ClientWritableStreamImpl=hn.ClientReadableStreamImpl=hn.ClientUnaryCallImpl=hn.callErrorFromStatus=void 0;var iH=De("events"),QE=De("stream"),ll=be();function sH(n,e){let t=`${n.code} ${ll.Status[n.code]}: ${n.details}`,i=`${new Error(t).stack}
for call at
${e}`;return Object.assign(new Error(t),n,{stack:i})}hn.callErrorFromStatus=sH;var zE=class extends iH.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ll.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}};hn.ClientUnaryCallImpl=zE;var GE=class extends QE.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ll.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}};hn.ClientReadableStreamImpl=GE;var WE=class extends QE.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ll.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,r){var i;let s={callback:r},o=Number(t);Number.isNaN(o)||(s.flags=o),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};hn.ClientWritableStreamImpl=WE;var KE=class extends QE.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ll.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}_write(e,t,r){var i;let s={callback:r},o=Number(t);Number.isNaN(o)||(s.flags=o),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};hn.ClientDuplexStreamImpl=KE});var tR=I(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.InterceptingListenerImpl=Yo.isInterceptingListener=void 0;function oH(n){return n.onReceiveMetadata!==void 0&&n.onReceiveMetadata.length===1}Yo.isInterceptingListener=oH;var YE=class{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,t=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(t),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,t=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=t,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(t),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,t=>{this.processingMetadata||this.processingMessage?this.pendingStatus=t:this.nextListener.onReceiveStatus(t)})}};Yo.InterceptingListenerImpl=YE});var r_=I(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.getInterceptingCall=pn.InterceptingCall=pn.RequesterBuilder=pn.ListenerBuilder=pn.InterceptorConfigurationError=void 0;var aH=Ut(),nR=tR(),rR=be(),iR=Df(),dl=class n extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,n)}};pn.InterceptorConfigurationError=dl;var JE=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};pn.ListenerBuilder=JE;var XE=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};pn.RequesterBuilder=XE;var ZE={onReceiveMetadata:(n,e)=>{e(n)},onReceiveMessage:(n,e)=>{e(n)},onReceiveStatus:(n,e)=>{e(n)}},ul={start:(n,e,t)=>{t(n,e)},sendMessage:(n,e)=>{e(n)},halfClose:n=>{n()},cancel:n=>{n()}},e_=class{constructor(e,t){var r,i,s,o;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:(r=t.start)!==null&&r!==void 0?r:ul.start,sendMessage:(i=t.sendMessage)!==null&&i!==void 0?i:ul.sendMessage,halfClose:(s=t.halfClose)!==null&&s!==void 0?s:ul.halfClose,cancel:(o=t.cancel)!==null&&o!==void 0?o:ul.cancel}:this.requester=ul}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var r,i,s,o,a,c;let l={onReceiveMetadata:(i=(r=t?.onReceiveMetadata)===null||r===void 0?void 0:r.bind(t))!==null&&i!==void 0?i:u=>{},onReceiveMessage:(o=(s=t?.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&o!==void 0?o:u=>{},onReceiveStatus:(c=(a=t?.onReceiveStatus)===null||a===void 0?void 0:a.bind(t))!==null&&c!==void 0?c:u=>{}};this.processingMetadata=!0,this.requester.start(e,l,(u,d)=>{var f,h,_;this.processingMetadata=!1;let b;if((0,nR.isInterceptingListener)(d))b=d;else{let T={onReceiveMetadata:(f=d.onReceiveMetadata)!==null&&f!==void 0?f:ZE.onReceiveMetadata,onReceiveMessage:(h=d.onReceiveMessage)!==null&&h!==void 0?h:ZE.onReceiveMessage,onReceiveStatus:(_=d.onReceiveStatus)!==null&&_!==void 0?_:ZE.onReceiveStatus};b=new nR.InterceptingListenerImpl(T,l)}this.nextCall.start(u,b),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,r=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,r),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};pn.InterceptingCall=e_;function cH(n,e,t){var r,i;let s=(r=t.deadline)!==null&&r!==void 0?r:1/0,o=t.host,a=(i=t.parent)!==null&&i!==void 0?i:null,c=t.propagate_flags,l=t.credentials,u=n.createCall(e,s,o,a,c);return l&&u.setCredentials(l),u}var jf=class{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let r;try{r=this.methodDefinition.requestSerialize(t)}catch(i){this.call.cancelWithStatus(rR.Status.INTERNAL,`Request message serialization failure: ${(0,iR.getErrorMessage)(i)}`);return}this.call.sendMessageWithContext(e,r)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let r=null;this.call.start(e,{onReceiveMetadata:i=>{var s;(s=t?.onReceiveMetadata)===null||s===void 0||s.call(t,i)},onReceiveMessage:i=>{var s;let o;try{o=this.methodDefinition.responseDeserialize(i)}catch(a){r={code:rR.Status.INTERNAL,details:`Response message parsing error: ${(0,iR.getErrorMessage)(a)}`,metadata:new aH.Metadata},this.call.cancelWithStatus(r.code,r.details);return}(s=t?.onReceiveMessage)===null||s===void 0||s.call(t,o)},onReceiveStatus:i=>{var s,o;r?(s=t?.onReceiveStatus)===null||s===void 0||s.call(t,r):(o=t?.onReceiveStatus)===null||o===void 0||o.call(t,i)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},t_=class extends jf{constructor(e,t){super(e,t)}start(e,t){var r,i;let s=!1,o={onReceiveMetadata:(i=(r=t?.onReceiveMetadata)===null||r===void 0?void 0:r.bind(t))!==null&&i!==void 0?i:a=>{},onReceiveMessage:a=>{var c;s=!0,(c=t?.onReceiveMessage)===null||c===void 0||c.call(t,a)},onReceiveStatus:a=>{var c,l;s||(c=t?.onReceiveMessage)===null||c===void 0||c.call(t,null),(l=t?.onReceiveStatus)===null||l===void 0||l.call(t,a)}};super.start(e,o),this.call.startRead()}},n_=class extends jf{};function lH(n,e,t){let r=cH(n,t.path,e);return t.responseStream?new n_(r,t):new t_(r,t)}function uH(n,e,t,r){if(n.clientInterceptors.length>0&&n.clientInterceptorProviders.length>0)throw new dl("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(n.callInterceptors.length>0&&n.callInterceptorProviders.length>0)throw new dl("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let i=[];n.callInterceptors.length>0||n.callInterceptorProviders.length>0?i=[].concat(n.callInterceptors,n.callInterceptorProviders.map(a=>a(e))).filter(a=>a):i=[].concat(n.clientInterceptors,n.clientInterceptorProviders.map(a=>a(e))).filter(a=>a);let s=Object.assign({},t,{method_definition:e});return i.reduceRight((a,c)=>l=>c(l,a),a=>lH(r,a,e))(s)}pn.getInterceptingCall=uH});var o_=I(Hf=>{"use strict";Object.defineProperty(Hf,"__esModule",{value:!0});Hf.Client=void 0;var Jn=eR(),dH=a_(),fH=dn(),pi=be(),Zo=Ut(),qf=r_(),Dn=Symbol(),Jo=Symbol(),Xo=Symbol(),Mr=Symbol();function i_(n){return typeof n=="function"}function ea(n){return n.stack.split(`
`).slice(1).join(`
`)}var s_=class{constructor(e,t,r={}){var i,s;if(r=Object.assign({},r),this[Jo]=(i=r.interceptors)!==null&&i!==void 0?i:[],delete r.interceptors,this[Xo]=(s=r.interceptor_providers)!==null&&s!==void 0?s:[],delete r.interceptor_providers,this[Jo].length>0&&this[Xo].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[Mr]=r.callInvocationTransformer,delete r.callInvocationTransformer,r.channelOverride)this[Dn]=r.channelOverride;else if(r.channelFactoryOverride){let o=r.channelFactoryOverride;delete r.channelFactoryOverride,this[Dn]=o(e,t,r)}else this[Dn]=new dH.ChannelImplementation(e,t,r)}close(){this[Dn].close()}getChannel(){return this[Dn]}waitForReady(e,t){let r=i=>{if(i){t(new Error("Failed to connect before the deadline"));return}let s;try{s=this[Dn].getConnectivityState(!0)}catch{t(new Error("The channel has been closed"));return}if(s===fH.ConnectivityState.READY)t();else try{this[Dn].watchConnectivityState(s,e,r)}catch{t(new Error("The channel has been closed"))}};setImmediate(r)}checkOptionalUnaryResponseArguments(e,t,r){if(i_(e))return{metadata:new Zo.Metadata,options:{},callback:e};if(i_(t))return e instanceof Zo.Metadata?{metadata:e,options:{},callback:t}:{metadata:new Zo.Metadata,options:e,callback:t};if(!(e instanceof Zo.Metadata&&t instanceof Object&&i_(r)))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:r}}makeUnaryRequest(e,t,r,i,s,o,a){var c,l;let u=this.checkOptionalUnaryResponseArguments(s,o,a),d={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:r},f={argument:i,metadata:u.metadata,call:new Jn.ClientUnaryCallImpl,channel:this[Dn],methodDefinition:d,callOptions:u.options,callback:u.callback};this[Mr]&&(f=this[Mr](f));let h=f.call,_={clientInterceptors:this[Jo],clientInterceptorProviders:this[Xo],callInterceptors:(c=f.callOptions.interceptors)!==null&&c!==void 0?c:[],callInterceptorProviders:(l=f.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},b=(0,qf.getInterceptingCall)(_,f.methodDefinition,f.callOptions,f.channel);h.call=b;let T=null,D=!1,k=new Error;return b.start(f.metadata,{onReceiveMetadata:P=>{h.emit("metadata",P)},onReceiveMessage(P){T!==null&&b.cancelWithStatus(pi.Status.INTERNAL,"Too many responses received"),T=P},onReceiveStatus(P){if(!D){if(D=!0,P.code===pi.Status.OK)if(T===null){let w=ea(k);f.callback((0,Jn.callErrorFromStatus)({code:pi.Status.INTERNAL,details:"No message received",metadata:P.metadata},w))}else f.callback(null,T);else{let w=ea(k);f.callback((0,Jn.callErrorFromStatus)(P,w))}k=null,h.emit("status",P)}}}),b.sendMessage(i),b.halfClose(),h}makeClientStreamRequest(e,t,r,i,s,o){var a,c;let l=this.checkOptionalUnaryResponseArguments(i,s,o),u={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:r},d={metadata:l.metadata,call:new Jn.ClientWritableStreamImpl(t),channel:this[Dn],methodDefinition:u,callOptions:l.options,callback:l.callback};this[Mr]&&(d=this[Mr](d));let f=d.call,h={clientInterceptors:this[Jo],clientInterceptorProviders:this[Xo],callInterceptors:(a=d.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(c=d.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},_=(0,qf.getInterceptingCall)(h,d.methodDefinition,d.callOptions,d.channel);f.call=_;let b=null,T=!1,D=new Error;return _.start(d.metadata,{onReceiveMetadata:k=>{f.emit("metadata",k)},onReceiveMessage(k){b!==null&&_.cancelWithStatus(pi.Status.INTERNAL,"Too many responses received"),b=k},onReceiveStatus(k){if(!T){if(T=!0,k.code===pi.Status.OK)if(b===null){let P=ea(D);d.callback((0,Jn.callErrorFromStatus)({code:pi.Status.INTERNAL,details:"No message received",metadata:k.metadata},P))}else d.callback(null,b);else{let P=ea(D);d.callback((0,Jn.callErrorFromStatus)(k,P))}D=null,f.emit("status",k)}}}),f}checkMetadataAndOptions(e,t){let r,i;return e instanceof Zo.Metadata?(r=e,t?i=t:i={}):(e?i=e:i={},r=new Zo.Metadata),{metadata:r,options:i}}makeServerStreamRequest(e,t,r,i,s,o){var a,c;let l=this.checkMetadataAndOptions(s,o),u={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:r},d={argument:i,metadata:l.metadata,call:new Jn.ClientReadableStreamImpl(r),channel:this[Dn],methodDefinition:u,callOptions:l.options};this[Mr]&&(d=this[Mr](d));let f=d.call,h={clientInterceptors:this[Jo],clientInterceptorProviders:this[Xo],callInterceptors:(a=d.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(c=d.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},_=(0,qf.getInterceptingCall)(h,d.methodDefinition,d.callOptions,d.channel);f.call=_;let b=!1,T=new Error;return _.start(d.metadata,{onReceiveMetadata(D){f.emit("metadata",D)},onReceiveMessage(D){f.push(D)},onReceiveStatus(D){if(!b){if(b=!0,f.push(null),D.code!==pi.Status.OK){let k=ea(T);f.emit("error",(0,Jn.callErrorFromStatus)(D,k))}T=null,f.emit("status",D)}}}),_.sendMessage(i),_.halfClose(),f}makeBidiStreamRequest(e,t,r,i,s){var o,a;let c=this.checkMetadataAndOptions(i,s),l={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:r},u={metadata:c.metadata,call:new Jn.ClientDuplexStreamImpl(t,r),channel:this[Dn],methodDefinition:l,callOptions:c.options};this[Mr]&&(u=this[Mr](u));let d=u.call,f={clientInterceptors:this[Jo],clientInterceptorProviders:this[Xo],callInterceptors:(o=u.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(a=u.callOptions.interceptor_providers)!==null&&a!==void 0?a:[]},h=(0,qf.getInterceptingCall)(f,u.methodDefinition,u.callOptions,u.channel);d.call=h;let _=!1,b=new Error;return h.start(u.metadata,{onReceiveMetadata(T){d.emit("metadata",T)},onReceiveMessage(T){d.push(T)},onReceiveStatus(T){if(!_){if(_=!0,d.push(null),T.code!==pi.Status.OK){let D=ea(b);d.emit("error",(0,Jn.callErrorFromStatus)(T,D))}b=null,d.emit("status",T)}}}),d}};Hf.Client=s_});var l_=I(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.loadPackageDefinition=ta.makeClientConstructor=void 0;var fl=o_(),hH={unary:fl.Client.prototype.makeUnaryRequest,server_stream:fl.Client.prototype.makeServerStreamRequest,client_stream:fl.Client.prototype.makeClientStreamRequest,bidi:fl.Client.prototype.makeBidiStreamRequest};function c_(n){return["__proto__","prototype","constructor"].includes(n)}function sR(n,e,t){t||(t={});class r extends fl.Client{}return Object.keys(n).forEach(i=>{if(c_(i))return;let s=n[i],o;if(typeof i=="string"&&i.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?o="bidi":o="client_stream":s.responseStream?o="server_stream":o="unary";let a=s.requestSerialize,c=s.responseDeserialize,l=pH(hH[o],s.path,a,c);r.prototype[i]=l,Object.assign(r.prototype[i],s),s.originalName&&!c_(s.originalName)&&(r.prototype[s.originalName]=r.prototype[i])}),r.service=n,r.serviceName=e,r}ta.makeClientConstructor=sR;function pH(n,e,t,r){return function(...i){return n.call(this,e,t,r,...i)}}function gH(n){return"format"in n}function mH(n){let e={};for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let r=n[t],i=t.split(".");if(i.some(a=>c_(a)))continue;let s=i[i.length-1],o=e;for(let a of i.slice(0,-1))o[a]||(o[a]={}),o=o[a];gH(r)?o[s]=r:o[s]=sR(r,s,{})}return e}ta.loadPackageDefinition=mH});var MR=I((Spe,NR)=>{"use strict";var yH=1/0,vH="[object Symbol]",EH=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,_H=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,zf="\\ud800-\\udfff",hR="\\u0300-\\u036f\\ufe20-\\ufe23",pR="\\u20d0-\\u20f0",gR="\\u2700-\\u27bf",mR="a-z\\xdf-\\xf6\\xf8-\\xff",CH="\\xac\\xb1\\xd7\\xf7",bH="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",SH="\\u2000-\\u206f",TH=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",yR="A-Z\\xc0-\\xd6\\xd8-\\xde",vR="\\ufe0e\\ufe0f",ER=CH+bH+SH+TH,d_="['\u2019]",DH="["+zf+"]",oR="["+ER+"]",$f="["+hR+pR+"]",_R="\\d+",wH="["+gR+"]",CR="["+mR+"]",bR="[^"+zf+ER+_R+gR+mR+yR+"]",u_="\\ud83c[\\udffb-\\udfff]",IH="(?:"+$f+"|"+u_+")",SR="[^"+zf+"]",f_="(?:\\ud83c[\\udde6-\\uddff]){2}",h_="[\\ud800-\\udbff][\\udc00-\\udfff]",na="["+yR+"]",TR="\\u200d",aR="(?:"+CR+"|"+bR+")",AH="(?:"+na+"|"+bR+")",cR="(?:"+d_+"(?:d|ll|m|re|s|t|ve))?",lR="(?:"+d_+"(?:D|LL|M|RE|S|T|VE))?",DR=IH+"?",wR="["+vR+"]?",NH="(?:"+TR+"(?:"+[SR,f_,h_].join("|")+")"+wR+DR+")*",IR=wR+DR+NH,MH="(?:"+[wH,f_,h_].join("|")+")"+IR,RH="(?:"+[SR+$f+"?",$f,f_,h_,DH].join("|")+")",xH=RegExp(d_,"g"),OH=RegExp($f,"g"),kH=RegExp(u_+"(?="+u_+")|"+RH+IR,"g"),PH=RegExp([na+"?"+CR+"+"+cR+"(?="+[oR,na,"$"].join("|")+")",AH+"+"+lR+"(?="+[oR,na+aR,"$"].join("|")+")",na+"?"+aR+"+"+cR,na+"+"+lR,_R,MH].join("|"),"g"),FH=RegExp("["+TR+zf+hR+pR+vR+"]"),LH=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,BH={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},VH=typeof global=="object"&&global&&global.Object===Object&&global,UH=typeof self=="object"&&self&&self.Object===Object&&self,jH=VH||UH||Function("return this")();function qH(n,e,t,r){var i=-1,s=n?n.length:0;for(r&&s&&(t=n[++i]);++i<s;)t=e(t,n[i],i,n);return t}function HH(n){return n.split("")}function $H(n){return n.match(EH)||[]}function zH(n){return function(e){return n?.[e]}}var GH=zH(BH);function AR(n){return FH.test(n)}function WH(n){return LH.test(n)}function KH(n){return AR(n)?QH(n):HH(n)}function QH(n){return n.match(kH)||[]}function YH(n){return n.match(PH)||[]}var ZH=Object.prototype,JH=ZH.toString,uR=jH.Symbol,dR=uR?uR.prototype:void 0,fR=dR?dR.toString:void 0;function XH(n,e,t){var r=-1,i=n.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=n[r+e];return s}function e$(n){if(typeof n=="string")return n;if(s$(n))return fR?fR.call(n):"";var e=n+"";return e=="0"&&1/n==-yH?"-0":e}function t$(n,e,t){var r=n.length;return t=t===void 0?r:t,!e&&t>=r?n:XH(n,e,t)}function n$(n){return function(e){e=Gf(e);var t=AR(e)?KH(e):void 0,r=t?t[0]:e.charAt(0),i=t?t$(t,1).join(""):e.slice(1);return r[n]()+i}}function r$(n){return function(e){return qH(u$(c$(e).replace(xH,"")),n,"")}}function i$(n){return!!n&&typeof n=="object"}function s$(n){return typeof n=="symbol"||i$(n)&&JH.call(n)==vH}function Gf(n){return n==null?"":e$(n)}var o$=r$(function(n,e,t){return e=e.toLowerCase(),n+(t?a$(e):e)});function a$(n){return l$(Gf(n).toLowerCase())}function c$(n){return n=Gf(n),n&&n.replace(_H,GH).replace(OH,"")}var l$=n$("toUpperCase");function u$(n,e,t){return n=Gf(n),e=t?void 0:e,e===void 0?WH(n)?YH(n):$H(n):n.match(e)||[]}NR.exports=o$});var p_=I((Tpe,RR)=>{"use strict";RR.exports=d$;function d$(n,e){for(var t=new Array(arguments.length-1),r=0,i=2,s=!0;i<arguments.length;)t[r++]=arguments[i++];return new Promise(function(a,c){t[r]=function(u){if(s)if(s=!1,u)c(u);else{for(var d=new Array(arguments.length-1),f=0;f<d.length;)d[f++]=arguments[f];a.apply(null,d)}};try{n.apply(e||null,t)}catch(l){s&&(s=!1,c(l))}})}});var PR=I(kR=>{"use strict";var Wf=kR;Wf.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&e.charAt(t)==="=";)++r;return Math.ceil(e.length*3)/4-r};var ra=new Array(64),OR=new Array(123);for(wn=0;wn<64;)OR[ra[wn]=wn<26?wn+65:wn<52?wn+71:wn<62?wn-4:wn-59|43]=wn++;var wn;Wf.encode=function(e,t,r){for(var i=null,s=[],o=0,a=0,c;t<r;){var l=e[t++];switch(a){case 0:s[o++]=ra[l>>2],c=(l&3)<<4,a=1;break;case 1:s[o++]=ra[c|l>>4],c=(l&15)<<2,a=2;break;case 2:s[o++]=ra[c|l>>6],s[o++]=ra[l&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=ra[c],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var xR="invalid encoding";Wf.decode=function(e,t,r){for(var i=r,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=OR[c])===void 0)throw Error(xR);switch(s){case 0:o=c,s=1;break;case 1:t[r++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:t[r++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:t[r++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(xR);return r-i};Wf.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var LR=I((wpe,FR)=>{"use strict";FR.exports=Kf;function Kf(){this._listeners={}}Kf.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this};Kf.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this};Kf.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}});var $R=I((Ipe,HR)=>{"use strict";HR.exports=BR(BR);function BR(n){return typeof Float32Array<"u"?(function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),r=t[3]===128;function i(c,l,u){e[0]=c,l[u]=t[0],l[u+1]=t[1],l[u+2]=t[2],l[u+3]=t[3]}function s(c,l,u){e[0]=c,l[u]=t[3],l[u+1]=t[2],l[u+2]=t[1],l[u+3]=t[0]}n.writeFloatLE=r?i:s,n.writeFloatBE=r?s:i;function o(c,l){return t[0]=c[l],t[1]=c[l+1],t[2]=c[l+2],t[3]=c[l+3],e[0]}function a(c,l){return t[3]=c[l],t[2]=c[l+1],t[1]=c[l+2],t[0]=c[l+3],e[0]}n.readFloatLE=r?o:a,n.readFloatBE=r?a:o})():(function(){function e(r,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)r(1/i>0?0:2147483648,s,o);else if(isNaN(i))r(2143289344,s,o);else if(i>34028234663852886e22)r((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)r((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(i)/Math.LN2),l=Math.round(i*Math.pow(2,-c)*8388608)&8388607;r((a<<31|c+127<<23|l)>>>0,s,o)}}n.writeFloatLE=e.bind(null,VR),n.writeFloatBE=e.bind(null,UR);function t(r,i,s){var o=r(i,s),a=(o>>31)*2+1,c=o>>>23&255,l=o&8388607;return c===255?l?NaN:a*(1/0):c===0?a*1401298464324817e-60*l:a*Math.pow(2,c-150)*(l+8388608)}n.readFloatLE=t.bind(null,jR),n.readFloatBE=t.bind(null,qR)})(),typeof Float64Array<"u"?(function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),r=t[7]===128;function i(c,l,u){e[0]=c,l[u]=t[0],l[u+1]=t[1],l[u+2]=t[2],l[u+3]=t[3],l[u+4]=t[4],l[u+5]=t[5],l[u+6]=t[6],l[u+7]=t[7]}function s(c,l,u){e[0]=c,l[u]=t[7],l[u+1]=t[6],l[u+2]=t[5],l[u+3]=t[4],l[u+4]=t[3],l[u+5]=t[2],l[u+6]=t[1],l[u+7]=t[0]}n.writeDoubleLE=r?i:s,n.writeDoubleBE=r?s:i;function o(c,l){return t[0]=c[l],t[1]=c[l+1],t[2]=c[l+2],t[3]=c[l+3],t[4]=c[l+4],t[5]=c[l+5],t[6]=c[l+6],t[7]=c[l+7],e[0]}function a(c,l){return t[7]=c[l],t[6]=c[l+1],t[5]=c[l+2],t[4]=c[l+3],t[3]=c[l+4],t[2]=c[l+5],t[1]=c[l+6],t[0]=c[l+7],e[0]}n.readDoubleLE=r?o:a,n.readDoubleBE=r?a:o})():(function(){function e(r,i,s,o,a,c){var l=o<0?1:0;if(l&&(o=-o),o===0)r(0,a,c+i),r(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))r(0,a,c+i),r(2146959360,a,c+s);else if(o>17976931348623157e292)r(0,a,c+i),r((l<<31|2146435072)>>>0,a,c+s);else{var u;if(o<22250738585072014e-324)u=o/5e-324,r(u>>>0,a,c+i),r((l<<31|u/4294967296)>>>0,a,c+s);else{var d=Math.floor(Math.log(o)/Math.LN2);d===1024&&(d=1023),u=o*Math.pow(2,-d),r(u*4503599627370496>>>0,a,c+i),r((l<<31|d+1023<<20|u*1048576&1048575)>>>0,a,c+s)}}}n.writeDoubleLE=e.bind(null,VR,0,4),n.writeDoubleBE=e.bind(null,UR,4,0);function t(r,i,s,o,a){var c=r(o,a+i),l=r(o,a+s),u=(l>>31)*2+1,d=l>>>20&2047,f=4294967296*(l&1048575)+c;return d===2047?f?NaN:u*(1/0):d===0?u*5e-324*f:u*Math.pow(2,d-1075)*(f+4503599627370496)}n.readDoubleLE=t.bind(null,jR,0,4),n.readDoubleBE=t.bind(null,qR,4,0)})(),n}function VR(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function UR(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function jR(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function qR(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}});var g_=I((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}});var GR=I(zR=>{"use strict";var m_=zR;m_.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)r=e.charCodeAt(i),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,t+=4):t+=3;return t};m_.read=function(e,t,r){var i=r-t;if(i<1)return"";for(var s=null,o=[],a=0,c;t<r;)c=e[t++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};m_.write=function(e,t,r){for(var i=r,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128);return r-i}});var KR=I((Npe,WR)=>{"use strict";WR.exports=f$;function f$(n,e,t){var r=t||8192,i=r>>>1,s=null,o=r;return function(c){if(c<1||c>i)return n(c);o+c>r&&(s=n(r),o=0);var l=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),l}}});var YR=I((Mpe,QR)=>{"use strict";QR.exports=ot;var hl=Xn();function ot(n,e){this.lo=n>>>0,this.hi=e>>>0}var Ds=ot.zero=new ot(0,0);Ds.toNumber=function(){return 0};Ds.zzEncode=Ds.zzDecode=function(){return this};Ds.length=function(){return 1};var h$=ot.zeroHash="\0\0\0\0\0\0\0\0";ot.fromNumber=function(e){if(e===0)return Ds;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new ot(r,i)};ot.from=function(e){if(typeof e=="number")return ot.fromNumber(e);if(hl.isString(e))if(hl.Long)e=hl.Long.fromString(e);else return ot.fromNumber(parseInt(e,10));return e.low||e.high?new ot(e.low>>>0,e.high>>>0):Ds};ot.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+r*4294967296)}return this.lo+this.hi*4294967296};ot.prototype.toLong=function(e){return hl.Long?new hl.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var gi=String.prototype.charCodeAt;ot.fromHash=function(e){return e===h$?Ds:new ot((gi.call(e,0)|gi.call(e,1)<<8|gi.call(e,2)<<16|gi.call(e,3)<<24)>>>0,(gi.call(e,4)|gi.call(e,5)<<8|gi.call(e,6)<<16|gi.call(e,7)<<24)>>>0)};ot.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};ot.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};ot.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};ot.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}});var Xn=I(y_=>{"use strict";var j=y_;j.asPromise=p_();j.base64=PR();j.EventEmitter=LR();j.float=$R();j.inquire=g_();j.utf8=GR();j.pool=KR();j.LongBits=YR();j.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);j.global=j.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||y_;j.emptyArray=Object.freeze?Object.freeze([]):[];j.emptyObject=Object.freeze?Object.freeze({}):{};j.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};j.isString=function(e){return typeof e=="string"||e instanceof String};j.isObject=function(e){return e&&typeof e=="object"};j.isset=j.isSet=function(e,t){var r=e[t];return r!=null&&e.hasOwnProperty(t)?typeof r!="object"||(Array.isArray(r)?r.length:Object.keys(r).length)>0:!1};j.Buffer=(function(){try{var n=j.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}})();j._Buffer_from=null;j._Buffer_allocUnsafe=null;j.newBuffer=function(e){return typeof e=="number"?j.Buffer?j._Buffer_allocUnsafe(e):new j.Array(e):j.Buffer?j._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};j.Array=typeof Uint8Array<"u"?Uint8Array:Array;j.Long=j.global.dcodeIO&&j.global.dcodeIO.Long||j.global.Long||j.inquire("long");j.key2Re=/^true|false|0|1$/;j.key32Re=/^-?(?:0|[1-9][0-9]*)$/;j.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;j.longToHash=function(e){return e?j.LongBits.from(e).toHash():j.LongBits.zeroHash};j.longFromHash=function(e,t){var r=j.LongBits.fromHash(e);return j.Long?j.Long.fromBits(r.lo,r.hi,t):r.toNumber(!!t)};function ZR(n,e,t){for(var r=Object.keys(e),i=0;i<r.length;++i)(n[r[i]]===void 0||!t)&&(n[r[i]]=e[r[i]]);return n}j.merge=ZR;j.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function JR(n){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),r&&ZR(this,r)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return n},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}j.newError=JR;j.ProtocolError=JR("ProtocolError");j.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(t[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};j.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}};j.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};j._configure=function(){var n=j.Buffer;if(!n){j._Buffer_from=j._Buffer_allocUnsafe=null;return}j._Buffer_from=n.from!==Uint8Array.from&&n.from||function(t,r){return new n(t,r)},j._Buffer_allocUnsafe=n.allocUnsafe||function(t){return new n(t)}}});var Yf=I((xpe,nx)=>{"use strict";nx.exports=Ee;var gn=Xn(),v_,Qf=gn.LongBits,XR=gn.base64,ex=gn.utf8;function pl(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function __(){}function p$(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function Ee(){this.len=0,this.head=new pl(__,0,0),this.tail=this.head,this.states=null}var tx=function(){return gn.Buffer?function(){return(Ee.create=function(){return new v_})()}:function(){return new Ee}};Ee.create=tx();Ee.alloc=function(e){return new gn.Array(e)};gn.Array!==Array&&(Ee.alloc=gn.pool(Ee.alloc,gn.Array.prototype.subarray));Ee.prototype._push=function(e,t,r){return this.tail=this.tail.next=new pl(e,t,r),this.len+=t,this};function C_(n,e,t){e[t]=n&255}function g$(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function b_(n,e){this.len=n,this.next=void 0,this.val=e}b_.prototype=Object.create(pl.prototype);b_.prototype.fn=g$;Ee.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new b_((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Ee.prototype.int32=function(e){return e<0?this._push(S_,10,Qf.fromNumber(e)):this.uint32(e)};Ee.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function S_(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}Ee.prototype.uint64=function(e){var t=Qf.from(e);return this._push(S_,t.length(),t)};Ee.prototype.int64=Ee.prototype.uint64;Ee.prototype.sint64=function(e){var t=Qf.from(e).zzEncode();return this._push(S_,t.length(),t)};Ee.prototype.bool=function(e){return this._push(C_,1,e?1:0)};function E_(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}Ee.prototype.fixed32=function(e){return this._push(E_,4,e>>>0)};Ee.prototype.sfixed32=Ee.prototype.fixed32;Ee.prototype.fixed64=function(e){var t=Qf.from(e);return this._push(E_,4,t.lo)._push(E_,4,t.hi)};Ee.prototype.sfixed64=Ee.prototype.fixed64;Ee.prototype.float=function(e){return this._push(gn.float.writeFloatLE,4,e)};Ee.prototype.double=function(e){return this._push(gn.float.writeDoubleLE,8,e)};var m$=gn.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};Ee.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(C_,1,0);if(gn.isString(e)){var r=Ee.alloc(t=XR.length(e));XR.decode(e,r,0),e=r}return this.uint32(t)._push(m$,t,e)};Ee.prototype.string=function(e){var t=ex.length(e);return t?this.uint32(t)._push(ex.write,t,e):this._push(C_,1,0)};Ee.prototype.fork=function(){return this.states=new p$(this),this.head=this.tail=new pl(__,0,0),this.len=0,this};Ee.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new pl(__,0,0),this.len=0),this};Ee.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this};Ee.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t};Ee._configure=function(n){v_=n,Ee.create=tx(),v_._configure()}});var sx=I((Ope,ix)=>{"use strict";ix.exports=er;var rx=Yf();(er.prototype=Object.create(rx.prototype)).constructor=er;var mi=Xn();function er(){rx.call(this)}er._configure=function(){er.alloc=mi._Buffer_allocUnsafe,er.writeBytesBuffer=mi.Buffer&&mi.Buffer.prototype instanceof Uint8Array&&mi.Buffer.prototype.set.name==="set"?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}};er.prototype.bytes=function(e){mi.isString(e)&&(e=mi._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(er.writeBytesBuffer,t,e),this};function y$(n,e,t){n.length<40?mi.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}er.prototype.string=function(e){var t=mi.Buffer.byteLength(e);return this.uint32(t),t&&this._push(y$,t,e),this};er._configure()});var Jf=I((kpe,ux)=>{"use strict";ux.exports=We;var In=Xn(),D_,cx=In.LongBits,v$=In.utf8;function An(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function We(n){this.buf=n,this.pos=0,this.len=n.length}var ox=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new We(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new We(e);throw Error("illegal buffer")},lx=function(){return In.Buffer?function(t){return(We.create=function(i){return In.Buffer.isBuffer(i)?new D_(i):ox(i)})(t)}:ox};We.create=lx();We.prototype._slice=In.Array.prototype.subarray||In.Array.prototype.slice;We.prototype.uint32=(function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,An(this,10);return e}})();We.prototype.int32=function(){return this.uint32()|0};We.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function T_(){var n=new cx(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw An(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw An(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}We.prototype.bool=function(){return this.uint32()!==0};function Zf(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}We.prototype.fixed32=function(){if(this.pos+4>this.len)throw An(this,4);return Zf(this.buf,this.pos+=4)};We.prototype.sfixed32=function(){if(this.pos+4>this.len)throw An(this,4);return Zf(this.buf,this.pos+=4)|0};function ax(){if(this.pos+8>this.len)throw An(this,8);return new cx(Zf(this.buf,this.pos+=4),Zf(this.buf,this.pos+=4))}We.prototype.float=function(){if(this.pos+4>this.len)throw An(this,4);var e=In.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};We.prototype.double=function(){if(this.pos+8>this.len)throw An(this,4);var e=In.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};We.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw An(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var i=In.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)};We.prototype.string=function(){var e=this.bytes();return v$.read(e,0,e.length)};We.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw An(this,e);this.pos+=e}else do if(this.pos>=this.len)throw An(this);while(this.buf[this.pos++]&128);return this};We.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};We._configure=function(n){D_=n,We.create=lx(),D_._configure();var e=In.Long?"toLong":"toNumber";In.merge(We.prototype,{int64:function(){return T_.call(this)[e](!1)},uint64:function(){return T_.call(this)[e](!0)},sint64:function(){return T_.call(this).zzDecode()[e](!1)},fixed64:function(){return ax.call(this)[e](!0)},sfixed64:function(){return ax.call(this)[e](!1)}})}});var px=I((Ppe,hx)=>{"use strict";hx.exports=ws;var fx=Jf();(ws.prototype=Object.create(fx.prototype)).constructor=ws;var dx=Xn();function ws(n){fx.call(this,n)}ws._configure=function(){dx.Buffer&&(ws.prototype._slice=dx.Buffer.prototype.slice)};ws.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};ws._configure()});var mx=I((Fpe,gx)=>{"use strict";gx.exports=gl;var w_=Xn();(gl.prototype=Object.create(w_.EventEmitter.prototype)).constructor=gl;function gl(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");w_.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!e,this.responseDelimited=!!t}gl.prototype.rpcCall=function n(e,t,r,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return w_.asPromise(n,o,e,t,r,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(c,l){if(c)return o.emit("error",c,e),s(c);if(l===null){o.end(!0);return}if(!(l instanceof r))try{l=r[o.responseDelimited?"decodeDelimited":"decode"](l)}catch(u){return o.emit("error",u,e),s(u)}return o.emit("data",l,e),s(null,l)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};gl.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var I_=I(yx=>{"use strict";var E$=yx;E$.Service=mx()});var A_=I((Bpe,vx)=>{"use strict";vx.exports={}});var Cx=I(_x=>{"use strict";var qt=_x;qt.build="minimal";qt.Writer=Yf();qt.BufferWriter=sx();qt.Reader=Jf();qt.BufferReader=px();qt.util=Xn();qt.rpc=I_();qt.roots=A_();qt.configure=Ex;function Ex(){qt.util._configure(),qt.Writer._configure(qt.BufferWriter),qt.Reader._configure(qt.BufferReader)}Ex()});var Sx=I((Upe,bx)=>{"use strict";bx.exports=N_;function N_(n,e){typeof n=="string"&&(e=n,n=void 0);var t=[];function r(s){if(typeof s!="string"){var o=i();if(N_.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),c=new Array(a.length+1),l=new Array(a.length),u=0;u<a.length;)c[u]=a[u],l[u]=s[a[u++]];return c[u]=o,Function.apply(null,c).apply(null,l)}return Function(o)()}for(var d=new Array(arguments.length-1),f=0;f<d.length;)d[f]=arguments[++f];if(f=0,s=s.replace(/%([%dfijs])/g,function(_,b){var T=d[f++];switch(b){case"d":case"f":return String(Number(T));case"i":return String(Math.floor(T));case"j":return JSON.stringify(T);case"s":return String(T)}return"%"}),f!==d.length)throw Error("parameter count mismatch");return t.push(s),r}function i(s){return"function "+(s||e||"")+"("+(n&&n.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return r.toString=i,r}N_.verbose=!1});var Dx=I((jpe,Tx)=>{"use strict";Tx.exports=ml;var _$=p_(),C$=g_(),M_=C$("fs");function ml(n,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&M_&&M_.readFile?M_.readFile(n,function(i,s){return i&&typeof XMLHttpRequest<"u"?ml.xhr(n,e,t):i?t(i):t(null,e.binary?s:s.toString("utf8"))}):ml.xhr(n,e,t):_$(ml,this,n,e)}ml.xhr=function(e,t,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return r(Error("status "+i.status));if(t.binary){var o=i.response;if(!o){o=[];for(var a=0;a<i.responseText.length;++a)o.push(i.responseText.charCodeAt(a)&255)}return r(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return r(null,i.responseText)}},t.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}});var Ax=I(Ix=>{"use strict";var x_=Ix,wx=x_.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},R_=x_.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),r=wx(e),i="";r&&(i=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):r?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return i+t.join("/")};x_.resolve=function(e,t,r){return r||(t=R_(t)),wx(t)?t:(r||(e=R_(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?R_(e+"/"+t):t)}});var sa=I((Hpe,Rx)=>{"use strict";Rx.exports=ge;var Xf=vi();((ge.prototype=Object.create(Xf.prototype)).constructor=ge).className="Namespace";var O_=yi(),eh=at(),b$=Ns(),Is,ia,As;ge.fromJSON=function(e,t){return new ge(e,t.options).addJSON(t.nested)};function Nx(n,e){if(n&&n.length){for(var t={},r=0;r<n.length;++r)t[n[r].name]=n[r].toJSON(e);return t}}ge.arrayToJSON=Nx;ge.isReservedId=function(e,t){if(e){for(var r=0;r<e.length;++r)if(typeof e[r]!="string"&&e[r][0]<=t&&e[r][1]>t)return!0}return!1};ge.isReservedName=function(e,t){if(e){for(var r=0;r<e.length;++r)if(e[r]===t)return!0}return!1};function ge(n,e){Xf.call(this,n,e),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function Mx(n){n._nestedArray=null,n._lookupCache={};for(var e=n;e=e.parent;)e._lookupCache={};return n}Object.defineProperty(ge.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=eh.toArray(this.nested))}});ge.prototype.toJSON=function(e){return eh.toObject(["options",this.options,"nested",Nx(this.nestedArray,e)])};ge.prototype.addJSON=function(e){var t=this;if(e)for(var r=Object.keys(e),i=0,s;i<r.length;++i)s=e[r[i]],t.add((s.fields!==void 0?Is.fromJSON:s.values!==void 0?As.fromJSON:s.methods!==void 0?ia.fromJSON:s.id!==void 0?O_.fromJSON:ge.fromJSON)(r[i],s));return this};ge.prototype.get=function(e){return this.nested&&this.nested[e]||null};ge.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof As)return this.nested[e].values;throw Error("no such enum: "+e)};ge.prototype.add=function(e){if(!(e instanceof O_&&e.extend!==void 0||e instanceof Is||e instanceof b$||e instanceof As||e instanceof ia||e instanceof ge))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof ge&&e instanceof ge&&!(t instanceof Is||t instanceof ia)){for(var r=t.nestedArray,i=0;i<r.length;++i)e.add(r[i]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}this.nested[e.name]=e,this instanceof Is||this instanceof ia||this instanceof As||this instanceof O_||e._edition||(e._edition=e._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var s=this;s=s.parent;)s._needsRecursiveFeatureResolution=!0,s._needsRecursiveResolve=!0;return e.onAdd(this),Mx(this)};ge.prototype.remove=function(e){if(!(e instanceof Xf))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),Mx(this)};ge.prototype.define=function(e,t){if(eh.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var r=this;e.length>0;){var i=e.shift();if(r.nested&&r.nested[i]){if(r=r.nested[i],!(r instanceof ge))throw Error("path conflicts with non-namespace objects")}else r.add(r=new ge(i))}return t&&r.addJSON(t),r};ge.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var e=this.nestedArray,t=0;for(this.resolve();t<e.length;)e[t]instanceof ge?e[t++].resolveAll():e[t++].resolve();return this._needsRecursiveResolve=!1,this};ge.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(this._needsRecursiveFeatureResolution=!1,e=this._edition||e,Xf.prototype._resolveFeaturesRecursive.call(this,e),this.nestedArray.forEach(t=>{t._resolveFeaturesRecursive(e)}),this):this};ge.prototype.lookup=function(e,t,r){if(typeof t=="boolean"?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),eh.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;var i=e.join(".");if(e[0]==="")return this.root.lookup(e.slice(1),t);var s=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+i];if(s&&(!t||t.indexOf(s.constructor)>-1)||(s=this._lookupImpl(e,i),s&&(!t||t.indexOf(s.constructor)>-1)))return s;if(r)return null;for(var o=this;o.parent;){if(s=o.parent._lookupImpl(e,i),s&&(!t||t.indexOf(s.constructor)>-1))return s;o=o.parent}return null};ge.prototype._lookupImpl=function(e,t){if(Object.prototype.hasOwnProperty.call(this._lookupCache,t))return this._lookupCache[t];var r=this.get(e[0]),i=null;if(r)e.length===1?i=r:r instanceof ge&&(e=e.slice(1),i=r._lookupImpl(e,e.join(".")));else for(var s=0;s<this.nestedArray.length;++s)this._nestedArray[s]instanceof ge&&(r=this._nestedArray[s]._lookupImpl(e,t))&&(i=r);return this._lookupCache[t]=i,i};ge.prototype.lookupType=function(e){var t=this.lookup(e,[Is]);if(!t)throw Error("no such type: "+e);return t};ge.prototype.lookupEnum=function(e){var t=this.lookup(e,[As]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};ge.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[Is,As]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};ge.prototype.lookupService=function(e){var t=this.lookup(e,[ia]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};ge._configure=function(n,e,t){Is=n,ia=e,As=t}});var th=I(($pe,xx)=>{"use strict";xx.exports=Rr;var k_=yi();((Rr.prototype=Object.create(k_.prototype)).constructor=Rr).className="MapField";var S$=Ms(),yl=at();function Rr(n,e,t,r,i,s){if(k_.call(this,n,e,r,void 0,void 0,i,s),!yl.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}Rr.fromJSON=function(e,t){return new Rr(e,t.id,t.keyType,t.type,t.options,t.comment)};Rr.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return yl.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Rr.prototype.resolve=function(){if(this.resolved)return this;if(S$.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return k_.prototype.resolve.call(this)};Rr.d=function(e,t,r){return typeof r=="function"?r=yl.decorateType(r).name:r&&typeof r=="object"&&(r=yl.decorateEnum(r).name),function(s,o){yl.decorateType(s.constructor).add(new Rr(o,e,t,r))}}});var nh=I((zpe,Ox)=>{"use strict";Ox.exports=Rs;var P_=vi();((Rs.prototype=Object.create(P_.prototype)).constructor=Rs).className="Method";var oa=at();function Rs(n,e,t,r,i,s,o,a,c){if(oa.isObject(i)?(o=i,i=s=void 0):oa.isObject(s)&&(o=s,s=void 0),!(e===void 0||oa.isString(e)))throw TypeError("type must be a string");if(!oa.isString(t))throw TypeError("requestType must be a string");if(!oa.isString(r))throw TypeError("responseType must be a string");P_.call(this,n,o),this.type=e||"rpc",this.requestType=t,this.requestStream=i?!0:void 0,this.responseType=r,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=c}Rs.fromJSON=function(e,t){return new Rs(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};Rs.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return oa.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};Rs.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),P_.prototype.resolve.call(this))}});var rh=I((Gpe,Px)=>{"use strict";Px.exports=Yt;var xr=sa();((Yt.prototype=Object.create(xr.prototype)).constructor=Yt).className="Service";var F_=nh(),vl=at(),T$=I_();function Yt(n,e){xr.call(this,n,e),this.methods={},this._methodsArray=null}Yt.fromJSON=function(e,t){var r=new Yt(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),s=0;s<i.length;++s)r.add(F_.fromJSON(i[s],t.methods[i[s]]));return t.nested&&r.addJSON(t.nested),t.edition&&(r._edition=t.edition),r.comment=t.comment,r._defaultEdition="proto3",r};Yt.prototype.toJSON=function(e){var t=xr.prototype.toJSON.call(this,e),r=e?!!e.keepComments:!1;return vl.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"methods",xr.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};Object.defineProperty(Yt.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=vl.toArray(this.methods))}});function kx(n){return n._methodsArray=null,n}Yt.prototype.get=function(e){return this.methods[e]||xr.prototype.get.call(this,e)};Yt.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;xr.prototype.resolve.call(this);for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return this};Yt.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(e=this._edition||e,xr.prototype._resolveFeaturesRecursive.call(this,e),this.methodsArray.forEach(t=>{t._resolveFeaturesRecursive(e)}),this):this};Yt.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof F_?(this.methods[e.name]=e,e.parent=this,kx(this)):xr.prototype.add.call(this,e)};Yt.prototype.remove=function(e){if(e instanceof F_){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,kx(this)}return xr.prototype.remove.call(this,e)};Yt.prototype.create=function(e,t,r){for(var i=new T$.Service(e,t,r),s=0,o;s<this.methodsArray.length;++s){var a=vl.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[a]=vl.codegen(["r","c"],vl.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return i}});var ih=I((Wpe,Fx)=>{"use strict";Fx.exports=tr;var D$=Xn();function tr(n){if(n)for(var e=Object.keys(n),t=0;t<e.length;++t)this[e[t]]=n[e[t]]}tr.create=function(e){return this.$type.create(e)};tr.encode=function(e,t){return this.$type.encode(e,t)};tr.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};tr.decode=function(e){return this.$type.decode(e)};tr.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};tr.verify=function(e){return this.$type.verify(e)};tr.fromObject=function(e){return this.$type.fromObject(e)};tr.toObject=function(e,t){return this.$type.toObject(e,t)};tr.prototype.toJSON=function(){return this.$type.toObject(this,D$.toJSONOptions)}});var L_=I((Kpe,Bx)=>{"use strict";Bx.exports=A$;var w$=Nn(),Or=Ms(),Lx=at();function I$(n){return"missing required '"+n.name+"'"}function A$(n){for(var e=Lx.codegen(["r","l","e"],n.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(n.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),t=0;t<n.fieldsArray.length;++t){var r=n._fieldsArray[t].resolve(),i=r.resolvedType instanceof w$?"int32":r.type,s="m"+Lx.safeProp(r.name);e("case %i: {",r.id),r.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),Or.defaults[r.keyType]!==void 0?e("k=%j",Or.defaults[r.keyType]):e("k=null"),Or.defaults[i]!==void 0?e("value=%j",Or.defaults[i]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",r.keyType)("case 2:"),Or.basic[i]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",i),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),Or.long[r.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):r.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),Or.packed[i]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),Or.basic[i]===void 0?e(r.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,i)):Or.basic[i]===void 0?e(r.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,i),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<n._fieldsArray.length;++t){var o=n._fieldsArray[t];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",I$(o))}return e("return m")}});var U_=I((Qpe,Vx)=>{"use strict";Vx.exports=R$;var N$=Nn(),B_=at();function mn(n,e){return n.name+": "+e+(n.repeated&&e!=="array"?"[]":n.map&&e!=="object"?"{k:"+n.keyType+"}":"")+" expected"}function V_(n,e,t,r){if(e.resolvedType)if(e.resolvedType instanceof N$){n("switch(%s){",r)("default:")("return%j",mn(e,"enum value"));for(var i=Object.keys(e.resolvedType.values),s=0;s<i.length;++s)n("case %i:",e.resolvedType.values[i[s]]);n("break")("}")}else n("{")("var e=types[%i].verify(%s);",t,r)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.isInteger(%s))",r)("return%j",mn(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",mn(e,"integer|Long"));break;case"float":case"double":n('if(typeof %s!=="number")',r)("return%j",mn(e,"number"));break;case"bool":n('if(typeof %s!=="boolean")',r)("return%j",mn(e,"boolean"));break;case"string":n("if(!util.isString(%s))",r)("return%j",mn(e,"string"));break;case"bytes":n('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",mn(e,"buffer"));break}return n}function M$(n,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.key32Re.test(%s))",t)("return%j",mn(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.key64Re.test(%s))",t)("return%j",mn(e,"integer|Long key"));break;case"bool":n("if(!util.key2Re.test(%s))",t)("return%j",mn(e,"boolean key"));break}return n}function R$(n){var e=B_.codegen(["m"],n.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=n.oneofsArray,r={};t.length&&e("var p={}");for(var i=0;i<n.fieldsArray.length;++i){var s=n._fieldsArray[i].resolve(),o="m"+B_.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",mn(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),M$(e,s,"k[i]"),V_(e,s,i,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",mn(s,"array"))("for(var i=0;i<%s.length;++i){",o),V_(e,s,i,o+"[i]")("}");else{if(s.partOf){var a=B_.safeProp(s.partOf.name);r[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),r[s.partOf.name]=1,e("p%s=1",a)}V_(e,s,i,o)}s.optional&&e("}")}return e("return null")}});var H_=I(jx=>{"use strict";var Ux=jx,El=Nn(),nr=at();function j_(n,e,t,r){var i=!1;if(e.resolvedType)if(e.resolvedType instanceof El){n("switch(d%s){",r);for(var s=e.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===e.typeDefault&&!i&&(n("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',r,r,r),e.repeated||n("break"),i=!0),n("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",r,s[o[a]])("break");n("}")}else n('if(typeof d%s!=="object")',r)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,t,r);else{var c=!1;switch(e.type){case"double":case"float":n("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":n("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":n("m%s=d%s|0",r,r);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,c)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,c?"true":"");break;case"bytes":n('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length >= 0)",r)("m%s=d%s",r,r);break;case"string":n("m%s=String(d%s)",r,r);break;case"bool":n("m%s=Boolean(d%s)",r,r);break}}return n}Ux.fromObject=function(e){var t=e.fieldsArray,r=nr.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var i=0;i<t.length;++i){var s=t[i].resolve(),o=nr.safeProp(s.name);s.map?(r("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),j_(r,s,i,o+"[ks[i]]")("}")("}")):s.repeated?(r("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),j_(r,s,i,o+"[i]")("}")("}")):(s.resolvedType instanceof El||r("if(d%s!=null){",o),j_(r,s,i,o),s.resolvedType instanceof El||r("}"))}return r("return m")};function q_(n,e,t,r){if(e.resolvedType)e.resolvedType instanceof El?n("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",r,t,r,r,t,r,r):n("d%s=types[%i].toObject(m%s,o)",r,t,r);else{var i=!1;switch(e.type){case"double":case"float":n("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,i?"true":"",r);break;case"bytes":n("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:n("d%s=m%s",r,r);break}}return n}Ux.toObject=function(e){var t=e.fieldsArray.slice().sort(nr.compareFieldsById);if(!t.length)return nr.codegen()("return {}");for(var r=nr.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],o=[],a=0;a<t.length;++a)t[a].partOf||(t[a].resolve().repeated?i:t[a].map?s:o).push(t[a]);if(i.length){for(r("if(o.arrays||o.defaults){"),a=0;a<i.length;++a)r("d%s=[]",nr.safeProp(i[a].name));r("}")}if(s.length){for(r("if(o.objects||o.defaults){"),a=0;a<s.length;++a)r("d%s={}",nr.safeProp(s[a].name));r("}")}if(o.length){for(r("if(o.defaults){"),a=0;a<o.length;++a){var c=o[a],l=nr.safeProp(c.name);if(c.resolvedType instanceof El)r("d%s=o.enums===String?%j:%j",l,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var u="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",l,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",l,u)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",l,l)("}")}else r("d%s=%j",l,c.typeDefault)}r("}")}var d=!1;for(a=0;a<t.length;++a){var c=t[a],f=e._fieldsArray.indexOf(c),l=nr.safeProp(c.name);c.map?(d||(d=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),q_(r,c,f,l+"[ks2[j]]")("}")):c.repeated?(r("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),q_(r,c,f,l+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",l,c.name),q_(r,c,f,l),c.partOf&&r("if(o.oneofs)")("d%s=%j",nr.safeProp(c.partOf.name),c.name)),r("}")}return r("return d")}});var $_=I(qx=>{"use strict";var x$=qx,O$=ih();x$[".google.protobuf.Any"]={fromObject:function(n){if(n&&n["@type"]){var e=n["@type"].substring(n["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var r=n["@type"].charAt(0)==="."?n["@type"].slice(1):n["@type"];return r.indexOf("/")===-1&&(r="/"+r),this.create({type_url:r,value:t.encode(t.fromObject(n)).finish()})}}return this.fromObject(n)},toObject:function(n,e){var t="type.googleapis.com/",r="",i="";if(e&&e.json&&n.type_url&&n.value){i=n.type_url.substring(n.type_url.lastIndexOf("/")+1),r=n.type_url.substring(0,n.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(n=s.decode(n.value))}if(!(n instanceof this.ctor)&&n instanceof O$){var o=n.$type.toObject(n,e),a=n.$type.fullName[0]==="."?n.$type.fullName.slice(1):n.$type.fullName;return r===""&&(r=t),i=r+a,o["@type"]=i,o}return this.toObject(n,e)}}});var ah=I((Jpe,$x)=>{"use strict";$x.exports=xe;var yn=sa();((xe.prototype=Object.create(yn.prototype)).constructor=xe).className="Type";var k$=Nn(),W_=Ns(),sh=yi(),P$=th(),F$=rh(),z_=ih(),G_=Jf(),L$=Yf(),Dt=at(),B$=K_(),V$=L_(),U$=U_(),Hx=H_(),j$=$_();function xe(n,e){yn.call(this,n,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(xe.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var n=Object.keys(this.fields),e=0;e<n.length;++e){var t=this.fields[n[e]],r=t.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=Dt.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=Dt.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=xe.generateConstructor(this)())},set:function(n){var e=n.prototype;e instanceof z_||((n.prototype=new z_).constructor=n,Dt.merge(n.prototype,e)),n.$type=n.prototype.$type=this,Dt.merge(n,z_,!0),this._ctor=n;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var r={};for(t=0;t<this.oneofsArray.length;++t)r[this._oneofsArray[t].resolve().name]={get:Dt.oneOfGetter(this._oneofsArray[t].oneof),set:Dt.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(n.prototype,r)}}});xe.generateConstructor=function(e){for(var t=Dt.codegen(["p"],e.name),r=0,i;r<e.fieldsArray.length;++r)(i=e._fieldsArray[r]).map?t("this%s={}",Dt.safeProp(i.name)):i.repeated&&t("this%s=[]",Dt.safeProp(i.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function oh(n){return n._fieldsById=n._fieldsArray=n._oneofsArray=null,delete n.encode,delete n.decode,delete n.verify,n}xe.fromJSON=function(e,t){var r=new xe(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var i=Object.keys(t.fields),s=0;s<i.length;++s)r.add((typeof t.fields[i[s]].keyType<"u"?P$.fromJSON:sh.fromJSON)(i[s],t.fields[i[s]]));if(t.oneofs)for(i=Object.keys(t.oneofs),s=0;s<i.length;++s)r.add(W_.fromJSON(i[s],t.oneofs[i[s]]));if(t.nested)for(i=Object.keys(t.nested),s=0;s<i.length;++s){var o=t.nested[i[s]];r.add((o.id!==void 0?sh.fromJSON:o.fields!==void 0?xe.fromJSON:o.values!==void 0?k$.fromJSON:o.methods!==void 0?F$.fromJSON:yn.fromJSON)(i[s],o))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r};xe.prototype.toJSON=function(e){var t=yn.prototype.toJSON.call(this,e),r=e?!!e.keepComments:!1;return Dt.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"oneofs",yn.arrayToJSON(this.oneofsArray,e),"fields",yn.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};xe.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;yn.prototype.resolveAll.call(this);var e=this.oneofsArray;for(r=0;r<e.length;)e[r++].resolve();for(var t=this.fieldsArray,r=0;r<t.length;)t[r++].resolve();return this};xe.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(e=this._edition||e,yn.prototype._resolveFeaturesRecursive.call(this,e),this.oneofsArray.forEach(t=>{t._resolveFeatures(e)}),this.fieldsArray.forEach(t=>{t._resolveFeatures(e)}),this):this};xe.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};xe.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof sh&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),oh(this)}return e instanceof W_?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),oh(this)):yn.prototype.add.call(this,e)};xe.prototype.remove=function(e){if(e instanceof sh&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),oh(this)}if(e instanceof W_){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),oh(this)}return yn.prototype.remove.call(this,e)};xe.prototype.isReservedId=function(e){return yn.isReservedId(this.reserved,e)};xe.prototype.isReservedName=function(e){return yn.isReservedName(this.reserved,e)};xe.prototype.create=function(e){return new this.ctor(e)};xe.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=B$(this)({Writer:L$,types:t,util:Dt}),this.decode=V$(this)({Reader:G_,types:t,util:Dt}),this.verify=U$(this)({types:t,util:Dt}),this.fromObject=Hx.fromObject(this)({types:t,util:Dt}),this.toObject=Hx.toObject(this)({types:t,util:Dt});var i=j$[e];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};xe.prototype.encode=function(e,t){return this.setup().encode(e,t)};xe.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};xe.prototype.decode=function(e,t){return this.setup().decode(e,t)};xe.prototype.decodeDelimited=function(e){return e instanceof G_||(e=G_.create(e)),this.decode(e,e.uint32())};xe.prototype.verify=function(e){return this.setup().verify(e)};xe.prototype.fromObject=function(e){return this.setup().fromObject(e)};xe.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};xe.d=function(e){return function(r){Dt.decorateType(r,e)}}});var dh=I((Xpe,Wx)=>{"use strict";Wx.exports=Zt;var uh=sa();((Zt.prototype=Object.create(uh.prototype)).constructor=Zt).className="Root";var ch=yi(),Q_=Nn(),q$=Ns(),Ei=at(),Y_,Z_,_l;function Zt(n){uh.call(this,"",n),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}Zt.fromJSON=function(e,t){return t||(t=new Zt),e.options&&t.setOptions(e.options),t.addJSON(e.nested).resolveAll()};Zt.prototype.resolvePath=Ei.path.resolve;Zt.prototype.fetch=Ei.fetch;function Gx(){}Zt.prototype.load=function n(e,t,r){typeof t=="function"&&(r=t,t=void 0);var i=this;if(!r)return Ei.asPromise(n,i,e,t);var s=r===Gx;function o(h,_){if(r){if(s)throw h;_&&_.resolveAll();var b=r;r=null,b(h,_)}}function a(h){var _=h.lastIndexOf("google/protobuf/");if(_>-1){var b=h.substring(_);if(b in _l)return b}return null}function c(h,_){try{if(Ei.isString(_)&&_.charAt(0)==="{"&&(_=JSON.parse(_)),!Ei.isString(_))i.setOptions(_.options).addJSON(_.nested);else{Z_.filename=h;var b=Z_(_,i,t),T,D=0;if(b.imports)for(;D<b.imports.length;++D)(T=a(b.imports[D])||i.resolvePath(h,b.imports[D]))&&l(T);if(b.weakImports)for(D=0;D<b.weakImports.length;++D)(T=a(b.weakImports[D])||i.resolvePath(h,b.weakImports[D]))&&l(T,!0)}}catch(k){o(k)}!s&&!u&&o(null,i)}function l(h,_){if(h=a(h)||h,!(i.files.indexOf(h)>-1)){if(i.files.push(h),h in _l){s?c(h,_l[h]):(++u,setTimeout(function(){--u,c(h,_l[h])}));return}if(s){var b;try{b=Ei.fs.readFileSync(h).toString("utf8")}catch(T){_||o(T);return}c(h,b)}else++u,i.fetch(h,function(T,D){if(--u,!!r){if(T){_?u||o(null,i):o(T);return}c(h,D)}})}}var u=0;Ei.isString(e)&&(e=[e]);for(var d=0,f;d<e.length;++d)(f=i.resolvePath("",e[d]))&&l(f);return s?(i.resolveAll(),i):(u||o(null,i),i)};Zt.prototype.loadSync=function(e,t){if(!Ei.isNode)throw Error("not supported");return this.load(e,t,Gx)};Zt.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return uh.prototype.resolveAll.call(this)};var lh=/^[A-Z]/;function zx(n,e){var t=e.parent.lookup(e.extend);if(t){var r=new ch(e.fullName,e.id,e.type,e.rule,void 0,e.options);return t.get(r.name)||(r.declaringField=e,e.extensionField=r,t.add(r)),!0}return!1}Zt.prototype._handleAdd=function(e){if(e instanceof ch)e.extend!==void 0&&!e.extensionField&&(zx(this,e)||this.deferred.push(e));else if(e instanceof Q_)lh.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof q$)){if(e instanceof Y_)for(var t=0;t<this.deferred.length;)zx(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);lh.test(e.name)&&(e.parent[e.name]=e)}(e instanceof Y_||e instanceof Q_||e instanceof ch)&&(this._fullyQualifiedObjects[e.fullName]=e)};Zt.prototype._handleRemove=function(e){if(e instanceof ch){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof Q_)lh.test(e.name)&&delete e.parent[e.name];else if(e instanceof uh){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);lh.test(e.name)&&delete e.parent[e.name]}delete this._fullyQualifiedObjects[e.fullName]};Zt._configure=function(n,e,t){Y_=n,Z_=e,_l=t}});var at=I((ege,Qx)=>{"use strict";var Ke=Qx.exports=Xn(),Kx=A_(),J_,X_;Ke.codegen=Sx();Ke.fetch=Dx();Ke.path=Ax();Ke.fs=Ke.inquire("fs");Ke.toArray=function(e){if(e){for(var t=Object.keys(e),r=new Array(t.length),i=0;i<t.length;)r[i]=e[t[i++]];return r}return[]};Ke.toObject=function(e){for(var t={},r=0;r<e.length;){var i=e[r++],s=e[r++];s!==void 0&&(t[i]=s)}return t};var H$=/\\/g,$$=/"/g;Ke.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};Ke.safeProp=function(e){return!/^[$\w_]+$/.test(e)||Ke.isReserved(e)?'["'+e.replace(H$,"\\\\").replace($$,'\\"')+'"]':"."+e};Ke.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var z$=/_([a-z])/g;Ke.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(z$,function(t,r){return r.toUpperCase()})};Ke.compareFieldsById=function(e,t){return e.id-t.id};Ke.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(Ke.decorateRoot.remove(e.$type),e.$type.name=t,Ke.decorateRoot.add(e.$type)),e.$type;J_||(J_=ah());var r=new J_(t||e.name);return Ke.decorateRoot.add(r),r.ctor=e,Object.defineProperty(e,"$type",{value:r,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:r,enumerable:!1}),r};var G$=0;Ke.decorateEnum=function(e){if(e.$type)return e.$type;X_||(X_=Nn());var t=new X_("Enum"+G$++,e);return Ke.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};Ke.setProperty=function(e,t,r,i){function s(o,a,c){var l=a.shift();if(l==="__proto__"||l==="prototype")return o;if(a.length>0)o[l]=s(o[l]||{},a,c);else{var u=o[l];if(u&&i)return o;u&&(c=[].concat(u).concat(c)),o[l]=c}return o}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),s(e,t,r)};Object.defineProperty(Ke,"decorateRoot",{get:function(){return Kx.decorated||(Kx.decorated=new(dh()))}})});var Ms=I(Yx=>{"use strict";var Cl=Yx,W$=at(),K$=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function bl(n,e){var t=0,r={};for(e|=0;t<n.length;)r[K$[t+e]]=n[t++];return r}Cl.basic=bl([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Cl.defaults=bl([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",W$.emptyArray,null]);Cl.long=bl([0,0,0,1,1],7);Cl.mapKey=bl([0,0,0,5,5,0,0,0,1,1,0,2],2);Cl.packed=bl([1,5,0,0,0,5,5,0,0,0,1,1,0])});var yi=I((nge,Jx)=>{"use strict";Jx.exports=ct;var Tl=vi();((ct.prototype=Object.create(Tl.prototype)).constructor=ct).className="Field";var Zx=Nn(),eC=Ms(),Ye=at(),Sl,Q$=/^required|optional|repeated$/;ct.fromJSON=function(e,t){var r=new ct(e,t.id,t.type,t.rule,t.extend,t.options,t.comment);return t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r};function ct(n,e,t,r,i,s,o){if(Ye.isObject(r)?(o=i,s=r,r=i=void 0):Ye.isObject(i)&&(o=s,s=i,i=void 0),Tl.call(this,n,s),!Ye.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!Ye.isString(t))throw TypeError("type must be a string");if(r!==void 0&&!Q$.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!Ye.isString(i))throw TypeError("extend must be a string");r==="proto3_optional"&&(r="optional"),this.rule=r&&r!=="optional"?r:void 0,this.type=t,this.id=e,this.extend=i||void 0,this.repeated=r==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=Ye.Long?eC.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=o}Object.defineProperty(ct.prototype,"required",{get:function(){return this._features.field_presence==="LEGACY_REQUIRED"}});Object.defineProperty(ct.prototype,"optional",{get:function(){return!this.required}});Object.defineProperty(ct.prototype,"delimited",{get:function(){return this.resolvedType instanceof Sl&&this._features.message_encoding==="DELIMITED"}});Object.defineProperty(ct.prototype,"packed",{get:function(){return this._features.repeated_field_encoding==="PACKED"}});Object.defineProperty(ct.prototype,"hasPresence",{get:function(){return this.repeated||this.map?!1:this.partOf||this.declaringField||this.extensionField||this._features.field_presence!=="IMPLICIT"}});ct.prototype.setOption=function(e,t,r){return Tl.prototype.setOption.call(this,e,t,r)};ct.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Ye.toObject(["edition",this._editionToJSON(),"rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};ct.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=eC.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof Sl?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof Zx&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof Zx)&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=Ye.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;Ye.base64.test(this.typeDefault)?Ye.base64.decode(this.typeDefault,e=Ye.newBuffer(Ye.base64.length(this.typeDefault)),0):Ye.utf8.write(this.typeDefault,e=Ye.newBuffer(Ye.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=Ye.emptyObject:this.repeated?this.defaultValue=Ye.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof Sl&&(this.parent.ctor.prototype[this.name]=this.defaultValue),Tl.prototype.resolve.call(this)};ct.prototype._inferLegacyProtoFeatures=function(e){if(e!=="proto2"&&e!=="proto3")return{};var t={};if(this.rule==="required"&&(t.field_presence="LEGACY_REQUIRED"),this.parent&&eC.defaults[this.type]===void 0){var r=this.parent.get(this.type.split(".").pop());r&&r instanceof Sl&&r.group&&(t.message_encoding="DELIMITED")}return this.getOption("packed")===!0?t.repeated_field_encoding="PACKED":this.getOption("packed")===!1&&(t.repeated_field_encoding="EXPANDED"),t};ct.prototype._resolveFeatures=function(e){return Tl.prototype._resolveFeatures.call(this,this._edition||e)};ct.d=function(e,t,r,i){return typeof t=="function"?t=Ye.decorateType(t).name:t&&typeof t=="object"&&(t=Ye.decorateEnum(t).name),function(o,a){Ye.decorateType(o.constructor).add(new ct(a,e,t,r,{default:i}))}};ct._configure=function(e){Sl=e}});var Ns=I((rge,tO)=>{"use strict";tO.exports=Jt;var hh=vi();((Jt.prototype=Object.create(hh.prototype)).constructor=Jt).className="OneOf";var Xx=yi(),fh=at();function Jt(n,e,t,r){if(Array.isArray(e)||(t=e,e=void 0),hh.call(this,n,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=r}Jt.fromJSON=function(e,t){return new Jt(e,t.oneof,t.options,t.comment)};Jt.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return fh.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function eO(n){if(n.parent)for(var e=0;e<n.fieldsArray.length;++e)n.fieldsArray[e].parent||n.parent.add(n.fieldsArray[e])}Jt.prototype.add=function(e){if(!(e instanceof Xx))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,eO(this),this};Jt.prototype.remove=function(e){if(!(e instanceof Xx))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};Jt.prototype.onAdd=function(e){hh.prototype.onAdd.call(this,e);for(var t=this,r=0;r<this.oneof.length;++r){var i=e.get(this.oneof[r]);i&&!i.partOf&&(i.partOf=t,t.fieldsArray.push(i))}eO(this)};Jt.prototype.onRemove=function(e){for(var t=0,r;t<this.fieldsArray.length;++t)(r=this.fieldsArray[t]).parent&&r.parent.remove(r);hh.prototype.onRemove.call(this,e)};Object.defineProperty(Jt.prototype,"isProto3Optional",{get:function(){if(this.fieldsArray==null||this.fieldsArray.length!==1)return!1;var n=this.fieldsArray[0];return n.options!=null&&n.options.proto3_optional===!0}});Jt.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(i,s){fh.decorateType(i.constructor).add(new Jt(s,e)),Object.defineProperty(i,s,{get:fh.oneOfGetter(e),set:fh.oneOfSetter(e)})}}});var vi=I((ige,nO)=>{"use strict";nO.exports=mt;mt.className="ReflectionObject";var Y$=Ns(),Dl=at(),ph,Z$={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},J$={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},X$={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function mt(n,e){if(!Dl.isString(n))throw TypeError("name must be a string");if(e&&!Dl.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=n,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(mt.prototype,{root:{get:function(){for(var n=this;n.parent!==null;)n=n.parent;return n}},fullName:{get:function(){for(var n=[this.name],e=this.parent;e;)n.unshift(e.name),e=e.parent;return n.join(".")}}});mt.prototype.toJSON=function(){throw Error()};mt.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof ph&&t._handleAdd(this)};mt.prototype.onRemove=function(e){var t=e.root;t instanceof ph&&t._handleRemove(this),this.parent=null,this.resolved=!1};mt.prototype.resolve=function(){return this.resolved?this:(this.root instanceof ph&&(this.resolved=!0),this)};mt.prototype._resolveFeaturesRecursive=function(e){return this._resolveFeatures(this._edition||e)};mt.prototype._resolveFeatures=function(e){if(!this._featuresResolved){var t={};if(!e)throw new Error("Unknown edition for "+this.fullName);var r=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(e));if(this._edition){if(e==="proto2")t=Object.assign({},J$);else if(e==="proto3")t=Object.assign({},X$);else if(e==="2023")t=Object.assign({},Z$);else throw new Error("Unknown edition: "+e);this._features=Object.assign(t,r||{}),this._featuresResolved=!0;return}if(this.partOf instanceof Y$){var i=Object.assign({},this.partOf._features);this._features=Object.assign(i,r||{})}else if(!this.declaringField)if(this.parent){var s=Object.assign({},this.parent._features);this._features=Object.assign(s,r||{})}else throw new Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}};mt.prototype._inferLegacyProtoFeatures=function(){return{}};mt.prototype.getOption=function(e){if(this.options)return this.options[e]};mt.prototype.setOption=function(e,t,r){return this.options||(this.options={}),/^features\./.test(e)?Dl.setProperty(this.options,e,t,r):(!r||this.options[e]===void 0)&&(this.getOption(e)!==t&&(this.resolved=!1),this.options[e]=t),this};mt.prototype.setParsedOption=function(e,t,r){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(r){var s=i.find(function(c){return Object.prototype.hasOwnProperty.call(c,e)});if(s){var o=s[e];Dl.setProperty(o,r,t)}else s={},s[e]=Dl.setProperty({},r,t),i.push(s)}else{var a={};a[e]=t,i.push(a)}return this};mt.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)this.setOption(r[i],e[r[i]],t);return this};mt.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};mt.prototype._editionToJSON=function(){if(!(!this._edition||this._edition==="proto3"))return this._edition};mt._configure=function(n){ph=n}});var Nn=I((sge,iO)=>{"use strict";iO.exports=Mn;var tC=vi();((Mn.prototype=Object.create(tC.prototype)).constructor=Mn).className="Enum";var rO=sa(),gh=at();function Mn(n,e,t,r,i,s){if(tC.call(this,n,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=i||{},this.valuesOptions=s,this._valuesFeatures={},this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}Mn.prototype._resolveFeatures=function(e){return e=this._edition||e,tC.prototype._resolveFeatures.call(this,e),Object.keys(this.values).forEach(t=>{var r=Object.assign({},this._features);this._valuesFeatures[t]=Object.assign(r,this.valuesOptions&&this.valuesOptions[t]&&this.valuesOptions[t].features)}),this};Mn.fromJSON=function(e,t){var r=new Mn(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r};Mn.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return gh.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};Mn.prototype.add=function(e,t,r,i){if(!gh.isString(e))throw TypeError("name must be a string");if(!gh.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return i&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=i||null),this.comments[e]=r||null,this};Mn.prototype.remove=function(e){if(!gh.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};Mn.prototype.isReservedId=function(e){return rO.isReservedId(this.reserved,e)};Mn.prototype.isReservedName=function(e){return rO.isReservedName(this.reserved,e)}});var K_=I((oge,oO)=>{"use strict";oO.exports=tz;var ez=Nn(),nC=Ms(),rC=at();function sO(n,e,t,r){return e.delimited?n("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,r,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):n("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,r,(e.id<<3|2)>>>0)}function tz(n){for(var e=rC.codegen(["m","w"],n.name+"$encode")("if(!w)")("w=Writer.create()"),t,r,i=n.fieldsArray.slice().sort(rC.compareFieldsById),t=0;t<i.length;++t){var s=i[t].resolve(),o=n._fieldsArray.indexOf(s),a=s.resolvedType instanceof ez?"int32":s.type,c=nC.basic[a];r="m"+rC.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",r,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",r)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|nC.mapKey[s.keyType],s.keyType),c===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,r):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|c,a,r),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",r,r),s.packed&&nC.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",r)("w.%s(%s[i])",a,r)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",r),c===void 0?sO(e,s,o,r+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|c)>>>0,a,r)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",r,s.name),c===void 0?sO(e,s,o,r):e("w.uint32(%i).%s(%s)",(s.id<<3|c)>>>0,a,r))}return e("return w")}});var cO=I((age,aO)=>{"use strict";var me=aO.exports=Cx();me.build="light";function nz(n,e,t){return typeof e=="function"?(t=e,e=new me.Root):e||(e=new me.Root),e.load(n,t)}me.load=nz;function rz(n,e){return e||(e=new me.Root),e.loadSync(n)}me.loadSync=rz;me.encoder=K_();me.decoder=L_();me.verifier=U_();me.converter=H_();me.ReflectionObject=vi();me.Namespace=sa();me.Root=dh();me.Enum=Nn();me.Type=ah();me.Field=yi();me.OneOf=Ns();me.MapField=th();me.Service=rh();me.Method=nh();me.Message=ih();me.wrappers=$_();me.types=Ms();me.util=at();me.ReflectionObject._configure(me.Root);me.Namespace._configure(me.Type,me.Service,me.Enum);me.Root._configure(me.Type);me.Field._configure(me.Type)});var sC=I((cge,dO)=>{"use strict";dO.exports=uO;var iC=/[\s{}=;:[\],'"()<>]/g,iz=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,sz=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,oz=/^ *[*/]+ */,az=/^\s*\*?\/*/,cz=/\n/g,lz=/\s/,uz=/\\(.?)/g,dz={0:"\0",r:"\r",n:`
`,t:"	"};function lO(n){return n.replace(uz,function(e,t){switch(t){case"\\":case"":return t;default:return dz[t]||""}})}uO.unescape=lO;function uO(n,e){n=n.toString();var t=0,r=n.length,i=1,s=0,o={},a=[],c=null;function l(w){return Error("illegal "+w+" (line "+i+")")}function u(){var w=c==="'"?sz:iz;w.lastIndex=t-1;var q=w.exec(n);if(!q)throw l("string");return t=w.lastIndex,T(c),c=null,lO(q[1])}function d(w){return n.charAt(w)}function f(w,q,z){var C={type:n.charAt(w++),lineEmpty:!1,leading:z},y;e?y=2:y=3;var v=w-y,E;do if(--v<0||(E=n.charAt(v))===`
`){C.lineEmpty=!0;break}while(E===" "||E==="	");for(var g=n.substring(w,q).split(cz),S=0;S<g.length;++S)g[S]=g[S].replace(e?az:oz,"").trim();C.text=g.join(`
`).trim(),o[i]=C,s=i}function h(w){var q=_(w),z=n.substring(w,q),C=/^\s*\/\//.test(z);return C}function _(w){for(var q=w;q<r&&d(q)!==`
`;)q++;return q}function b(){if(a.length>0)return a.shift();if(c)return u();var w,q,z,C,y,v=t===0;do{if(t===r)return null;for(w=!1;lz.test(z=d(t));)if(z===`
`&&(v=!0,++i),++t===r)return null;if(d(t)==="/"){if(++t===r)throw l("comment");if(d(t)==="/")if(e){if(C=t,y=!1,h(t-1)){y=!0;do if(t=_(t),t===r||(t++,!v))break;while(h(t))}else t=Math.min(r,_(t)+1);y&&(f(C,t,v),v=!0),i++,w=!0}else{for(y=d(C=t+1)==="/";d(++t)!==`
`;)if(t===r)return null;++t,y&&(f(C,t-1,v),v=!0),++i,w=!0}else if((z=d(t))==="*"){C=t+1,y=e||d(C)==="*";do{if(z===`
`&&++i,++t===r)throw l("comment");q=z,z=d(t)}while(q!=="*"||z!=="/");++t,y&&(f(C,t-2,v),v=!0),w=!0}else return"/"}}while(w);var E=t;iC.lastIndex=0;var g=iC.test(d(E++));if(!g)for(;E<r&&!iC.test(d(E));)++E;var S=n.substring(t,t=E);return(S==='"'||S==="'")&&(c=S),S}function T(w){a.push(w)}function D(){if(!a.length){var w=b();if(w===null)return null;T(w)}return a[0]}function k(w,q){var z=D(),C=z===w;if(C)return b(),!0;if(!q)throw l("token '"+z+"', '"+w+"' expected");return!1}function P(w){var q=null,z;return w===void 0?(z=o[i-1],delete o[i-1],z&&(e||z.type==="*"||z.lineEmpty)&&(q=z.leading?z.text:null)):(s<w&&D(),z=o[w],delete o[w],z&&!z.lineEmpty&&(e||z.type==="/")&&(q=z.leading?null:z.text)),q}return Object.defineProperty({next:b,peek:D,push:T,skip:k,cmnt:P},"line",{get:function(){return i}})}});var yO=I((lge,mO)=>{"use strict";mO.exports=kr;kr.filename=null;kr.defaults={keepCase:!1};var fz=sC(),fO=dh(),hO=ah(),pO=yi(),hz=th(),gO=Ns(),pz=Nn(),gz=rh(),mz=nh(),yz=vi(),vz=Ms(),oC=at(),Ez=/^[1-9][0-9]*$/,_z=/^-?[1-9][0-9]*$/,Cz=/^0[x][0-9a-fA-F]+$/,bz=/^-?0[x][0-9a-fA-F]+$/,Sz=/^0[0-7]+$/,Tz=/^-?0[0-7]+$/,Dz=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,rr=/^[a-zA-Z_][a-zA-Z_0-9]*$/,ir=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function kr(n,e,t){e instanceof fO||(t=e,e=new fO),t||(t=kr.defaults);var r=t.preferTrailingComment||!1,i=fz(n,t.alternateCommentMode||!1),s=i.next,o=i.push,a=i.peek,c=i.skip,l=i.cmnt,u=!0,d,f,h,_="proto2",b=e,T=[],D={},k=t.keepCase?function(N){return N}:oC.camelCase;function P(){T.forEach(N=>{N._edition=_,Object.keys(D).forEach(A=>{N.getOption(A)===void 0&&N.setOption(A,D[A],!0)})})}function w(N,A,R){var B=kr.filename;return R||(kr.filename=null),Error("illegal "+(A||"token")+" '"+N+"' ("+(B?B+", ":"")+"line "+i.line+")")}function q(){var N=[],A;do{if((A=s())!=='"'&&A!=="'")throw w(A);N.push(s()),c(A),A=a()}while(A==='"'||A==="'");return N.join("")}function z(N){var A=s();switch(A){case"'":case'"':return o(A),q();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return y(A,!0)}catch{if(N&&ir.test(A))return A;throw w(A,"value")}}function C(N,A){var R,B;do if(A&&((R=a())==='"'||R==="'")){var L=q();if(N.push(L),_>=2023)throw w(L,"id")}else try{N.push([B=v(s()),c("to",!0)?v(s()):B])}catch(Pe){if(A&&ir.test(R)&&_>=2023)N.push(R);else throw Pe}while(c(",",!0));var re={options:void 0};re.setOption=function(Pe,vt){this.options===void 0&&(this.options={}),this.options[Pe]=vt},O(re,function(vt){if(vt==="option")_e(re,vt),c(";");else throw w(vt)},function(){pr(re)})}function y(N,A){var R=1;switch(N.charAt(0)==="-"&&(R=-1,N=N.substring(1)),N){case"inf":case"INF":case"Inf":return R*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(Ez.test(N))return R*parseInt(N,10);if(Cz.test(N))return R*parseInt(N,16);if(Sz.test(N))return R*parseInt(N,8);if(Dz.test(N))return R*parseFloat(N);throw w(N,"number",A)}function v(N,A){switch(N){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!A&&N.charAt(0)==="-")throw w(N,"id");if(_z.test(N))return parseInt(N,10);if(bz.test(N))return parseInt(N,16);if(Tz.test(N))return parseInt(N,8);throw w(N,"id")}function E(){if(d!==void 0)throw w("package");if(d=s(),!ir.test(d))throw w(d,"name");b=b.define(d),c(";")}function g(){var N=a(),A;switch(N){case"weak":A=h||(h=[]),s();break;case"public":s();default:A=f||(f=[]);break}N=q(),c(";"),A.push(N)}function S(){if(c("="),_=q(),_<2023)throw w(_,"syntax");c(";")}function p(){if(c("="),_=q(),!["2023"].includes(_))throw w(_,"edition");c(";")}function m(N,A){switch(A){case"option":return _e(N,A),c(";"),!0;case"message":return ae(N,A),!0;case"enum":return Nt(N,A),!0;case"service":return bF(N,A),!0;case"extend":return TF(N,A),!0}return!1}function O(N,A,R){var B=i.line;if(N&&(typeof N.comment!="string"&&(N.comment=l()),N.filename=kr.filename),c("{",!0)){for(var L;(L=s())!=="}";)A(L);c(";",!0)}else R&&R(),c(";"),N&&(typeof N.comment!="string"||r)&&(N.comment=l(B)||N.comment)}function ae(N,A){if(!rr.test(A=s()))throw w(A,"type name");var R=new hO(A);O(R,function(L){if(!m(R,L))switch(L){case"map":He(R,L);break;case"required":if(_!=="proto2")throw w(L);case"repeated":oe(R,L);break;case"optional":if(_==="proto3")oe(R,"proto3_optional");else{if(_!=="proto2")throw w(L);oe(R,"optional")}break;case"oneof":yt(R,L);break;case"extensions":C(R.extensions||(R.extensions=[]));break;case"reserved":C(R.reserved||(R.reserved=[]),!0);break;default:if(_==="proto2"||!ir.test(L))throw w(L);o(L),oe(R,"optional");break}}),N.add(R),N===b&&T.push(R)}function oe(N,A,R){var B=s();if(B==="group"){Ne(N,A);return}for(;B.endsWith(".")||a().startsWith(".");)B+=s();if(!ir.test(B))throw w(B,"type");var L=s();if(!rr.test(L))throw w(L,"name");L=k(L),c("=");var re=new pO(L,v(s()),B,A,R);if(O(re,function(xt){if(xt==="option")_e(re,xt),c(";");else throw w(xt)},function(){pr(re)}),A==="proto3_optional"){var Pe=new gO("_"+L);re.setOption("proto3_optional",!0),Pe.add(re),N.add(Pe)}else N.add(re);N===b&&T.push(re)}function Ne(N,A){if(_>=2023)throw w("group");var R=s();if(!rr.test(R))throw w(R,"name");var B=oC.lcFirst(R);R===B&&(R=oC.ucFirst(R)),c("=");var L=v(s()),re=new hO(R);re.group=!0;var Pe=new pO(B,L,R,A);Pe.filename=kr.filename,O(re,function(xt){switch(xt){case"option":_e(re,xt),c(";");break;case"required":case"repeated":oe(re,xt);break;case"optional":_==="proto3"?oe(re,"proto3_optional"):oe(re,"optional");break;case"message":ae(re,xt);break;case"enum":Nt(re,xt);break;case"reserved":C(re.reserved||(re.reserved=[]),!0);break;default:throw w(xt)}}),N.add(re).add(Pe)}function He(N){c("<");var A=s();if(vz.mapKey[A]===void 0)throw w(A,"type");c(",");var R=s();if(!ir.test(R))throw w(R,"type");c(">");var B=s();if(!rr.test(B))throw w(B,"name");c("=");var L=new hz(k(B),v(s()),A,R);O(L,function(Pe){if(Pe==="option")_e(L,Pe),c(";");else throw w(Pe)},function(){pr(L)}),N.add(L)}function yt(N,A){if(!rr.test(A=s()))throw w(A,"name");var R=new gO(k(A));O(R,function(L){L==="option"?(_e(R,L),c(";")):(o(L),oe(R,"optional"))}),N.add(R)}function Nt(N,A){if(!rr.test(A=s()))throw w(A,"name");var R=new pz(A);O(R,function(L){switch(L){case"option":_e(R,L),c(";");break;case"reserved":C(R.reserved||(R.reserved=[]),!0),R.reserved===void 0&&(R.reserved=[]);break;default:nt(R,L)}}),N.add(R),N===b&&T.push(R)}function nt(N,A){if(!rr.test(A))throw w(A,"name");c("=");var R=v(s(),!0),B={options:void 0};B.getOption=function(L){return this.options[L]},B.setOption=function(L,re){yz.prototype.setOption.call(B,L,re)},B.setParsedOption=function(){},O(B,function(re){if(re==="option")_e(B,re),c(";");else throw w(re)},function(){pr(B)}),N.add(A,R,B.comment,B.parsedOptions||B.options)}function _e(N,A){var R,B,L=!0;for(A==="option"&&(A=s());A!=="=";){if(A==="("){var re=s();c(")"),A="("+re+")"}if(L){if(L=!1,A.includes(".")&&!A.includes("(")){var Pe=A.split(".");R=Pe[0]+".",A=Pe[1];continue}R=A}else B=B?B+=A:A;A=s()}var vt=B?R.concat(B):R,xt=Mt(N,vt);B=B&&B[0]==="."?B.slice(1):B,R=R&&R[R.length-1]==="."?R.slice(0,-1):R,Rt(N,R,xt,B)}function Mt(N,A){if(c("{",!0)){for(var R={};!c("}",!0);){if(!rr.test(ht=s()))throw w(ht,"name");if(ht===null)throw w(ht,"end of input");var B,L=ht;if(c(":",!0),a()==="{")B=Mt(N,A+"."+ht);else if(a()==="["){B=[];var re;if(c("[",!0)){do re=z(!0),B.push(re);while(c(",",!0));c("]"),typeof re<"u"&&Ve(N,A+"."+ht,re)}}else B=z(!0),Ve(N,A+"."+ht,B);var Pe=R[L];Pe&&(B=[].concat(Pe).concat(B)),R[L]=B,c(",",!0),c(";",!0)}return R}var vt=z(!0);return Ve(N,A,vt),vt}function Ve(N,A,R){if(b===N&&/^features\./.test(A)){D[A]=R;return}N.setOption&&N.setOption(A,R)}function Rt(N,A,R,B){N.setParsedOption&&N.setParsedOption(A,R,B)}function pr(N){if(c("[",!0)){do _e(N,"option");while(c(",",!0));c("]")}return N}function bF(N,A){if(!rr.test(A=s()))throw w(A,"service name");var R=new gz(A);O(R,function(L){if(!m(R,L))if(L==="rpc")SF(R,L);else throw w(L)}),N.add(R),N===b&&T.push(R)}function SF(N,A){var R=l(),B=A;if(!rr.test(A=s()))throw w(A,"name");var L=A,re,Pe,vt,xt;if(c("("),c("stream",!0)&&(Pe=!0),!ir.test(A=s())||(re=A,c(")"),c("returns"),c("("),c("stream",!0)&&(xt=!0),!ir.test(A=s())))throw w(A);vt=A,c(")");var du=new mz(L,B,re,vt,Pe,xt);du.comment=R,O(du,function(hg){if(hg==="option")_e(du,hg),c(";");else throw w(hg)}),N.add(du)}function TF(N,A){if(!ir.test(A=s()))throw w(A,"reference");var R=A;O(null,function(L){switch(L){case"required":case"repeated":oe(N,L,R);break;case"optional":_==="proto3"?oe(N,"proto3_optional",R):oe(N,"optional",R);break;default:if(_==="proto2"||!ir.test(L))throw w(L);o(L),oe(N,"optional",R);break}})}for(var ht;(ht=s())!==null;)switch(ht){case"package":if(!u)throw w(ht);E();break;case"import":if(!u)throw w(ht);g();break;case"syntax":if(!u)throw w(ht);S();break;case"edition":if(!u)throw w(ht);p();break;case"option":_e(b,ht),c(";",!0);break;default:if(m(b,ht)){u=!1;continue}throw w(ht)}return P(),kr.filename=null,{package:d,imports:f,weakImports:h,root:e}}});var _O=I((uge,EO)=>{"use strict";EO.exports=Rn;var wz=/\/|\./;function Rn(n,e){wz.test(n)||(n="google/protobuf/"+n+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),Rn[n]=e}Rn("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var vO;Rn("duration",{Duration:vO={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});Rn("timestamp",{Timestamp:vO});Rn("empty",{Empty:{fields:{}}});Rn("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});Rn("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});Rn("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});Rn.get=function(e){return Rn[e]||null}});var bO=I((dge,CO)=>{"use strict";var _i=CO.exports=cO();_i.build="full";_i.tokenize=sC();_i.parse=yO();_i.common=_O();_i.Root._configure(_i.Type,_i.parse,_i.common)});var mh=I((fge,SO)=>{"use strict";SO.exports=bO()});var aC=I((hge,Iz)=>{Iz.exports={nested:{google:{nested:{protobuf:{options:{go_package:"google.golang.org/protobuf/types/descriptorpb",java_package:"com.google.protobuf",java_outer_classname:"DescriptorProtos",csharp_namespace:"Google.Protobuf.Reflection",objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{FileDescriptorSet:{edition:"proto2",fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}},extensions:[[536e6,536e6]]},Edition:{edition:"proto2",values:{EDITION_UNKNOWN:0,EDITION_LEGACY:900,EDITION_PROTO2:998,EDITION_PROTO3:999,EDITION_2023:1e3,EDITION_2024:1001,EDITION_1_TEST_ONLY:1,EDITION_2_TEST_ONLY:2,EDITION_99997_TEST_ONLY:99997,EDITION_99998_TEST_ONLY:99998,EDITION_99999_TEST_ONLY:99999,EDITION_MAX:2147483647}},FileDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10},weakDependency:{rule:"repeated",type:"int32",id:11},optionDependency:{rule:"repeated",type:"string",id:15},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12},edition:{type:"Edition",id:14}}},DescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10},visibility:{type:"SymbolVisibility",id:11}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2},options:{type:"ExtensionRangeOptions",id:3}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},ExtensionRangeOptions:{edition:"proto2",fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999},declaration:{rule:"repeated",type:"Declaration",id:2,options:{retention:"RETENTION_SOURCE"}},features:{type:"FeatureSet",id:50},verification:{type:"VerificationState",id:3,options:{default:"UNVERIFIED",retention:"RETENTION_SOURCE"}}},extensions:[[1e3,536870911]],nested:{Declaration:{fields:{number:{type:"int32",id:1},fullName:{type:"string",id:2},type:{type:"string",id:3},reserved:{type:"bool",id:5},repeated:{type:"bool",id:6}},reserved:[[4,4]]},VerificationState:{values:{DECLARATION:0,UNVERIFIED:1}}}},FieldDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8},proto3Optional:{type:"bool",id:17}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REPEATED:3,LABEL_REQUIRED:2}}}},OneofDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3},reservedRange:{rule:"repeated",type:"EnumReservedRange",id:4},reservedName:{rule:"repeated",type:"string",id:5},visibility:{type:"SymbolVisibility",id:6}},nested:{EnumReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},EnumValueDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{edition:"proto2",fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{edition:"proto2",fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31,options:{default:!0}},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},swiftPrefix:{type:"string",id:39},phpClassPrefix:{type:"string",id:40},phpNamespace:{type:"string",id:41},phpMetadataNamespace:{type:"string",id:44},rubyPackage:{type:"string",id:45},features:{type:"FeatureSet",id:50},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[42,42],[38,38],"php_generic_services"],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{edition:"proto2",fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},deprecatedLegacyJsonFieldConflicts:{type:"bool",id:11,options:{deprecated:!0}},features:{type:"FeatureSet",id:12},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4],[5,5],[6,6],[8,8],[9,9]]},FieldOptions:{edition:"proto2",fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},unverifiedLazy:{type:"bool",id:15},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10,options:{deprecated:!0}},debugRedact:{type:"bool",id:16},retention:{type:"OptionRetention",id:17},targets:{rule:"repeated",type:"OptionTargetType",id:19},editionDefaults:{rule:"repeated",type:"EditionDefault",id:20},features:{type:"FeatureSet",id:21},featureSupport:{type:"FeatureSupport",id:22},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4],[18,18]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}},OptionRetention:{values:{RETENTION_UNKNOWN:0,RETENTION_RUNTIME:1,RETENTION_SOURCE:2}},OptionTargetType:{values:{TARGET_TYPE_UNKNOWN:0,TARGET_TYPE_FILE:1,TARGET_TYPE_EXTENSION_RANGE:2,TARGET_TYPE_MESSAGE:3,TARGET_TYPE_FIELD:4,TARGET_TYPE_ONEOF:5,TARGET_TYPE_ENUM:6,TARGET_TYPE_ENUM_ENTRY:7,TARGET_TYPE_SERVICE:8,TARGET_TYPE_METHOD:9}},EditionDefault:{fields:{edition:{type:"Edition",id:3},value:{type:"string",id:2}}},FeatureSupport:{fields:{editionIntroduced:{type:"Edition",id:1},editionDeprecated:{type:"Edition",id:2},deprecationWarning:{type:"string",id:3},editionRemoved:{type:"Edition",id:4}}}}},OneofOptions:{edition:"proto2",fields:{features:{type:"FeatureSet",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{edition:"proto2",fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},deprecatedLegacyJsonFieldConflicts:{type:"bool",id:6,options:{deprecated:!0}},features:{type:"FeatureSet",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[5,5]]},EnumValueOptions:{edition:"proto2",fields:{deprecated:{type:"bool",id:1},features:{type:"FeatureSet",id:2},debugRedact:{type:"bool",id:3},featureSupport:{type:"FieldOptions.FeatureSupport",id:4},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{edition:"proto2",fields:{features:{type:"FeatureSet",id:34},deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{edition:"proto2",fields:{deprecated:{type:"bool",id:33},idempotencyLevel:{type:"IdempotencyLevel",id:34,options:{default:"IDEMPOTENCY_UNKNOWN"}},features:{type:"FeatureSet",id:35},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],nested:{IdempotencyLevel:{values:{IDEMPOTENCY_UNKNOWN:0,NO_SIDE_EFFECTS:1,IDEMPOTENT:2}}}},UninterpretedOption:{edition:"proto2",fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},FeatureSet:{edition:"proto2",fields:{fieldPresence:{type:"FieldPresence",id:1,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_2023","edition_defaults.value":"EXPLICIT"}},enumType:{type:"EnumType",id:2,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"OPEN"}},repeatedFieldEncoding:{type:"RepeatedFieldEncoding",id:3,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"PACKED"}},utf8Validation:{type:"Utf8Validation",id:4,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"VERIFY"}},messageEncoding:{type:"MessageEncoding",id:5,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_LEGACY","edition_defaults.value":"LENGTH_PREFIXED"}},jsonFormat:{type:"JsonFormat",id:6,options:{retention:"RETENTION_RUNTIME",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2023","edition_defaults.edition":"EDITION_PROTO3","edition_defaults.value":"ALLOW"}},enforceNamingStyle:{type:"EnforceNamingStyle",id:7,options:{retention:"RETENTION_SOURCE",targets:"TARGET_TYPE_METHOD","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"STYLE2024"}},defaultSymbolVisibility:{type:"VisibilityFeature.DefaultSymbolVisibility",id:8,options:{retention:"RETENTION_SOURCE",targets:"TARGET_TYPE_FILE","feature_support.edition_introduced":"EDITION_2024","edition_defaults.edition":"EDITION_2024","edition_defaults.value":"EXPORT_TOP_LEVEL"}}},extensions:[[1e3,9994],[9995,9999],[1e4,1e4]],reserved:[[999,999]],nested:{FieldPresence:{values:{FIELD_PRESENCE_UNKNOWN:0,EXPLICIT:1,IMPLICIT:2,LEGACY_REQUIRED:3}},EnumType:{values:{ENUM_TYPE_UNKNOWN:0,OPEN:1,CLOSED:2}},RepeatedFieldEncoding:{values:{REPEATED_FIELD_ENCODING_UNKNOWN:0,PACKED:1,EXPANDED:2}},Utf8Validation:{values:{UTF8_VALIDATION_UNKNOWN:0,VERIFY:2,NONE:3}},MessageEncoding:{values:{MESSAGE_ENCODING_UNKNOWN:0,LENGTH_PREFIXED:1,DELIMITED:2}},JsonFormat:{values:{JSON_FORMAT_UNKNOWN:0,ALLOW:1,LEGACY_BEST_EFFORT:2}},EnforceNamingStyle:{values:{ENFORCE_NAMING_STYLE_UNKNOWN:0,STYLE2024:1,STYLE_LEGACY:2}},VisibilityFeature:{fields:{},reserved:[[1,536870911]],nested:{DefaultSymbolVisibility:{values:{DEFAULT_SYMBOL_VISIBILITY_UNKNOWN:0,EXPORT_ALL:1,EXPORT_TOP_LEVEL:2,LOCAL_ALL:3,STRICT:4}}}}}},FeatureSetDefaults:{edition:"proto2",fields:{defaults:{rule:"repeated",type:"FeatureSetEditionDefault",id:1},minimumEdition:{type:"Edition",id:4},maximumEdition:{type:"Edition",id:5}},nested:{FeatureSetEditionDefault:{fields:{edition:{type:"Edition",id:3},overridableFeatures:{type:"FeatureSet",id:4},fixedFeatures:{type:"FeatureSet",id:5}},reserved:[[1,1],[2,2],"features"]}}},SourceCodeInfo:{edition:"proto2",fields:{location:{rule:"repeated",type:"Location",id:1}},extensions:[[536e6,536e6]],nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1,options:{packed:!0}},span:{rule:"repeated",type:"int32",id:2,options:{packed:!0}},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{edition:"proto2",fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1,options:{packed:!0}},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4},semantic:{type:"Semantic",id:5}},nested:{Semantic:{values:{NONE:0,SET:1,ALIAS:2}}}}}},SymbolVisibility:{edition:"proto2",values:{VISIBILITY_UNSET:0,VISIBILITY_LOCAL:1,VISIBILITY_EXPORT:2}}}}}}}}});var MO=I((ie,NO)=>{"use strict";var Xt=mh();NO.exports=ie=Xt.descriptor=Xt.Root.fromJSON(aC()).lookup(".google.protobuf");var TO=Xt.Namespace,wl=Xt.Root,Pr=Xt.Enum,sr=Xt.Type,Ci=Xt.Field,Az=Xt.MapField,yh=Xt.OneOf,Il=Xt.Service,vh=Xt.Method;wl.fromDescriptor=function(e){typeof e.length=="number"&&(e=ie.FileDescriptorSet.decode(e));var t=new wl;if(e.file)for(var r,i,s=0,o;s<e.file.length;++s){i=t,(r=e.file[s]).package&&r.package.length&&(i=t.define(r.package));var a=Bz(r);if(r.name&&r.name.length&&t.files.push(i.filename=r.name),r.messageType)for(o=0;o<r.messageType.length;++o)i.add(sr.fromDescriptor(r.messageType[o],a));if(r.enumType)for(o=0;o<r.enumType.length;++o)i.add(Pr.fromDescriptor(r.enumType[o],a));if(r.extension)for(o=0;o<r.extension.length;++o)i.add(Ci.fromDescriptor(r.extension[o],a));if(r.service)for(o=0;o<r.service.length;++o)i.add(Il.fromDescriptor(r.service[o],a));var c=aa(r.options,ie.FileOptions);if(c){var l=Object.keys(c);for(o=0;o<l.length;++o)i.setOption(l[o],c[l[o]])}}return t.resolveAll()};wl.prototype.toDescriptor=function(e){var t=ie.FileDescriptorSet.create();return DO(this,t.file,e),t};function DO(n,e,t){var r=ie.FileDescriptorProto.create({name:n.filename||(n.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});Vz(t,r),n instanceof wl||(r.package=n.fullName.substring(1));for(var i=0,s;i<n.nestedArray.length;++i)(s=n._nestedArray[i])instanceof sr?r.messageType.push(s.toDescriptor(t)):s instanceof Pr?r.enumType.push(s.toDescriptor()):s instanceof Ci?r.extension.push(s.toDescriptor(t)):s instanceof Il?r.service.push(s.toDescriptor()):s instanceof TO&&DO(s,e,t);r.options=ca(n.options,ie.FileOptions),r.messageType.length+r.enumType.length+r.extension.length+r.service.length&&e.push(r)}var Nz=0;sr.fromDescriptor=function(e,t,r){typeof e.length=="number"&&(e=ie.DescriptorProto.decode(e));var i=new sr(e.name.length?e.name:"Type"+Nz++,aa(e.options,ie.MessageOptions)),s;if(r||(i._edition=t),e.oneofDecl)for(s=0;s<e.oneofDecl.length;++s)i.add(yh.fromDescriptor(e.oneofDecl[s]));if(e.field)for(s=0;s<e.field.length;++s){var o=Ci.fromDescriptor(e.field[s],t,!0);i.add(o),e.field[s].hasOwnProperty("oneofIndex")&&i.oneofsArray[e.field[s].oneofIndex].add(o)}if(e.extension)for(s=0;s<e.extension.length;++s)i.add(Ci.fromDescriptor(e.extension[s],t,!0));if(e.nestedType)for(s=0;s<e.nestedType.length;++s)i.add(sr.fromDescriptor(e.nestedType[s],t,!0)),e.nestedType[s].options&&e.nestedType[s].options.mapEntry&&i.setOption("map_entry",!0);if(e.enumType)for(s=0;s<e.enumType.length;++s)i.add(Pr.fromDescriptor(e.enumType[s],t,!0));if(e.extensionRange&&e.extensionRange.length)for(i.extensions=[],s=0;s<e.extensionRange.length;++s)i.extensions.push([e.extensionRange[s].start,e.extensionRange[s].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(i.reserved=[],e.reservedRange)for(s=0;s<e.reservedRange.length;++s)i.reserved.push([e.reservedRange[s].start,e.reservedRange[s].end]);if(e.reservedName)for(s=0;s<e.reservedName.length;++s)i.reserved.push(e.reservedName[s])}return i};sr.prototype.toDescriptor=function(e){var t=ie.DescriptorProto.create({name:this.name}),r;for(r=0;r<this.fieldsArray.length;++r){var i;if(t.field.push(i=this._fieldsArray[r].toDescriptor(e)),this._fieldsArray[r]instanceof Az){var s=cC(this._fieldsArray[r].keyType,this._fieldsArray[r].resolvedKeyType,!1),o=cC(this._fieldsArray[r].type,this._fieldsArray[r].resolvedType,!1),a=o===11||o===14?this._fieldsArray[r].resolvedType&&AO(this.parent,this._fieldsArray[r].resolvedType)||this._fieldsArray[r].type:void 0;t.nestedType.push(ie.DescriptorProto.create({name:i.typeName,field:[ie.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),ie.FieldDescriptorProto.create({name:"value",number:2,label:1,type:o,typeName:a})],options:ie.MessageOptions.create({mapEntry:!0})}))}}for(r=0;r<this.oneofsArray.length;++r)t.oneofDecl.push(this._oneofsArray[r].toDescriptor());for(r=0;r<this.nestedArray.length;++r)this._nestedArray[r]instanceof Ci?t.field.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof sr?t.nestedType.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof Pr&&t.enumType.push(this._nestedArray[r].toDescriptor());if(this.extensions)for(r=0;r<this.extensions.length;++r)t.extensionRange.push(ie.DescriptorProto.ExtensionRange.create({start:this.extensions[r][0],end:this.extensions[r][1]}));if(this.reserved)for(r=0;r<this.reserved.length;++r)typeof this.reserved[r]=="string"?t.reservedName.push(this.reserved[r]):t.reservedRange.push(ie.DescriptorProto.ReservedRange.create({start:this.reserved[r][0],end:this.reserved[r][1]}));return t.options=ca(this.options,ie.MessageOptions),t};var Mz=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;Ci.fromDescriptor=function(e,t,r){if(typeof e.length=="number"&&(e=ie.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var i;e.typeName&&e.typeName.length?i=e.typeName:i=Pz(e.type);var s;switch(e.label){case 1:s=void 0;break;case 2:s="required";break;case 3:s="repeated";break;default:throw Error("illegal label: "+e.label)}var o=e.extendee;e.extendee!==void 0&&(o=o.length?o:void 0);var a=new Ci(e.name.length?e.name:"field"+e.number,e.number,i,s,o);if(r||(a._edition=t),a.options=aa(e.options,ie.FieldOptions),e.proto3_optional&&(a.options.proto3_optional=!0),e.defaultValue&&e.defaultValue.length){var c=e.defaultValue;switch(c){case"true":case"TRUE":c=!0;break;case"false":case"FALSE":c=!1;break;default:var l=Mz.exec(c);l&&(c=parseInt(c));break}a.setOption("default",c)}return Fz(e.type)&&(t==="proto3"?e.options&&!e.options.packed&&a.setOption("packed",!1):(!t||t==="proto2")&&e.options&&e.options.packed&&a.setOption("packed",!0)),a};Ci.prototype.toDescriptor=function(e){var t=ie.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)t.type=11,t.typeName=Xt.util.ucFirst(this.name),t.label=3;else{switch(t.type=cC(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:t.typeName=this.resolvedType?AO(this.parent,this.resolvedType):this.type;break}this.rule==="repeated"?t.label=3:this.required&&e==="proto2"?t.label=2:t.label=1}if(t.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(t.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(t.options=ca(this.options,ie.FieldOptions),this.options.default!=null&&(t.defaultValue=String(this.options.default)),this.options.proto3_optional&&(t.proto3_optional=!0)),e==="proto3"?this.packed||((t.options||(t.options=ie.FieldOptions.create())).packed=!1):(!e||e==="proto2")&&this.packed&&((t.options||(t.options=ie.FieldOptions.create())).packed=!0),t};var Rz=0;Pr.fromDescriptor=function(e,t,r){typeof e.length=="number"&&(e=ie.EnumDescriptorProto.decode(e));var i={};if(e.value)for(var s=0;s<e.value.length;++s){var o=e.value[s].name,a=e.value[s].number||0;i[o&&o.length?o:"NAME"+a]=a}var c=new Pr(e.name&&e.name.length?e.name:"Enum"+Rz++,i,aa(e.options,ie.EnumOptions));return r||(c._edition=t),c};Pr.prototype.toDescriptor=function(){for(var e=[],t=0,r=Object.keys(this.values);t<r.length;++t)e.push(ie.EnumValueDescriptorProto.create({name:r[t],number:this.values[r[t]]}));return ie.EnumDescriptorProto.create({name:this.name,value:e,options:ca(this.options,ie.EnumOptions)})};var xz=0;yh.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ie.OneofDescriptorProto.decode(e)),new yh(e.name&&e.name.length?e.name:"oneof"+xz++)};yh.prototype.toDescriptor=function(){return ie.OneofDescriptorProto.create({name:this.name})};var Oz=0;Il.fromDescriptor=function(e,t,r){typeof e.length=="number"&&(e=ie.ServiceDescriptorProto.decode(e));var i=new Il(e.name&&e.name.length?e.name:"Service"+Oz++,aa(e.options,ie.ServiceOptions));if(r||(i._edition=t),e.method)for(var s=0;s<e.method.length;++s)i.add(vh.fromDescriptor(e.method[s]));return i};Il.prototype.toDescriptor=function(){for(var e=[],t=0;t<this.methodsArray.length;++t)e.push(this._methodsArray[t].toDescriptor());return ie.ServiceDescriptorProto.create({name:this.name,method:e,options:ca(this.options,ie.ServiceOptions)})};var kz=0;vh.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ie.MethodDescriptorProto.decode(e)),new vh(e.name&&e.name.length?e.name:"Method"+kz++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,aa(e.options,ie.MethodOptions))};vh.prototype.toDescriptor=function(){return ie.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:ca(this.options,ie.MethodOptions)})};function Pz(n){switch(n){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+n)}function Fz(n){switch(n){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function cC(n,e,t){switch(n){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof Pr)return 14;if(e instanceof sr)return t?10:11;throw Error("illegal type: "+n)}function wO(n,e){for(var t={},r=0,i,s;r<e.fieldsArray.length;++r)if((s=(i=e._fieldsArray[r]).name)!=="uninterpretedOption"&&Object.prototype.hasOwnProperty.call(n,s)){var o=Lz(s);i.resolvedType instanceof sr?t[o]=wO(n[s],i.resolvedType):i.resolvedType instanceof Pr?t[o]=i.resolvedType.valuesById[n[s]]:t[o]=n[s]}return t}function aa(n,e){if(n)return wO(e.toObject(n),e)}function IO(n,e){for(var t={},r=Object.keys(n),i=0;i<r.length;++i){var s=r[i],o=Xt.util.camelCase(s);if(Object.prototype.hasOwnProperty.call(e.fields,o)){var a=e.fields[o];a.resolvedType instanceof sr?t[o]=IO(n[s],a.resolvedType):t[o]=n[s],a.repeated&&!Array.isArray(t[o])&&(t[o]=[t[o]])}}return t}function ca(n,e){if(n)return e.fromObject(IO(n,e))}function AO(n,e){var t=n.fullName.split("."),r=e.fullName.split("."),i=0,s=0,o=r.length-1;if(!(n instanceof wl)&&e instanceof TO)for(;i<t.length&&s<o&&t[i]===r[s];){var a=e.lookup(t[i++],!0);if(a!==null&&a!==e)break;++s}else for(;i<t.length&&s<o&&t[i]===r[s];++i,++s);return r.slice(s).join(".")}function Lz(n){return n.substring(0,1)+n.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}function Bz(n){if(n.syntax==="editions")switch(n.edition){case ie.Edition.EDITION_2023:return"2023";default:throw new Error("Unsupported edition "+n.edition)}return n.syntax==="proto3"?"proto3":"proto2"}function Vz(n,e){if(n)if(n==="proto2"||n==="proto3")e.syntax=n;else switch(e.syntax="editions",n){case"2023":e.edition=ie.Edition.EDITION_2023;break;default:throw new Error("Unsupported edition "+n)}}});var RO=I((pge,Uz)=>{Uz.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var xO=I((gge,jz)=>{jz.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var OO=I((mge,qz)=>{qz.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var LO=I(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.addCommonProtos=bi.loadProtosWithOptionsSync=bi.loadProtosWithOptions=void 0;var kO=De("fs"),PO=De("path"),la=mh();function FO(n,e){let t=n.resolvePath;n.resolvePath=(r,i)=>{if(PO.isAbsolute(i))return i;for(let s of e){let o=PO.join(s,i);try{return kO.accessSync(o,kO.constants.R_OK),o}catch{continue}}return process.emitWarning(`${i} not found in any of the include paths ${e}`),t(r,i)}}async function Hz(n,e){let t=new la.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));FO(t,e.includeDirs)}let r=await t.load(n,e);return r.resolveAll(),r}bi.loadProtosWithOptions=Hz;function $z(n,e){let t=new la.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");FO(t,e.includeDirs)}let r=t.loadSync(n,e);return r.resolveAll(),r}bi.loadProtosWithOptionsSync=$z;function zz(){let n=RO(),e=aC(),t=xO(),r=OO();la.common("api",n.nested.google.nested.protobuf.nested),la.common("descriptor",e.nested.google.nested.protobuf.nested),la.common("source_context",t.nested.google.nested.protobuf.nested),la.common("type",r.nested.google.nested.protobuf.nested)}bi.addCommonProtos=zz});var BO=I((Al,lC)=>{"use strict";(function(n,e){function t(r){return r.default||r}typeof define=="function"&&define.amd?define([],function(){var r={};return e(r),t(r)}):typeof Al=="object"?(e(Al),typeof lC=="object"&&(lC.exports=t(Al))):(function(){var r={};e(r),n.Long=t(r)})()})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Al,function(n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(p,m,O){this.low=p|0,this.high=m|0,this.unsigned=!!O}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function r(p){return(p&&p.__isLong__)===!0}function i(p){var m=Math.clz32(p&-p);return p?31-m:m}t.isLong=r;var s={},o={};function a(p,m){var O,ae,oe;return m?(p>>>=0,(oe=0<=p&&p<256)&&(ae=o[p],ae)?ae:(O=l(p,0,!0),oe&&(o[p]=O),O)):(p|=0,(oe=-128<=p&&p<128)&&(ae=s[p],ae)?ae:(O=l(p,p<0?-1:0,!1),oe&&(s[p]=O),O))}t.fromInt=a;function c(p,m){if(isNaN(p))return m?w:P;if(m){if(p<0)return w;if(p>=T)return v}else{if(p<=-D)return E;if(p+1>=D)return y}return p<0?c(-p,m).neg():l(p%b|0,p/b|0,m)}t.fromNumber=c;function l(p,m,O){return new t(p,m,O)}t.fromBits=l;var u=Math.pow;function d(p,m,O){if(p.length===0)throw Error("empty string");if(typeof m=="number"?(O=m,m=!1):m=!!m,p==="NaN"||p==="Infinity"||p==="+Infinity"||p==="-Infinity")return m?w:P;if(O=O||10,O<2||36<O)throw RangeError("radix");var ae;if((ae=p.indexOf("-"))>0)throw Error("interior hyphen");if(ae===0)return d(p.substring(1),m,O).neg();for(var oe=c(u(O,8)),Ne=P,He=0;He<p.length;He+=8){var yt=Math.min(8,p.length-He),Nt=parseInt(p.substring(He,He+yt),O);if(yt<8){var nt=c(u(O,yt));Ne=Ne.mul(nt).add(c(Nt))}else Ne=Ne.mul(oe),Ne=Ne.add(c(Nt))}return Ne.unsigned=m,Ne}t.fromString=d;function f(p,m){return typeof p=="number"?c(p,m):typeof p=="string"?d(p,m):l(p.low,p.high,typeof m=="boolean"?m:p.unsigned)}t.fromValue=f;var h=65536,_=1<<24,b=h*h,T=b*b,D=T/2,k=a(_),P=a(0);t.ZERO=P;var w=a(0,!0);t.UZERO=w;var q=a(1);t.ONE=q;var z=a(1,!0);t.UONE=z;var C=a(-1);t.NEG_ONE=C;var y=l(-1,2147483647,!1);t.MAX_VALUE=y;var v=l(-1,-1,!0);t.MAX_UNSIGNED_VALUE=v;var E=l(0,-2147483648,!1);t.MIN_VALUE=E;var g=t.prototype;g.toInt=function(){return this.unsigned?this.low>>>0:this.low},g.toNumber=function(){return this.unsigned?(this.high>>>0)*b+(this.low>>>0):this.high*b+(this.low>>>0)},g.toString=function(m){if(m=m||10,m<2||36<m)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(E)){var O=c(m),ae=this.div(O),oe=ae.mul(O).sub(this);return ae.toString(m)+oe.toInt().toString(m)}else return"-"+this.neg().toString(m);for(var Ne=c(u(m,6),this.unsigned),He=this,yt="";;){var Nt=He.div(Ne),nt=He.sub(Nt.mul(Ne)).toInt()>>>0,_e=nt.toString(m);if(He=Nt,He.isZero())return _e+yt;for(;_e.length<6;)_e="0"+_e;yt=""+_e+yt}},g.getHighBits=function(){return this.high},g.getHighBitsUnsigned=function(){return this.high>>>0},g.getLowBits=function(){return this.low},g.getLowBitsUnsigned=function(){return this.low>>>0},g.getNumBitsAbs=function(){if(this.isNegative())return this.eq(E)?64:this.neg().getNumBitsAbs();for(var m=this.high!=0?this.high:this.low,O=31;O>0&&(m&1<<O)==0;O--);return this.high!=0?O+33:O+1},g.isSafeInteger=function(){var m=this.high>>21;return m?this.unsigned?!1:m===-1&&!(this.low===0&&this.high===-2097152):!0},g.isZero=function(){return this.high===0&&this.low===0},g.eqz=g.isZero,g.isNegative=function(){return!this.unsigned&&this.high<0},g.isPositive=function(){return this.unsigned||this.high>=0},g.isOdd=function(){return(this.low&1)===1},g.isEven=function(){return(this.low&1)===0},g.equals=function(m){return r(m)||(m=f(m)),this.unsigned!==m.unsigned&&this.high>>>31===1&&m.high>>>31===1?!1:this.high===m.high&&this.low===m.low},g.eq=g.equals,g.notEquals=function(m){return!this.eq(m)},g.neq=g.notEquals,g.ne=g.notEquals,g.lessThan=function(m){return this.comp(m)<0},g.lt=g.lessThan,g.lessThanOrEqual=function(m){return this.comp(m)<=0},g.lte=g.lessThanOrEqual,g.le=g.lessThanOrEqual,g.greaterThan=function(m){return this.comp(m)>0},g.gt=g.greaterThan,g.greaterThanOrEqual=function(m){return this.comp(m)>=0},g.gte=g.greaterThanOrEqual,g.ge=g.greaterThanOrEqual,g.compare=function(m){if(r(m)||(m=f(m)),this.eq(m))return 0;var O=this.isNegative(),ae=m.isNegative();return O&&!ae?-1:!O&&ae?1:this.unsigned?m.high>>>0>this.high>>>0||m.high===this.high&&m.low>>>0>this.low>>>0?-1:1:this.sub(m).isNegative()?-1:1},g.comp=g.compare,g.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(q)},g.neg=g.negate,g.add=function(m){r(m)||(m=f(m));var O=this.high>>>16,ae=this.high&65535,oe=this.low>>>16,Ne=this.low&65535,He=m.high>>>16,yt=m.high&65535,Nt=m.low>>>16,nt=m.low&65535,_e=0,Mt=0,Ve=0,Rt=0;return Rt+=Ne+nt,Ve+=Rt>>>16,Rt&=65535,Ve+=oe+Nt,Mt+=Ve>>>16,Ve&=65535,Mt+=ae+yt,_e+=Mt>>>16,Mt&=65535,_e+=O+He,_e&=65535,l(Ve<<16|Rt,_e<<16|Mt,this.unsigned)},g.subtract=function(m){return r(m)||(m=f(m)),this.add(m.neg())},g.sub=g.subtract,g.multiply=function(m){if(this.isZero())return this;if(r(m)||(m=f(m)),e){var O=e.mul(this.low,this.high,m.low,m.high);return l(O,e.get_high(),this.unsigned)}if(m.isZero())return this.unsigned?w:P;if(this.eq(E))return m.isOdd()?E:P;if(m.eq(E))return this.isOdd()?E:P;if(this.isNegative())return m.isNegative()?this.neg().mul(m.neg()):this.neg().mul(m).neg();if(m.isNegative())return this.mul(m.neg()).neg();if(this.lt(k)&&m.lt(k))return c(this.toNumber()*m.toNumber(),this.unsigned);var ae=this.high>>>16,oe=this.high&65535,Ne=this.low>>>16,He=this.low&65535,yt=m.high>>>16,Nt=m.high&65535,nt=m.low>>>16,_e=m.low&65535,Mt=0,Ve=0,Rt=0,pr=0;return pr+=He*_e,Rt+=pr>>>16,pr&=65535,Rt+=Ne*_e,Ve+=Rt>>>16,Rt&=65535,Rt+=He*nt,Ve+=Rt>>>16,Rt&=65535,Ve+=oe*_e,Mt+=Ve>>>16,Ve&=65535,Ve+=Ne*nt,Mt+=Ve>>>16,Ve&=65535,Ve+=He*Nt,Mt+=Ve>>>16,Ve&=65535,Mt+=ae*_e+oe*nt+Ne*Nt+He*yt,Mt&=65535,l(Rt<<16|pr,Mt<<16|Ve,this.unsigned)},g.mul=g.multiply,g.divide=function(m){if(r(m)||(m=f(m)),m.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&m.low===-1&&m.high===-1)return this;var O=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,m.low,m.high);return l(O,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?w:P;var ae,oe,Ne;if(this.unsigned){if(m.unsigned||(m=m.toUnsigned()),m.gt(this))return w;if(m.gt(this.shru(1)))return z;Ne=w}else{if(this.eq(E)){if(m.eq(q)||m.eq(C))return E;if(m.eq(E))return q;var He=this.shr(1);return ae=He.div(m).shl(1),ae.eq(P)?m.isNegative()?q:C:(oe=this.sub(m.mul(ae)),Ne=ae.add(oe.div(m)),Ne)}else if(m.eq(E))return this.unsigned?w:P;if(this.isNegative())return m.isNegative()?this.neg().div(m.neg()):this.neg().div(m).neg();if(m.isNegative())return this.div(m.neg()).neg();Ne=P}for(oe=this;oe.gte(m);){ae=Math.max(1,Math.floor(oe.toNumber()/m.toNumber()));for(var yt=Math.ceil(Math.log(ae)/Math.LN2),Nt=yt<=48?1:u(2,yt-48),nt=c(ae),_e=nt.mul(m);_e.isNegative()||_e.gt(oe);)ae-=Nt,nt=c(ae,this.unsigned),_e=nt.mul(m);nt.isZero()&&(nt=q),Ne=Ne.add(nt),oe=oe.sub(_e)}return Ne},g.div=g.divide,g.modulo=function(m){if(r(m)||(m=f(m)),e){var O=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,m.low,m.high);return l(O,e.get_high(),this.unsigned)}return this.sub(this.div(m).mul(m))},g.mod=g.modulo,g.rem=g.modulo,g.not=function(){return l(~this.low,~this.high,this.unsigned)},g.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},g.clz=g.countLeadingZeros,g.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},g.ctz=g.countTrailingZeros,g.and=function(m){return r(m)||(m=f(m)),l(this.low&m.low,this.high&m.high,this.unsigned)},g.or=function(m){return r(m)||(m=f(m)),l(this.low|m.low,this.high|m.high,this.unsigned)},g.xor=function(m){return r(m)||(m=f(m)),l(this.low^m.low,this.high^m.high,this.unsigned)},g.shiftLeft=function(m){return r(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?l(this.low<<m,this.high<<m|this.low>>>32-m,this.unsigned):l(0,this.low<<m-32,this.unsigned)},g.shl=g.shiftLeft,g.shiftRight=function(m){return r(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?l(this.low>>>m|this.high<<32-m,this.high>>m,this.unsigned):l(this.high>>m-32,this.high>=0?0:-1,this.unsigned)},g.shr=g.shiftRight,g.shiftRightUnsigned=function(m){return r(m)&&(m=m.toInt()),(m&=63)===0?this:m<32?l(this.low>>>m|this.high<<32-m,this.high>>>m,this.unsigned):m===32?l(this.high,0,this.unsigned):l(this.high>>>m-32,0,this.unsigned)},g.shru=g.shiftRightUnsigned,g.shr_u=g.shiftRightUnsigned,g.rotateLeft=function(m){var O;return r(m)&&(m=m.toInt()),(m&=63)===0?this:m===32?l(this.high,this.low,this.unsigned):m<32?(O=32-m,l(this.low<<m|this.high>>>O,this.high<<m|this.low>>>O,this.unsigned)):(m-=32,O=32-m,l(this.high<<m|this.low>>>O,this.low<<m|this.high>>>O,this.unsigned))},g.rotl=g.rotateLeft,g.rotateRight=function(m){var O;return r(m)&&(m=m.toInt()),(m&=63)===0?this:m===32?l(this.high,this.low,this.unsigned):m<32?(O=32-m,l(this.high<<O|this.low>>>m,this.low<<O|this.high>>>m,this.unsigned)):(m-=32,O=32-m,l(this.low<<O|this.high>>>m,this.high<<O|this.low>>>m,this.unsigned))},g.rotr=g.rotateRight,g.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},g.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},g.toBytes=function(m){return m?this.toBytesLE():this.toBytesBE()},g.toBytesLE=function(){var m=this.high,O=this.low;return[O&255,O>>>8&255,O>>>16&255,O>>>24,m&255,m>>>8&255,m>>>16&255,m>>>24]},g.toBytesBE=function(){var m=this.high,O=this.low;return[m>>>24,m>>>16&255,m>>>8&255,m&255,O>>>24,O>>>16&255,O>>>8&255,O&255]},t.fromBytes=function(m,O,ae){return ae?t.fromBytesLE(m,O):t.fromBytesBE(m,O)},t.fromBytesLE=function(m,O){return new t(m[0]|m[1]<<8|m[2]<<16|m[3]<<24,m[4]|m[5]<<8|m[6]<<16|m[7]<<24,O)},t.fromBytesBE=function(m,O){return new t(m[4]<<24|m[5]<<16|m[6]<<8|m[7],m[0]<<24|m[1]<<16|m[2]<<8|m[3],O)},typeof BigInt=="function"&&(t.fromBigInt=function(m,O){var ae=Number(BigInt.asIntN(32,m)),oe=Number(BigInt.asIntN(32,m>>BigInt(32)));return l(ae,oe,O)},t.fromValue=function(m,O){return typeof m=="bigint"?t.fromBigInt(m,O):f(m,O)},g.toBigInt=function(){var m=BigInt(this.low>>>0),O=BigInt(this.unsigned?this.high>>>0:this.high);return O<<BigInt(32)|m});var S=n.default=t})});var hC=I(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.loadFileDescriptorSetFromObject=et.loadFileDescriptorSetFromBuffer=et.fromJSON=et.loadSync=et.load=et.IdempotencyLevel=et.isAnyExtension=et.Long=void 0;var Gz=MR(),or=mh(),dC=MO(),fC=LO(),Wz=BO();et.Long=Wz;function Kz(n){return"@type"in n&&typeof n["@type"]=="string"}et.isAnyExtension=Kz;var jO;(function(n){n.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",n.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",n.IDEMPOTENT="IDEMPOTENT"})(jO=et.IdempotencyLevel||(et.IdempotencyLevel={}));var qO={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function Qz(n,e){return n===""?e:n+"."+e}function Yz(n){return n instanceof or.Service||n instanceof or.Type||n instanceof or.Enum}function Zz(n){return n instanceof or.Namespace||n instanceof or.Root}function HO(n,e){let t=Qz(e,n.name);return Yz(n)?[[t,n]]:Zz(n)&&typeof n.nested<"u"?Object.keys(n.nested).map(r=>HO(n.nested[r],t)).reduce((r,i)=>r.concat(i),[]):[]}function VO(n,e){return function(r){return n.toObject(n.decode(r),e)}}function UO(n){return function(t){if(Array.isArray(t))throw new Error(`Failed to serialize message: expected object with ${n.name} structure, got array instead`);let r=n.fromObject(t);return n.encode(r).finish()}}function Jz(n){return(n||[]).reduce((e,t)=>{for(let[r,i]of Object.entries(t))switch(r){case"uninterpreted_option":e.uninterpreted_option.push(t.uninterpreted_option);break;default:e[r]=i}return e},{deprecated:!1,idempotency_level:jO.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function Xz(n,e,t,r){let i=n.resolvedRequestType,s=n.resolvedResponseType;return{path:"/"+e+"/"+n.name,requestStream:!!n.requestStream,responseStream:!!n.responseStream,requestSerialize:UO(i),requestDeserialize:VO(i,t),responseSerialize:UO(s),responseDeserialize:VO(s,t),originalName:Gz(n.name),requestType:uC(i,r),responseType:uC(s,r),options:Jz(n.parsedOptions)}}function eG(n,e,t,r){let i={};for(let s of n.methodsArray)i[s.name]=Xz(s,e,t,r);return i}function uC(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:t.$type.toObject(t,qO),fileDescriptorProtos:e}}function tG(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:t.$type.toObject(t,qO),fileDescriptorProtos:e}}function nG(n,e,t,r){if(n instanceof or.Service)return eG(n,e,t,r);if(n instanceof or.Type)return uC(n,r);if(n instanceof or.Enum)return tG(n,r);throw new Error("Type mismatch in reflection object handling")}function Eh(n,e){let t={};n.resolveAll();let i=n.toDescriptor("proto3").file.map(s=>Buffer.from(dC.FileDescriptorProto.encode(s).finish()));for(let[s,o]of HO(n,""))t[s]=nG(o,s,e,i);return t}function $O(n,e){e=e||{};let t=or.Root.fromDescriptor(n);return t.resolveAll(),Eh(t,e)}function rG(n,e){return(0,fC.loadProtosWithOptions)(n,e).then(t=>Eh(t,e))}et.load=rG;function iG(n,e){let t=(0,fC.loadProtosWithOptionsSync)(n,e);return Eh(t,e)}et.loadSync=iG;function sG(n,e){e=e||{};let t=or.Root.fromJSON(n);return t.resolveAll(),Eh(t,e)}et.fromJSON=sG;function oG(n,e){let t=dC.FileDescriptorSet.decode(n);return $O(t,e)}et.loadFileDescriptorSetFromBuffer=oG;function aG(n,e){let t=dC.FileDescriptorSet.fromObject(n);return $O(t,e)}et.loadFileDescriptorSetFromObject=aG;(0,fC.addCommonProtos)()});var xs=I(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.setup=Fe.getChannelzServiceDefinition=Fe.getChannelzHandlers=Fe.unregisterChannelzRef=Fe.registerChannelzSocket=Fe.registerChannelzServer=Fe.registerChannelzSubchannel=Fe.registerChannelzChannel=Fe.ChannelzCallTracker=Fe.ChannelzChildrenTracker=Fe.ChannelzTrace=void 0;var zO=De("net"),Nl=dn(),Rl=be(),cG=Zn(),lG=Uf(),uG=l_();function pC(n){return{channel_id:n.id,name:n.name}}function vC(n){return{subchannel_id:n.id,name:n.name}}function dG(n){return{server_id:n.id}}function Ch(n){return{socket_id:n.id,name:n.name}}var GO=32,gC=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,r){let i=new Date;this.events.push({description:t,severity:e,timestamp:i,childChannel:r?.kind==="channel"?r:void 0,childSubchannel:r?.kind==="subchannel"?r:void 0}),this.events.length>=GO*2&&(this.events=this.events.slice(GO)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:Fr(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:Fr(e.timestamp),channel_ref:e.childChannel?pC(e.childChannel):null,subchannel_ref:e.childSubchannel?vC(e.childSubchannel):null}))}}};Fe.ChannelzTrace=gC;var mC=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,r,i;switch(e.kind){case"channel":{let s=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(r=this.subchannelChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(i=this.socketChildren.get(e.id))!==null&&i!==void 0?i:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t));break}}}getChildLists(){let e=[];for(let{ref:i}of this.channelChildren.values())e.push(i);let t=[];for(let{ref:i}of this.subchannelChildren.values())t.push(i);let r=[];for(let{ref:i}of this.socketChildren.values())r.push(i);return{channels:e,subchannels:t,sockets:r}}};Fe.ChannelzChildrenTracker=mC;var yC=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};Fe.ChannelzCallTracker=yC;var fG=1;function bh(){return fG++}var Ml=[],EC=[],Si=[],_C=[];function hG(n,e,t){let r=bh(),i={id:r,name:n,kind:"channel"};return t&&(Ml[r]={ref:i,getInfo:e}),i}Fe.registerChannelzChannel=hG;function pG(n,e,t){let r=bh(),i={id:r,name:n,kind:"subchannel"};return t&&(EC[r]={ref:i,getInfo:e}),i}Fe.registerChannelzSubchannel=pG;function gG(n,e){let t=bh(),r={id:t,kind:"server"};return e&&(Si[t]={ref:r,getInfo:n}),r}Fe.registerChannelzServer=gG;function mG(n,e,t){let r=bh(),i={id:r,name:n,kind:"socket"};return t&&(_C[r]={ref:i,getInfo:e}),i}Fe.registerChannelzSocket=mG;function yG(n){switch(n.kind){case"channel":delete Ml[n.id];return;case"subchannel":delete EC[n.id];return;case"server":delete Si[n.id];return;case"socket":delete _C[n.id];return}}Fe.unregisterChannelzRef=yG;function vG(n){let e=Number.parseInt(n,16);return[e/256|0,e%256]}function WO(n){if(n==="")return[];let e=n.split(":").map(r=>vG(r));return[].concat(...e)}function EG(n){if((0,zO.isIPv4)(n))return Buffer.from(Uint8Array.from(n.split(".").map(e=>Number.parseInt(e))));if((0,zO.isIPv6)(n)){let e,t,r=n.indexOf("::");r===-1?(e=n,t=""):(e=n.substring(0,r),t=n.substring(r+2));let i=Buffer.from(WO(e)),s=Buffer.from(WO(t)),o=Buffer.alloc(16-i.length-s.length,0);return Buffer.concat([i,o,s])}else return null}function QO(n){switch(n){case Nl.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case Nl.ConnectivityState.IDLE:return{state:"IDLE"};case Nl.ConnectivityState.READY:return{state:"READY"};case Nl.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case Nl.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function Fr(n){if(!n)return null;let e=n.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function YO(n){let e=n.getInfo();return{ref:pC(n.ref),data:{target:e.target,state:QO(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Fr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(t=>pC(t)),subchannel_ref:e.children.subchannels.map(t=>vC(t))}}function _G(n,e){let t=Number.parseInt(n.request.channel_id),r=Ml[t];if(r===void 0){e({code:Rl.Status.NOT_FOUND,details:"No channel data found for id "+t});return}e(null,{channel:YO(r)})}function CG(n,e){let t=Number.parseInt(n.request.max_results),r=[],i=Number.parseInt(n.request.start_channel_id);for(;i<Ml.length;i++){let s=Ml[i];if(s!==void 0&&(r.push(YO(s)),r.length>=t))break}e(null,{channel:r,end:i>=Si.length})}function ZO(n){let e=n.getInfo();return{ref:dG(n.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Fr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(t=>Ch(t))}}function bG(n,e){let t=Number.parseInt(n.request.server_id),r=Si[t];if(r===void 0){e({code:Rl.Status.NOT_FOUND,details:"No server data found for id "+t});return}e(null,{server:ZO(r)})}function SG(n,e){let t=Number.parseInt(n.request.max_results),r=[],i=Number.parseInt(n.request.start_server_id);for(;i<Si.length;i++){let s=Si[i];if(s!==void 0&&(r.push(ZO(s)),r.length>=t))break}e(null,{server:r,end:i>=Si.length})}function TG(n,e){let t=Number.parseInt(n.request.subchannel_id),r=EC[t];if(r===void 0){e({code:Rl.Status.NOT_FOUND,details:"No subchannel data found for id "+t});return}let i=r.getInfo(),s={ref:vC(r.ref),data:{target:i.target,state:QO(i.state),calls_started:i.callTracker.callsStarted,calls_succeeded:i.callTracker.callsSucceeded,calls_failed:i.callTracker.callsFailed,last_call_started_timestamp:Fr(i.callTracker.lastCallStartedTimestamp),trace:i.trace.getTraceMessage()},socket_ref:i.children.sockets.map(o=>Ch(o))};e(null,{subchannel:s})}function KO(n){var e;return(0,cG.isTcpSubchannelAddress)(n)?{address:"tcpip_address",tcpip_address:{ip_address:(e=EG(n.host))!==null&&e!==void 0?e:void 0,port:n.port}}:{address:"uds_address",uds_address:{filename:n.path}}}function DG(n,e){var t,r,i,s,o;let a=Number.parseInt(n.request.socket_id),c=_C[a];if(c===void 0){e({code:Rl.Status.NOT_FOUND,details:"No socket data found for id "+a});return}let l=c.getInfo(),u=l.security?{model:"tls",tls:{cipher_suite:l.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(t=l.security.cipherSuiteStandardName)!==null&&t!==void 0?t:void 0,other_name:(r=l.security.cipherSuiteOtherName)!==null&&r!==void 0?r:void 0,local_certificate:(i=l.security.localCertificate)!==null&&i!==void 0?i:void 0,remote_certificate:(s=l.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,d={ref:Ch(c.ref),local:l.localAddress?KO(l.localAddress):null,remote:l.remoteAddress?KO(l.remoteAddress):null,remote_name:(o=l.remoteName)!==null&&o!==void 0?o:void 0,security:u,data:{keep_alives_sent:l.keepAlivesSent,streams_started:l.streamsStarted,streams_succeeded:l.streamsSucceeded,streams_failed:l.streamsFailed,last_local_stream_created_timestamp:Fr(l.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:Fr(l.lastRemoteStreamCreatedTimestamp),messages_received:l.messagesReceived,messages_sent:l.messagesSent,last_message_received_timestamp:Fr(l.lastMessageReceivedTimestamp),last_message_sent_timestamp:Fr(l.lastMessageSentTimestamp),local_flow_control_window:l.localFlowControlWindow?{value:l.localFlowControlWindow}:null,remote_flow_control_window:l.remoteFlowControlWindow?{value:l.remoteFlowControlWindow}:null}};e(null,{socket:d})}function wG(n,e){let t=Number.parseInt(n.request.server_id),r=Si[t];if(r===void 0){e({code:Rl.Status.NOT_FOUND,details:"No server data found for id "+t});return}let i=Number.parseInt(n.request.start_socket_id),s=Number.parseInt(n.request.max_results),a=r.getInfo().sessionChildren.sockets.sort((u,d)=>u.id-d.id),c=[],l=0;for(;l<a.length&&!(a[l].id>=i&&(c.push(Ch(a[l])),c.length>=s));l++);e(null,{socket_ref:c,end:l>=a.length})}function JO(){return{GetChannel:_G,GetTopChannels:CG,GetServer:bG,GetServers:SG,GetSubchannel:TG,GetSocket:DG,GetServerSockets:wG}}Fe.getChannelzHandlers=JO;var _h=null;function XO(){if(_h)return _h;let n=hC().loadSync,e=n("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return _h=(0,uG.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,_h}Fe.getChannelzServiceDefinition=XO;function IG(){(0,lG.registerAdminService)(XO,JO)}Fe.setup=IG});var e1=I(Th=>{"use strict";Object.defineProperty(Th,"__esModule",{value:!0});Th.Subchannel=void 0;var Oe=dn(),AG=al(),CC=Ue(),Sh=be(),NG=Qt(),MG=Zn(),ua=xs(),RG="subchannel",xG=~(1<<31),bC=class{constructor(e,t,r,i,s){var o;this.channelTarget=e,this.subchannelAddress=t,this.options=r,this.credentials=i,this.connector=s,this.connectivityState=Oe.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new ua.ChannelzCallTracker,this.childrenTracker=new ua.ChannelzChildrenTracker,this.streamTracker=new ua.ChannelzCallTracker;let a={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new AG.BackoffTimeout(()=>{this.handleBackoffTimer()},a),this.backoffTimeout.unref(),this.subchannelAddressString=(0,MG.subchannelAddressToString)(t),this.keepaliveTime=(o=r["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1,r["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new ua.ChannelzTrace,this.channelzRef=(0,ua.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(r,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){CC.trace(Sh.LogVerbosity.DEBUG,RG,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){CC.trace(Sh.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([Oe.ConnectivityState.TRANSIENT_FAILURE],Oe.ConnectivityState.CONNECTING):this.transitionToState([Oe.ConnectivityState.TRANSIENT_FAILURE],Oe.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,xG);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(t=>{this.transitionToState([Oe.ConnectivityState.CONNECTING],Oe.ConnectivityState.READY)?(this.transport=t,this.channelzEnabled&&this.childrenTracker.refChild(t.getChannelzRef()),t.addDisconnectListener(r=>{this.transitionToState([Oe.ConnectivityState.READY],Oe.ConnectivityState.IDLE),r&&this.keepaliveTime>0&&(this.keepaliveTime*=2,CC.log(Sh.LogVerbosity.ERROR,`Connection to ${(0,NG.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):t.shutdown()},t=>{this.transitionToState([Oe.ConnectivityState.CONNECTING],Oe.ConnectivityState.TRANSIENT_FAILURE,`${t}`)})}transitionToState(e,t,r){var i,s;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(Oe.ConnectivityState[this.connectivityState]+" -> "+Oe.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Oe.ConnectivityState[t]);let o=this.connectivityState;switch(this.connectivityState=t,t){case Oe.ConnectivityState.READY:this.stopBackoff();break;case Oe.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case Oe.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(i=this.transport)===null||i===void 0||i.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case Oe.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let a of this.stateListeners)a(this,o,t,this.keepaliveTime,r);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,ua.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([Oe.ConnectivityState.CONNECTING,Oe.ConnectivityState.READY],Oe.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,t,r,i){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:o=>{o.code===Sh.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,t,r,i,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([Oe.ConnectivityState.IDLE],Oe.ConnectivityState.CONNECTING)||this.connectivityState===Oe.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([Oe.ConnectivityState.TRANSIENT_FAILURE],Oe.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};Th.Subchannel=bC});var wC=I(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});wi.setup=wi.DEFAULT_PORT=void 0;var t1=Qn(),r1=De("dns"),i1=De("util"),OG=FE(),SC=be(),TC=Ut(),kG=Ue(),PG=be(),Ti=Qt(),n1=De("net"),FG=al(),LG="dns_resolver";function Di(n){kG.trace(PG.LogVerbosity.DEBUG,LG,n)}wi.DEFAULT_PORT=443;var BG=3e4,VG=i1.promisify(r1.resolveTxt),UG=i1.promisify(r1.lookup);function jG(...n){let e=[];for(let t=0;t<Math.max.apply(null,n.map(r=>r.length));t++)for(let r of n)t<r.length&&e.push(r[t]);return e}var DC=class{constructor(e,t,r){var i,s,o;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,Di("Resolver constructed for target "+(0,Ti.uriToString)(e));let a=(0,Ti.splitHostPort)(e.path);a===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,n1.isIPv4)(a.host)||(0,n1.isIPv6)(a.host)?(this.ipResult=[{host:a.host,port:(i=a.port)!==null&&i!==void 0?i:wi.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=(s=a.port)!==null&&s!==void 0?s:wi.DEFAULT_PORT),this.percentage=Math.random()*100,r["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:SC.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,Ti.uriToString)(this.target)}`,metadata:new TC.Metadata};let c={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoff=new FG.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},c),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(o=r["grpc.dns_min_time_between_resolutions_ms"])!==null&&o!==void 0?o:BG,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(Di("Returning IP address for target "+(0,Ti.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)Di("Failed to parse DNS address "+(0,Ti.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:SC.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,Ti.uriToString)(this.target)}`,metadata:new TC.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;Di("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=UG(e,{all:!0}),this.pendingLookupPromise.then(t=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let r=t.filter(o=>o.family===4),i=t.filter(o=>o.family===6);this.latestLookupResult=jG(i,r).map(o=>({host:o.address,port:+this.port}));let s="["+this.latestLookupResult.map(o=>o.host+":"+o.port).join(",")+"]";if(Di("Resolved addresses for target "+(0,Ti.uriToString)(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},t=>{this.pendingLookupPromise!==null&&(Di("Resolution error for target "+(0,Ti.uriToString)(this.target)+": "+t.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=VG(e),this.pendingTxtPromise.then(t=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,OG.extractAndSelectServiceConfig)(t,this.percentage)}catch(r){this.latestServiceConfigError={code:SC.Status.UNAVAILABLE,details:`Parsing service config failed with error ${r.message}`,metadata:new TC.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},t=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?Di('resolution update delayed by "min time between resolutions" rate limit'):Di("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function qG(){(0,t1.registerResolver)("dns",DC),(0,t1.registerDefaultScheme)("dns")}wi.setup=qG});var IC=I(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.getProxiedConnection=ha.mapProxyName=void 0;var xl=Ue(),da=be(),HG=Qn(),$G=De("http"),zG=De("tls"),GG=Ue(),s1=Zn(),fa=Qt(),WG=De("url"),KG=wC(),QG="proxy";function Ii(n){GG.trace(da.LogVerbosity.DEBUG,QG,n)}function YG(){let n="",e="";if(process.env.grpc_proxy)e="grpc_proxy",n=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",n=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",n=process.env.http_proxy;else return{};let t;try{t=new WG.URL(n)}catch{return(0,xl.log)(da.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(t.protocol!=="http:")return(0,xl.log)(da.LogVerbosity.ERROR,`"${t.protocol}" scheme not supported in proxy URI`),{};let r=null;t.username&&(t.password?((0,xl.log)(da.LogVerbosity.INFO,"userinfo found in proxy URI"),r=`${t.username}:${t.password}`):r=t.username);let i=t.hostname,s=t.port;s===""&&(s="80");let o={address:`${i}:${s}`};return r&&(o.creds=r),Ii("Proxy server "+o.address+" set by environment variable "+e),o}function ZG(){let n=process.env.no_grpc_proxy,e="no_grpc_proxy";return n||(n=process.env.no_proxy,e="no_proxy"),n?(Ii("No proxy server list set by environment variable "+e),n.split(",")):[]}function JG(n,e){var t;let r={target:n,extraOptions:{}};if(((t=e["grpc.enable_http_proxy"])!==null&&t!==void 0?t:1)===0||n.scheme==="unix")return r;let i=YG();if(!i.address)return r;let s=(0,fa.splitHostPort)(n.path);if(!s)return r;let o=s.host;for(let c of ZG())if(c===o)return Ii("Not using proxy for target in no_proxy list: "+(0,fa.uriToString)(n)),r;let a={"grpc.http_connect_target":(0,fa.uriToString)(n)};return i.creds&&(a["grpc.http_connect_creds"]=i.creds),{target:{scheme:"dns",path:i.address},extraOptions:a}}ha.mapProxyName=JG;function XG(n,e,t){var r;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let i=e["grpc.http_connect_target"],s=(0,fa.parseUri)(i);if(s===null)return Promise.resolve({});let o=(0,fa.splitHostPort)(s.path);if(o===null)return Promise.resolve({});let a=`${o.host}:${(r=o.port)!==null&&r!==void 0?r:KG.DEFAULT_PORT}`,c={method:"CONNECT",path:a},l={Host:a};(0,s1.isTcpSubchannelAddress)(n)?(c.host=n.host,c.port=n.port):c.socketPath=n.path,"grpc.http_connect_creds"in e&&(l["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),c.headers=l;let u=(0,s1.subchannelAddressToString)(n);return Ii("Using proxy "+u+" to connect to "+c.path),new Promise((d,f)=>{let h=$G.request(c);h.once("connect",(_,b,T)=>{var D;if(h.removeAllListeners(),b.removeAllListeners(),_.statusCode===200)if(Ii("Successfully connected to "+c.path+" through proxy "+u),"secureContext"in t){let k=(0,HG.getDefaultAuthority)(s),P=(0,fa.splitHostPort)(k),w=(D=P?.host)!==null&&D!==void 0?D:k,q=zG.connect(Object.assign({host:w,servername:w,socket:b},t),()=>{Ii("Successfully established a TLS connection to "+c.path+" through proxy "+u),d({socket:q,realTarget:s})});q.on("error",z=>{Ii("Failed to establish a TLS connection to "+c.path+" through proxy "+u+" with error "+z.message),f()})}else Ii("Successfully established a plaintext connection to "+c.path+" through proxy "+u),d({socket:b,realTarget:s});else(0,xl.log)(da.LogVerbosity.ERROR,"Failed to connect to "+c.path+" through proxy "+u+" with status "+_.statusCode),f()}),h.once("error",_=>{h.removeAllListeners(),(0,xl.log)(da.LogVerbosity.ERROR,"Failed to connect to proxy "+u+" with error "+_.message),f()}),h.end()})}ha.getProxiedConnection=XG});var NC=I(Dh=>{"use strict";Object.defineProperty(Dh,"__esModule",{value:!0});Dh.StreamDecoder=void 0;var Lr=(function(n){return n[n.NO_DATA=0]="NO_DATA",n[n.READING_SIZE=1]="READING_SIZE",n[n.READING_MESSAGE=2]="READING_MESSAGE",n})(Lr||{}),AC=class{constructor(e){this.maxReadMessageLength=e,this.readState=Lr.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t=0,r,i=[];for(;t<e.length;)switch(this.readState){case Lr.NO_DATA:this.readCompressFlag=e.slice(t,t+1),t+=1,this.readState=Lr.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case Lr.READING_SIZE:if(r=Math.min(e.length-t,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+r),this.readSizeRemaining-=r,t+=r,this.readSizeRemaining===0){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.maxReadMessageLength!==-1&&this.readMessageSize>this.maxReadMessageLength)throw new Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=Lr.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=Lr.NO_DATA,i.push(s)}}break;case Lr.READING_MESSAGE:if(r=Math.min(e.length-t,this.readMessageRemaining),this.readPartialMessage.push(e.slice(t,t+r)),this.readMessageRemaining-=r,t+=r,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),o=Buffer.concat(s,this.readMessageSize+5);this.readState=Lr.NO_DATA,i.push(o)}break;default:throw new Error("Unexpected read state")}return i}};Dh.StreamDecoder=AC});var o1=I(wh=>{"use strict";Object.defineProperty(wh,"__esModule",{value:!0});wh.Http2SubchannelCall=void 0;var Br=De("http2"),e8=De("os"),Ae=be(),Ai=Ut(),t8=NC(),n8=Ue(),r8=be(),i8="subchannel_call";function s8(n){for(let[e,t]of Object.entries(e8.constants.errno))if(t===n)return e;return"Unknown system error "+n}var MC=class{constructor(e,t,r,i,s){var o;this.http2Stream=e,this.callEventTracker=t,this.listener=r,this.transport=i,this.callId=s,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=Ae.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let a=(o=i.getOptions()["grpc.max_receive_message_length"])!==null&&o!==void 0?o:Ae.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new t8.StreamDecoder(a),e.on("response",(c,l)=>{let u="";for(let d of Object.keys(c))u+="		"+d+": "+c[d]+`
`;switch(this.trace(`Received server headers:
`+u),c[":status"]){case 400:this.mappedStatusCode=Ae.Status.INTERNAL;break;case 401:this.mappedStatusCode=Ae.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=Ae.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=Ae.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=Ae.Status.UNAVAILABLE;break;default:this.mappedStatusCode=Ae.Status.UNKNOWN}if(l&Br.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(c);else{let d;try{d=Ai.Metadata.fromHttp2Headers(c)}catch(f){this.endCall({code:Ae.Status.UNKNOWN,details:f.message,metadata:new Ai.Metadata});return}this.listener.onReceiveMetadata(d)}}),e.on("trailers",c=>{this.handleTrailers(c)}),e.on("data",c=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+c.length);let l;try{l=this.decoder.write(c)}catch(u){this.cancelWithStatus(Ae.Status.RESOURCE_EXHAUSTED,u.message);return}for(let u of l)this.trace("parsed message of length "+u.length),this.callEventTracker.addMessageReceived(),this.tryPush(u)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var c;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((c=this.finalStatus)===null||c===void 0?void 0:c.code)===Ae.Status.OK)return;let l,u="";switch(e.rstCode){case Br.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;l=Ae.Status.INTERNAL,u=`Received RST_STREAM with code ${e.rstCode}`;break;case Br.constants.NGHTTP2_REFUSED_STREAM:l=Ae.Status.UNAVAILABLE,u="Stream refused by server";break;case Br.constants.NGHTTP2_CANCEL:l=Ae.Status.CANCELLED,u="Call cancelled";break;case Br.constants.NGHTTP2_ENHANCE_YOUR_CALM:l=Ae.Status.RESOURCE_EXHAUSTED,u="Bandwidth exhausted or memory limit exceeded";break;case Br.constants.NGHTTP2_INADEQUATE_SECURITY:l=Ae.Status.PERMISSION_DENIED,u="Protocol not secure enough";break;case Br.constants.NGHTTP2_INTERNAL_ERROR:l=Ae.Status.INTERNAL,this.internalError===null?u=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(l=Ae.Status.UNAVAILABLE,u=this.internalError.message):u=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:l=Ae.Status.INTERNAL,u=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:l,details:u,metadata:new Ai.Metadata,rstCode:e.rstCode})})}),e.on("error",c=>{c.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+c.message+" code="+c.code+" errno="+s8(c.errno)+" syscall="+c.syscall),this.internalError=c),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:Ae.Status.UNAVAILABLE,details:"Connection dropped",metadata:new Ai.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){n8.trace(r8.LogVerbosity.DEBUG,i8,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===Ae.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==Ae.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callEventTracker.onStreamEnd(!0);let t="";for(let c of Object.keys(e))t+="		"+c+": "+e[c]+`
`;this.trace(`Received server trailers:
`+t);let r;try{r=Ai.Metadata.fromHttp2Headers(e)}catch{r=new Ai.Metadata}let i=r.getMap(),s=this.mappedStatusCode;if(s===Ae.Status.UNKNOWN&&typeof i["grpc-status"]=="string"){let c=Number(i["grpc-status"]);c in Ae.Status&&(s=c,this.trace("received status code "+c+" from server")),r.remove("grpc-status")}let o="";if(typeof i["grpc-message"]=="string"){try{o=decodeURI(i["grpc-message"])}catch{o=i["grpc-message"]}r.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let a={code:s,details:o,metadata:r};this.endCall(a)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===Ae.Status.OK?t=Br.constants.NGHTTP2_NO_ERROR:t=Br.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new Ai.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==Ae.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let r=i=>{process.nextTick(()=>{var s;let o=Ae.Status.UNAVAILABLE;i?.code==="ERR_STREAM_WRITE_AFTER_END"&&(o=Ae.Status.INTERNAL),i&&this.cancelWithStatus(o,`Write error: ${i.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,r)}catch(i){this.endCall({code:Ae.Status.UNAVAILABLE,details:`Write failed with error ${i.message}`,metadata:new Ai.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};wh.Http2SubchannelCall=MC});var RC=I(Ih=>{"use strict";Object.defineProperty(Ih,"__esModule",{value:!0});Ih.getNextCallNumber=void 0;var o8=0;function a8(){return o8++}Ih.getNextCallNumber=a8});var l1=I(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});Nh.Http2SubchannelConnector=void 0;var FC=De("http2"),a1=De("tls"),xC=xs(),Ol=be(),c8=IC(),ga=Ue(),c1=Qn(),Ah=Zn(),pa=Qt(),l8=De("net"),u8=o1(),d8=RC(),OC="transport",f8="transport_flowctrl",h8=vE().version,{HTTP2_HEADER_AUTHORITY:p8,HTTP2_HEADER_CONTENT_TYPE:g8,HTTP2_HEADER_METHOD:m8,HTTP2_HEADER_PATH:y8,HTTP2_HEADER_TE:v8,HTTP2_HEADER_USER_AGENT:E8}=FC.constants,_8=2e4,C8=Buffer.from("too_many_pings","ascii"),kC=class{constructor(e,t,r,i){this.session=e,this.options=r,this.remoteName=i,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=_8,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new xC.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,Ah.subchannelAddressToString)(t),r["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,xC.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[r["grpc.primary_user_agent"],`grpc-node-js/${h8}`,r["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in r&&(this.keepaliveTimeMs=r["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in r&&(this.keepaliveTimeoutMs=r["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in r?this.keepaliveWithoutCalls=r["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(s,o,a)=>{let c=!1;s===FC.constants.NGHTTP2_ENHANCE_YOUR_CALM&&a&&a.equals(C8)&&(c=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+a?.toString()),this.reportDisconnectToOwner(c)}),e.once("error",s=>{this.trace("connection closed with error "+s.message)}),ga.isTracerEnabled(OC)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,r;let i=this.session.socket,s=i.remoteAddress?(0,Ah.stringToSubchannelAddress)(i.remoteAddress,i.remotePort):null,o=i.localAddress?(0,Ah.stringToSubchannelAddress)(i.localAddress,i.localPort):null,a;if(this.session.encrypted){let l=i,u=l.getCipher(),d=l.getCertificate(),f=l.getPeerCertificate();a={cipherSuiteStandardName:(e=u.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:u.standardName?null:u.name,localCertificate:d&&"raw"in d?d.raw:null,remoteCertificate:f&&"raw"in f?f.raw:null}}else a=null;return{remoteAddress:s,localAddress:o,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(r=this.session.state.remoteWindowSize)!==null&&r!==void 0?r:null}}trace(e){ga.trace(Ol.LogVerbosity.DEBUG,OC,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){ga.trace(Ol.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){ga.trace(Ol.LogVerbosity.DEBUG,f8,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){ga.trace(Ol.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0||t.call(e));try{this.session.ping((r,i,s)=>{r&&(this.keepaliveTrace("Ping failed with error "+r.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch{this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):!this.keepaliveTimerId&&!this.keepaliveTimeoutId&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)===null||t===void 0?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,r,i,s){let o=e.toHttp2Headers();o[p8]=t,o[E8]=this.userAgent,o[g8]="application/grpc",o[m8]="POST",o[y8]=r,o[v8]="trailers";let a;try{a=this.session.request(o)}catch(u){throw this.handleDisconnect(),u}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let c,l;return this.channelzEnabled?(this.streamTracker.addCallStarted(),c={addMessageSent:()=>{var u;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var d;(d=s.onCallEnd)===null||d===void 0||d.call(s,u),this.removeActiveCall(l)},onStreamEnd:u=>{var d;u?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(d=s.onStreamEnd)===null||d===void 0||d.call(s,u)}}):c={addMessageSent:()=>{var u;(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var d;(d=s.onCallEnd)===null||d===void 0||d.call(s,u),this.removeActiveCall(l)},onStreamEnd:u=>{var d;(d=s.onStreamEnd)===null||d===void 0||d.call(s,u)}},l=new u8.Http2SubchannelCall(a,c,i,this,(0,d8.getNextCallNumber)()),this.addActiveCall(l),l}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,xC.unregisterChannelzRef)(this.channelzRef)}},PC=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){ga.trace(Ol.LogVerbosity.DEBUG,OC,(0,pa.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,r,i){return this.isShutdown?Promise.reject():new Promise((s,o)=>{var a,c,l;let u;i.realTarget?(u=(0,pa.uriToString)(i.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,pa.uriToString)(i.realTarget))):(u=null,this.trace("creating HTTP/2 session to "+(0,Ah.subchannelAddressToString)(e)));let d=(0,c1.getDefaultAuthority)((a=i.realTarget)!==null&&a!==void 0?a:this.channelTarget),f=t._getConnectionOptions()||{};f.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in r?f.maxSessionMemory=r["grpc-node.max_session_memory"]:f.maxSessionMemory=Number.MAX_SAFE_INTEGER;let h="http://";if("secureContext"in f){if(h="https://",r["grpc.ssl_target_name_override"]){let T=r["grpc.ssl_target_name_override"];f.checkServerIdentity=(D,k)=>(0,a1.checkServerIdentity)(T,k),f.servername=T}else{let T=(l=(c=(0,pa.splitHostPort)(d))===null||c===void 0?void 0:c.host)!==null&&l!==void 0?l:"localhost";f.servername=T}i.socket&&(f.createConnection=(T,D)=>i.socket)}else f.createConnection=(T,D)=>i.socket?i.socket:l8.connect(e);f=Object.assign(Object.assign(Object.assign({},f),e),{enableTrace:r["grpc-node.tls_enable_trace"]===1});let _=FC.connect(h+d,f);this.session=_;let b="Failed to connect";_.unref(),_.once("connect",()=>{_.removeAllListeners(),s(new kC(_,e,r,u)),this.session=null}),_.once("close",()=>{this.session=null,setImmediate(()=>{o(`${b} (${new Date().toISOString()})`)})}),_.once("error",T=>{b=T.message,this.trace("connection failed with error "+b)})})}connect(e,t,r){var i,s;if(this.isShutdown)return Promise.reject();let o=t._getConnectionOptions()||{};if("secureContext"in o){if(o.ALPNProtocols=["h2"],r["grpc.ssl_target_name_override"]){let a=r["grpc.ssl_target_name_override"];o.checkServerIdentity=(c,l)=>(0,a1.checkServerIdentity)(a,l),o.servername=a}else if("grpc.http_connect_target"in r){let a=(0,c1.getDefaultAuthority)((i=(0,pa.parseUri)(r["grpc.http_connect_target"]))!==null&&i!==void 0?i:{path:"localhost"}),c=(0,pa.splitHostPort)(a);o.servername=(s=c?.host)!==null&&s!==void 0?s:a}r["grpc-node.tls_enable_trace"]&&(o.enableTrace=!0)}return(0,c8.getProxiedConnection)(e,r,o).then(a=>this.createSession(e,t,r,a))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};Nh.Http2SubchannelConnector=PC});var u1=I(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.getSubchannelPool=ma.SubchannelPool=void 0;var b8=JM(),S8=e1(),T8=Zn(),D8=Qt(),w8=l1(),I8=1e4,kl=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let i=this.pool[t].filter(s=>!s.subchannel.unrefIfOneRef());i.length>0&&(e=!1),this.pool[t]=i}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},I8),(t=(e=this.cleanupTimer).unref)===null||t===void 0||t.call(e))}getOrCreateSubchannel(e,t,r,i){this.ensureCleanupTask();let s=(0,D8.uriToString)(e);if(s in this.pool){let a=this.pool[s];for(let c of a)if((0,T8.subchannelAddressEqual)(t,c.subchannelAddress)&&(0,b8.channelOptionsEqual)(r,c.channelArguments)&&i._equals(c.channelCredentials))return c.subchannel}let o=new S8.Subchannel(e,t,r,i,new w8.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:t,channelArguments:r,channelCredentials:i,subchannel:o}),o.ref(),o}};ma.SubchannelPool=kl;var A8=new kl;function N8(n){return n?A8:new kl}ma.getSubchannelPool=N8});var BC=I(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.FilterStackFactory=ya.FilterStack=void 0;var Mh=class{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let r=0;r<this.filters.length;r++)t=this.filters[r].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let r=0;r<this.filters.length;r++)t=this.filters[r].sendMessage(t);return t}receiveMessage(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};ya.FilterStack=Mh;var LC=class n{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new n([...this.factories])}createFilter(){return new Mh(this.factories.map(e=>e.createFilter()))}};ya.FilterStackFactory=LC});var VC=I(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});Rh.CompressionAlgorithms=void 0;var d1=(function(n){return n[n.identity=0]="identity",n[n.deflate=1]="deflate",n[n.gzip=2]="gzip",n})(d1||(Rh.CompressionAlgorithms=d1={}))});var jC=I(xh=>{"use strict";Object.defineProperty(xh,"__esModule",{value:!0});xh.BaseFilter=void 0;var UC=class{async sendMetadata(e){return e}receiveMetadata(e){return e}async sendMessage(e){return e}async receiveMessage(e){return e}receiveTrailers(e){return e}};xh.BaseFilter=UC});var p1=I(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});Ea.CompressionFilterFactory=Ea.CompressionFilter=void 0;var Oh=De("zlib"),h1=VC(),kh=be(),M8=jC(),R8=Ue(),x8=n=>typeof n=="number"&&typeof h1.CompressionAlgorithms[n]=="string",va=class{async writeMessage(e,t){let r=e;t&&(r=await this.compressMessage(r));let i=Buffer.allocUnsafe(r.length+5);return i.writeUInt8(t?1:0,0),i.writeUInt32BE(r.length,1),r.copy(i,5),i}async readMessage(e){let t=e.readUInt8(0)===1,r=e.slice(5);return t&&(r=await this.decompressMessage(r)),r}},Os=class extends va{async compressMessage(e){return e}async writeMessage(e,t){let r=Buffer.allocUnsafe(e.length+5);return r.writeUInt8(0,0),r.writeUInt32BE(e.length,1),e.copy(r,5),r}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},qC=class extends va{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{Oh.deflate(e,(i,s)=>{i?r(i):t(s)})})}decompressMessage(e){return new Promise((t,r)=>{let i=0,s=[],o=Oh.createInflate();o.on("data",a=>{s.push(a),i+=a.byteLength,this.maxRecvMessageLength!==-1&&i>this.maxRecvMessageLength&&(o.destroy(),r({code:kh.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(s))}),o.write(e),o.end()})}},HC=class extends va{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{Oh.gzip(e,(i,s)=>{i?r(i):t(s)})})}decompressMessage(e){return new Promise((t,r)=>{let i=0,s=[],o=Oh.createGunzip();o.on("data",a=>{s.push(a),i+=a.byteLength,this.maxRecvMessageLength!==-1&&i>this.maxRecvMessageLength&&(o.destroy(),r({code:kh.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(s))}),o.write(e),o.end()})}},$C=class extends va{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function f1(n,e){switch(n){case"identity":return new Os;case"deflate":return new qC(e);case"gzip":return new HC(e);default:return new $C(n)}}var Ph=class extends M8.BaseFilter{constructor(e,t){var r,i;super(),this.sharedFilterConfig=t,this.sendCompression=new Os,this.receiveCompression=new Os,this.currentCompressionAlgorithm="identity";let s=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=(r=e["grpc.max_receive_message_length"])!==null&&r!==void 0?r:kh.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,s!==void 0)if(x8(s)){let o=h1.CompressionAlgorithms[s],a=(i=t.serverSupportedEncodingHeader)===null||i===void 0?void 0:i.split(",");(!a||a.includes(o))&&(this.currentCompressionAlgorithm=o,this.sendCompression=f1(this.currentCompressionAlgorithm,-1))}else R8.log(kh.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${s}`)}async sendMetadata(e){let t=await e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let i=t[0];typeof i=="string"&&(this.receiveCompression=f1(i,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let r=e.get("grpc-accept-encoding")[0];return r&&(this.sharedFilterConfig.serverSupportedEncodingHeader=r,r.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new Os,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}async sendMessage(e){var t;let r=await e,i;return this.sendCompression instanceof Os?i=!1:i=(((t=r.flags)!==null&&t!==void 0?t:0)&2)===0,{message:await this.sendCompression.writeMessage(r.message,i),flags:r.flags}}async receiveMessage(e){return this.receiveCompression.readMessage(await e)}};Ea.CompressionFilter=Ph;var zC=class{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new Ph(this.options,this.sharedFilterConfig)}};Ea.CompressionFilterFactory=zC});var Fh=I(ar=>{"use strict";Object.defineProperty(ar,"__esModule",{value:!0});ar.deadlineToString=ar.getRelativeTimeout=ar.getDeadlineTimeoutString=ar.minDeadline=void 0;function O8(...n){let e=1/0;for(let t of n){let r=t instanceof Date?t.getTime():t;r<e&&(e=r)}return e}ar.minDeadline=O8;var k8=[["m",1],["S",1e3],["M",60*1e3],["H",3600*1e3]];function P8(n){let e=new Date().getTime();n instanceof Date&&(n=n.getTime());let t=Math.max(n-e,0);for(let[r,i]of k8){let s=t/i;if(s<1e8)return String(Math.ceil(s))+r}throw new Error("Deadline is too far in the future")}ar.getDeadlineTimeoutString=P8;var F8=2147483647;function L8(n){let e=n instanceof Date?n.getTime():n,t=new Date().getTime(),r=e-t;return r<0?0:r>F8?1/0:r}ar.getRelativeTimeout=L8;function B8(n){if(n instanceof Date)return n.toISOString();{let e=new Date(n);return Number.isNaN(e.getTime())?""+n:e.toISOString()}}ar.deadlineToString=B8});var Bh=I(Lh=>{"use strict";Object.defineProperty(Lh,"__esModule",{value:!0});Lh.restrictControlPlaneStatusCode=void 0;var cr=be(),V8=[cr.Status.OK,cr.Status.INVALID_ARGUMENT,cr.Status.NOT_FOUND,cr.Status.ALREADY_EXISTS,cr.Status.FAILED_PRECONDITION,cr.Status.ABORTED,cr.Status.OUT_OF_RANGE,cr.Status.DATA_LOSS];function U8(n,e){return V8.includes(n)?{code:cr.Status.INTERNAL,details:`Invalid status from control plane: ${n} ${cr.Status[n]} ${e}`}:{code:n,details:e}}Lh.restrictControlPlaneStatusCode=U8});var m1=I(jh=>{"use strict";Object.defineProperty(jh,"__esModule",{value:!0});jh.LoadBalancingCall=void 0;var g1=dn(),Vh=be(),j8=Fh(),Uh=Ut(),Pl=hi(),q8=Qt(),H8=Ue(),GC=Bh(),$8=De("http2"),z8="load_balancing_call",WC=class{constructor(e,t,r,i,s,o,a){var c,l;this.channel=e,this.callConfig=t,this.methodName=r,this.host=i,this.credentials=s,this.deadline=o,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let u=this.methodName.split("/"),d="";u.length>=2&&(d=u[1]);let f=(l=(c=(0,q8.splitHostPort)(this.host))===null||c===void 0?void 0:c.host)!==null&&l!==void 0?l:"localhost";this.serviceUrl=`https://${f}/${d}`}trace(e){H8.trace(Vh.LogVerbosity.DEBUG,z8,"["+this.callNumber+"] "+e)}outputStatus(e,t){var r,i;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let s=Object.assign(Object.assign({},e),{progress:t});(r=this.listener)===null||r===void 0||r.onReceiveStatus(s),(i=this.onCallEnded)===null||i===void 0||i.call(this,s.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let r=this.channel.doPick(this.metadata,this.callConfig.pickInformation),i=r.subchannel?"("+r.subchannel.getChannelzRef().id+") "+r.subchannel.getAddress():""+r.subchannel;switch(this.trace("Pick result: "+Pl.PickResultType[r.pickResultType]+" subchannel: "+i+" status: "+((e=r.status)===null||e===void 0?void 0:e.code)+" "+((t=r.status)===null||t===void 0?void 0:t.details)),r.pickResultType){case Pl.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var c,l,u;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let d=this.metadata.clone();if(d.merge(a),d.get("authorization").length>1&&this.outputStatus({code:Vh.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new Uh.Metadata},"PROCESSED"),r.subchannel.getConnectivityState()!==g1.ConnectivityState.READY){this.trace("Picked subchannel "+i+" has state "+g1.ConnectivityState[r.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&d.set("grpc-timeout",(0,j8.getDeadlineTimeoutString)(this.deadline));try{this.child=r.subchannel.getRealSubchannel().createCall(d,this.host,this.methodName,{onReceiveMetadata:f=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(f)},onReceiveMessage:f=>{this.trace("Received message"),this.listener.onReceiveMessage(f)},onReceiveStatus:f=>{this.trace("Received status"),f.rstCode===$8.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(f,"REFUSED"):this.outputStatus(f,"PROCESSED")}})}catch(f){this.trace("Failed to start call on picked subchannel "+i+" with error "+f.message),this.outputStatus({code:Vh.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+f.message,metadata:new Uh.Metadata},"NOT_STARTED");return}(l=(c=this.callConfig).onCommitted)===null||l===void 0||l.call(c),(u=r.onCallStarted)===null||u===void 0||u.call(r),this.onCallEnded=r.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:c,details:l}=(0,GC.restrictControlPlaneStatusCode)(typeof a.code=="number"?a.code:Vh.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:c,details:l,metadata:new Uh.Metadata},"PROCESSED")});break;case Pl.PickResultType.DROP:let{code:s,details:o}=(0,GC.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:s,details:o,metadata:r.status.metadata},"DROP")});break;case Pl.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:c}=(0,GC.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:a,details:c,metadata:r.status.metadata},"PROCESSED")})}break;case Pl.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(r=this.child)===null||r===void 0||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new Uh.Metadata},"PROCESSED")}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};jh.LoadBalancingCall=WC});var v1=I(Hh=>{"use strict";Object.defineProperty(Hh,"__esModule",{value:!0});Hh.ResolvingCall=void 0;var _a=be(),qh=Fh(),y1=Ut(),G8=Ue(),W8=Bh(),K8="resolving_call",KC=class{constructor(e,t,r,i,s,o){this.channel=e,this.method=t,this.filterStackFactory=i,this.credentials=s,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=r.deadline,this.host=r.host,r.parentCall&&(r.flags&_a.Propagate.CANCELLATION&&r.parentCall.on("cancelled",()=>{this.cancelWithStatus(_a.Status.CANCELLED,"Cancelled by parent call")}),r.flags&_a.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+r.parentCall.getDeadline()),this.deadline=(0,qh.minDeadline)(this.deadline,r.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){G8.trace(_a.LogVerbosity.DEBUG,K8,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,qh.deadlineToString)(this.deadline));let e=(0,qh.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(_a.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(r=>r(t)),process.nextTick(()=>{var r;(r=this.listener)===null||r===void 0||r.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let r=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(i=>{this.writeFilterPending=!1,r.sendMessageWithContext(e,i.message),this.pendingHalfClose&&r.halfClose()},i=>{this.cancelWithStatus(i.code,i.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let t=e.config;if(t.status!==_a.Status.OK){let{code:r,details:i}=(0,W8.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:r,details:i,metadata:new y1.Metadata});return}if(t.methodConfig.timeout){let r=new Date;r.setSeconds(r.getSeconds()+t.methodConfig.timeout.seconds),r.setMilliseconds(r.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,qh.minDeadline)(this.deadline,r),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(r=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(r,{onReceiveMetadata:i=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(i))},onReceiveMessage:i=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(i).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:i=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=i:this.outputStatus(i)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},r=>{this.outputStatus(r)})}reportResolverError(e){var t;!((t=this.metadata)===null||t===void 0)&&t.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(r=this.child)===null||r===void 0||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new y1.Metadata})}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};Hh.ResolvingCall=KC});var E1=I(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});Ni.RetryingCall=Ni.MessageBufferTracker=Ni.RetryThrottler=void 0;var $h=be(),Q8=Ut(),Y8=Ue(),Z8="retrying_call",YC=class{constructor(e,t,r){this.maxTokens=e,this.tokenRatio=t,r?this.tokens=r.tokens*(e/r.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};Ni.RetryThrottler=YC;var ZC=class{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var r;let i=(r=this.allocatedPerCall.get(t))!==null&&r!==void 0?r:0;return this.limitPerCall-i<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(t,i+e),this.totalAllocated+=e,!0)}free(e,t){var r;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let i=(r=this.allocatedPerCall.get(t))!==null&&r!==void 0?r:0;if(i<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${i}`);this.allocatedPerCall.set(t,i-e)}freeAll(e){var t;let r=(t=this.allocatedPerCall.get(e))!==null&&t!==void 0?t:0;if(this.totalAllocated<r)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${r} > total allocated ${this.totalAllocated}`);this.totalAllocated-=r,this.allocatedPerCall.delete(e)}};Ni.MessageBufferTracker=ZC;var QC="grpc-previous-rpc-attempts",JC=class{constructor(e,t,r,i,s,o,a,c,l){if(this.channel=e,this.callConfig=t,this.methodName=r,this.host=i,this.credentials=s,this.deadline=o,this.callNumber=a,this.bufferTracker=c,this.retryThrottler=l,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";let u=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(u.initialBackoff.substring(0,u.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){Y8.trace($h.LogVerbosity.DEBUG,Z8,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;(t=this.listener)===null||t===void 0||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new Q8.Metadata});for(let{call:r}of this.underlyingCalls)r.cancelWithStatus(e,t)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return(t=this.writeBuffer[e-this.writeBufferOffset])!==null&&t!==void 0?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let r=this.getBufferEntry(t);r.allocated&&this.bufferTracker.free(r.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&this.underlyingCalls[t].state!=="COMPLETED"&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus($h.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,t=-1;for(let[r,i]of this.underlyingCalls.entries())i.state==="ACTIVE"&&i.nextMessageToSend>e&&(e=i.nextMessageToSend,t=r);t===-1?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(r=>r===t||r.toString().toLowerCase()===$h.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let r=Math.random()*this.nextRetryBackoffSec*1e3,i=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,i),r}maybeRetryCall(e,t){if(this.state!=="RETRY"){t(!1);return}let r=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(r.maxAttempts,5)){t(!1);return}let i;if(e===null)i=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else i=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var s,o;if(this.state!=="RETRY"){t(!1);return}(!((o=(s=this.retryThrottler)===null||s===void 0?void 0:s.canRetryCall())!==null&&o!==void 0)||o)&&(t(!0),this.attempts+=1,this.startNewAttempt())},i)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,r){var i,s,o;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((i=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&i!==void 0?i:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let a;if(r===null)a=0;else if(r<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else a=r;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(t),this.reportStatus(e))},a)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((o=this.retryThrottler)===null||o===void 0||o.addCallFailed(),this.maybeRetryCall(r,a=>{a||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e));break}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(t.length===0)return null;try{return parseInt(t[0])}catch{return-1}}handleChildStatus(e,t){var r;if(this.underlyingCalls[t].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===$h.Status.OK){(r=this.retryThrottler)===null||r===void 0||r.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let i=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,i):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,i);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,r;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let i=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(i.maxAttempts,5))return;let s=(e=i.hedgingDelay)!==null&&e!==void 0?e:"0s",o=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},o*1e3),(r=(t=this.hedgingTimer).unref)===null||r===void 0||r.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let r=this.attempts-1,i=this.initialMetadata.clone();r>0&&i.set(QC,`${r}`);let s=!1;e.start(i,{onReceiveMetadata:o=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),s=!0,r>0&&o.set(QC,`${r}`),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMetadata(o)},onReceiveMessage:o=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMessage(o)},onReceiveStatus:o=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&r>0&&o.metadata.set(QC,`${r}`),this.handleChildStatus(o,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,r;let i=this.underlyingCalls[e],s=i.nextMessageToSend;(r=(t=this.getBufferEntry(s)).callback)===null||r===void 0||r.call(t),this.clearSentMessages(),i.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if(t.state!=="COMPLETED"&&this.getBufferEntry(t.nextMessageToSend)){let r=this.getBufferEntry(t.nextMessageToSend);switch(r.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:i=>{this.handleChildWriteCompleted(e)}},r.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,t){var r;this.trace("write() called with message of length "+t.length);let i={message:t,flags:e.flags},s=this.getNextBufferIndex(),o={entryType:"MESSAGE",message:i,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(o),o.allocated){(r=e.callback)===null||r===void 0||r.call(e);for(let[a,c]of this.underlyingCalls.entries())c.state==="ACTIVE"&&c.nextMessageToSend===s&&c.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(a)}},t)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let a=this.underlyingCalls[this.committedCallIndex];o.callback=e.callback,a.state==="ACTIVE"&&a.nextMessageToSend===s&&a.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};Ni.RetryingCall=JC});var Gh=I(zh=>{"use strict";Object.defineProperty(zh,"__esModule",{value:!0});zh.BaseSubchannelWrapper=void 0;var XC=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};zh.BaseSubchannelWrapper=XC});var b1=I(Qh=>{"use strict";Object.defineProperty(Qh,"__esModule",{value:!0});Qh.InternalChannel=void 0;var J8=Rf(),X8=ZM(),e9=u1(),_1=hi(),Fl=be(),t9=BC(),n9=p1(),C1=Qn(),eb=Ue(),r9=IC(),Wh=Qt(),lr=dn(),Ll=xs(),i9=m1(),s9=Fh(),o9=v1(),tb=RC(),a9=Bh(),nb=E1(),c9=Gh(),l9=2147483647,u9=1e3,d9=1800*1e3,Kh=new Map,f9=1<<24,h9=1<<20,rb=class extends c9.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(r,i,s,o)=>{t.throttleKeepalive(o)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},ib=class{constructor(e,t,r){var i,s,o,a,c,l,u,d;if(this.credentials=t,this.options=r,this.connectivityState=lr.ConnectivityState.IDLE,this.currentPicker=new _1.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new Ll.ChannelzCallTracker,this.childrenTracker=new Ll.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof J8.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(r&&typeof r!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let f=(0,Wh.parseUri)(e);if(f===null)throw new Error(`Could not parse target name "${e}"`);let h=(0,C1.mapUriDefaultScheme)(f);if(h===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},l9),(s=(i=this.callRefTimer).unref)===null||s===void 0||s.call(i),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Ll.ChannelzTrace,this.channelzRef=(0,Ll.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,C1.getDefaultAuthority)(h);let _=(0,r9.mapProxyName)(h,r);this.target=_.target,this.options=Object.assign({},this.options,_.extraOptions),this.subchannelPool=(0,e9.getSubchannelPool)(((o=r["grpc.use_local_subchannel_pool"])!==null&&o!==void 0?o:0)===0),this.retryBufferTracker=new nb.MessageBufferTracker((a=r["grpc.retry_buffer_size"])!==null&&a!==void 0?a:f9,(c=r["grpc.per_rpc_retry_buffer_size"])!==null&&c!==void 0?c:h9),this.keepaliveTime=(l=r["grpc.keepalive_time_ms"])!==null&&l!==void 0?l:-1,this.idleTimeoutMs=Math.max((u=r["grpc.client_idle_timeout_ms"])!==null&&u!==void 0?u:d9,u9);let b={createSubchannel:(D,k)=>{let P=this.subchannelPool.getOrCreateSubchannel(this.target,D,Object.assign({},this.options,k),this.credentials);P.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",P.getChannelzRef());let w=new rb(P,this);return this.wrappedSubchannels.add(w),w},updateState:(D,k)=>{this.currentPicker=k;let P=this.pickQueue.slice();this.pickQueue=[],P.length>0&&this.callRefTimerUnref();for(let w of P)w.doPick();this.updateState(D)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:D=>{this.channelzEnabled&&this.childrenTracker.refChild(D)},removeChannelzChild:D=>{this.channelzEnabled&&this.childrenTracker.unrefChild(D)}};this.resolvingLoadBalancer=new X8.ResolvingLoadBalancer(this.target,b,r,(D,k)=>{D.retryThrottling?Kh.set(this.getTarget(),new nb.RetryThrottler(D.retryThrottling.maxTokens,D.retryThrottling.tokenRatio,Kh.get(this.getTarget()))):Kh.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=k,this.currentResolutionError=null,process.nextTick(()=>{let P=this.configSelectionQueue;this.configSelectionQueue=[],P.length>0&&this.callRefTimerUnref();for(let w of P)w.getConfig()})},D=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+D.code+' and details "'+D.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,a9.restrictControlPlaneStatusCode)(D.code,D.details)),{metadata:D.metadata}));let k=this.configSelectionQueue;this.configSelectionQueue=[],k.length>0&&this.callRefTimerUnref();for(let P of k)P.reportResolverError(D)}),this.filterStackFactory=new t9.FilterStackFactory([new n9.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(r,void 0,2));let T=new Error;(0,eb.trace)(Fl.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((d=T.stack)===null||d===void 0?void 0:d.substring(T.stack.indexOf(`
`)+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,eb.trace)(t??Fl.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,Wh.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,r,i;!((t=(e=this.callRefTimer).hasRef)===null||t===void 0)&&t.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(i=(r=this.callRefTimer).ref)===null||i===void 0||i.call(r))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(t=(e=this.callRefTimer).unref)===null||t===void 0||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(r=>r===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){(0,eb.trace)(Fl.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,Wh.uriToString)(this.target)+" "+lr.ConnectivityState[this.connectivityState]+" -> "+lr.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+lr.ConnectivityState[e]),this.connectivityState=e;let t=this.connectivityStateWatchers.slice();for(let r of t)e!==r.currentState&&(r.timer&&clearTimeout(r.timer),this.removeConnectivityStateWatcher(r),r.callback());e!==lr.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let t of this.wrappedSubchannels)t.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(lr.ConnectivityState.IDLE),this.currentPicker=new _1.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var t,r;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let s=new Date().valueOf()-this.lastActivityTimestamp.valueOf();s>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-s)},e),(r=(t=this.idleTimer).unref)===null||r===void 0||r.call(t)}maybeStartIdleTimer(){this.connectivityState!==lr.ConnectivityState.SHUTDOWN&&!this.idleTimer&&this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===Fl.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,r,i,s){let o=(0,tb.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+o+'] method="'+t+'"'),new i9.LoadBalancingCall(this,e,t,r,i,s,o)}createRetryingCall(e,t,r,i,s){let o=(0,tb.getNextCallNumber)();return this.trace("createRetryingCall ["+o+'] method="'+t+'"'),new nb.RetryingCall(this,e,t,r,i,s,o,this.retryBufferTracker,Kh.get(this.getTarget()))}createInnerCall(e,t,r,i,s){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,t,r,i,s):this.createRetryingCall(e,t,r,i,s)}createResolvingCall(e,t,r,i,s){let o=(0,tb.getNextCallNumber)();this.trace("createResolvingCall ["+o+'] method="'+e+'", deadline='+(0,s9.deadlineToString)(t));let a={deadline:t,flags:s??Fl.Propagate.DEFAULTS,host:r??this.defaultAuthority,parentCall:i},c=new o9.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),o);return this.onCallStart(),c.addStatusWatcher(l=>{this.onCallEnd(l)}),c}close(){this.resolvingLoadBalancer.destroy(),this.updateState(lr.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,Ll.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,Wh.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,r){if(this.connectivityState===lr.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let i=null;if(t!==1/0){let o=t instanceof Date?t:new Date(t),a=new Date;if(t===-1/0||o<=a){process.nextTick(r,new Error("Deadline passed without connectivity state change"));return}i=setTimeout(()=>{this.removeConnectivityStateWatcher(s),r(new Error("Deadline passed without connectivity state change"))},o.getTime()-a.getTime())}let s={currentState:e,callback:r,timer:i};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,t,r,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===lr.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,t,r,i,s)}};Qh.InternalChannel=ib});var a_=I(Yh=>{"use strict";Object.defineProperty(Yh,"__esModule",{value:!0});Yh.ChannelImplementation=void 0;var p9=Rf(),g9=b1(),sb=class{constructor(e,t,r){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof p9.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(r&&typeof r!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new g9.InternalChannel(e,t,r)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,r){this.internalChannel.watchConnectivityState(e,t,r)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,r,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,r,i,s)}};Yh.ChannelImplementation=sb});var R1=I(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.Http2ServerCallStream=vn.ServerDuplexStreamImpl=vn.ServerWritableStreamImpl=vn.ServerReadableStreamImpl=vn.ServerUnaryCallImpl=void 0;var A1=De("events"),Ca=De("http2"),cb=De("stream"),S1=De("zlib"),ke=be(),lb=Ut(),m9=NC(),N1=Ue(),Vl=Df(),M1="server_call";function Bl(n){N1.trace(ke.LogVerbosity.DEBUG,M1,n)}var y9="grpc-accept-encoding",v9="grpc-encoding",T1="grpc-message",D1="grpc-status",w1="grpc-timeout",E9=/(\d{1,8})\s*([HMSmun])/,_9={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},C9={[y9]:"identity,deflate,gzip",[v9]:"identity"},I1={[Ca.constants.HTTP2_HEADER_STATUS]:Ca.constants.HTTP_STATUS_OK,[Ca.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},b9={waitForTrailers:!0},ob=class extends A1.EventEmitter{constructor(e,t,r){super(),this.call=e,this.metadata=t,this.request=r,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};vn.ServerUnaryCallImpl=ob;var Zh=class extends cb.Readable{constructor(e,t,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=r,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,i)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};vn.ServerReadableStreamImpl=Zh;var Ul=class extends cb.Writable{constructor(e,t,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.request=i,this.cancelled=!1,this.trailingMetadata=new lb.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,r){try{let i=this.call.serializeMessage(e);if(!this.call.write(i)){this.call.once("drain",r);return}}catch(i){this.emit("error",{details:(0,Vl.getErrorMessage)(i),code:ke.Status.INTERNAL})}r()}_final(e){this.call.sendStatus({code:ke.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};vn.ServerWritableStreamImpl=Ul;var ba=class extends cb.Duplex{constructor(e,t,r,i,s){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.deserialize=i,this.cancelled=!1,this.trailingMetadata=new lb.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",o=>{this.call.sendError(o),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};vn.ServerDuplexStreamImpl=ba;ba.prototype._read=Zh.prototype._read;ba.prototype._write=Ul.prototype._write;ba.prototype._final=Ul.prototype._final;var ab=class extends A1.EventEmitter{constructor(e,t,r){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=ke.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=ke.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",i=>{}),this.stream.once("close",()=>{var i;Bl("Request to method "+((i=this.handler)===null||i===void 0?void 0:i.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:ke.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in r&&(this.maxSendMessageSize=r["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in r&&(this.maxReceiveMessageSize=r["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){let r=e.subarray(5);if(t==="identity")return r;if(t==="deflate"||t==="gzip"){let i;return t==="deflate"?i=S1.createInflate():i=S1.createGunzip(),new Promise((s,o)=>{let a=0,c=[];i.on("data",l=>{c.push(l),a+=l.byteLength,this.maxReceiveMessageSize!==-1&&a>this.maxReceiveMessageSize&&(i.destroy(),o({code:ke.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),i.on("end",()=>{s(Buffer.concat(c))}),i.write(r),i.end()})}else return Promise.reject({code:ke.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,r=Object.assign(Object.assign(Object.assign({},I1),C9),t);this.stream.respond(r,b9)}receiveMetadata(e){let t=lb.Metadata.fromHttp2Headers(e);N1.isTracerEnabled(M1)&&Bl("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let r=t.get(w1);if(r.length>0){let i=r[0].toString().match(E9);if(i===null){let a=new Error("Invalid deadline");return a.code=ke.Status.OUT_OF_RANGE,this.sendError(a),t}let s=+i[1]*_9[i[2]]|0,o=new Date;this.deadline=o.setMilliseconds(o.getMilliseconds()+s),this.deadlineTimer=setTimeout(S9,s,this),t.remove(w1)}return t.remove(Ca.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(Ca.constants.HTTP2_HEADER_TE),t.remove(Ca.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,r)=>{let{stream:i}=this,s=0,o=this,a=[],c=this.maxReceiveMessageSize;this.stream.on("data",l),this.stream.on("end",u),this.stream.on("error",u);function l(d){if(s+=d.byteLength,c!==-1&&s>c){i.removeListener("data",l),i.removeListener("end",u),i.removeListener("error",u),r({code:ke.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${s} vs. ${c})`});return}a.push(d)}function u(d){if(i.removeListener("data",l),i.removeListener("end",u),i.removeListener("error",u),d!==void 0){r({code:ke.Status.INTERNAL,details:d.message});return}if(s===0){r({code:ke.Status.INTERNAL,details:"received empty unary message"});return}o.emit("receiveMessage");let f=Buffer.concat(a,s),_=f.readUInt8(0)===1?e:"identity",b=o.getDecompressedMessage(f,_);if(Buffer.isBuffer(b)){t(o.deserializeMessageWithInternalError(b));return}b.then(T=>t(o.deserializeMessageWithInternalError(T)),T=>r(T.code?T:{code:ke.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}})}async deserializeMessageWithInternalError(e){try{return this.deserializeMessage(e)}catch(t){throw{details:(0,Vl.getErrorMessage)(t),code:ke.Status.INTERNAL}}}serializeMessage(e){let t=this.handler.serialize(e),r=t.byteLength,i=Buffer.allocUnsafe(r+5);return i.writeUInt8(0,0),i.writeUInt32BE(r,1),t.copy(i,5),i}deserializeMessage(e){return this.handler.deserialize(e)}async sendUnaryMessage(e,t,r,i){if(!this.checkCancelled()){if(r===void 0&&(r=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&r&&(e.metadata=r),this.sendError(e);return}try{let s=this.serializeMessage(t);this.write(s),this.sendStatus({code:ke.Status.OK,details:"OK",metadata:r})}catch(s){this.sendError({details:(0,Vl.getErrorMessage)(s),code:ke.Status.INTERNAL})}}}sendStatus(e){var t,r;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===ke.Status.OK),!this.checkCancelled())if(Bl("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+ke.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var i;let s=Object.assign({[D1]:e.code,[T1]:encodeURI(e.details)},(i=e.metadata)===null||i===void 0?void 0:i.toHttp2Headers());this.stream.sendTrailers(s),this.statusSent=!0}),this.stream.end());else{let i=Object.assign(Object.assign({[D1]:e.code,[T1]:encodeURI(e.details)},I1),(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.respond(i,{endStream:!0}),this.statusSent=!0}}sendError(e){let t={code:ke.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&typeof e.details=="string"&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:ke.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let r=new m9.StreamDecoder(this.maxReceiveMessageSize),i=!1,s=!1,o=!1,a=async()=>{!o&&i&&!s&&(o=!0,await this.pushOrBufferMessage(e,null))};this.stream.on("data",async c=>{let l;try{l=r.write(c)}catch(u){this.sendError({code:ke.Status.RESOURCE_EXHAUSTED,details:u.message});return}s=!0,this.stream.pause();for(let u of l){this.emit("receiveMessage");let f=u.readUInt8(0)===1?t:"identity",h;try{h=await this.getDecompressedMessage(u,f)}catch(_){this.sendError(_);return}if(!h)return;await this.pushOrBufferMessage(e,h)}s=!1,this.stream.resume(),await a()}),this.stream.once("end",async()=>{i=!0,await a()})}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),r=e.push(t);if(t===null||r===!1){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(e,t){this.isPushPending?this.bufferedMessages.push(t):await this.pushMessage(e,t)}async pushMessage(e,t){if(t===null){Bl("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}Bl("Received message of length "+t.length),this.isPushPending=!0;try{let r=await this.deserializeMessage(t);this.canPush?e.push(r)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(r)}catch(r){this.bufferedMessages.length=0;let i=(0,Vl.getErrorCode)(r);(i===null||i<ke.Status.OK||i>ke.Status.UNAUTHENTICATED)&&(i=ke.Status.INTERNAL),e.emit("error",{details:(0,Vl.getErrorMessage)(r),code:i})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(e,this.bufferedMessages.shift())}getPeer(){var e;let t=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return t?.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};vn.Http2ServerCallStream=ab;function S9(n){let e=new Error("Deadline exceeded");e.code=ke.Status.DEADLINE_EXCEEDED,n.sendError(e),n.cancelled=!0,n.emit("cancelled","deadline")}});var fb=I(Jh=>{"use strict";Object.defineProperty(Jh,"__esModule",{value:!0});Jh.ServerCredentials=void 0;var x1=RE(),jl=class{static createInsecure(){return new ub}static createSsl(e,t,r=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw new TypeError("keyCertPairs must be an array");if(typeof r!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let i=[],s=[];for(let o=0;o<t.length;o++){let a=t[o];if(a===null||typeof a!="object")throw new TypeError(`keyCertPair[${o}] must be an object`);if(!Buffer.isBuffer(a.private_key))throw new TypeError(`keyCertPair[${o}].private_key must be a Buffer`);if(!Buffer.isBuffer(a.cert_chain))throw new TypeError(`keyCertPair[${o}].cert_chain must be a Buffer`);i.push(a.cert_chain),s.push(a.private_key)}return new db({ca:e||(0,x1.getDefaultRootsData)()||void 0,cert:i,key:s,requestCert:r,ciphers:x1.CIPHER_SUITES})}};Jh.ServerCredentials=jl;var ub=class extends jl{_isSecure(){return!1}_getSettings(){return null}},db=class extends jl{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var P1=I(tp=>{"use strict";Object.defineProperty(tp,"__esModule",{value:!0});tp.Server=void 0;var Mi=De("http2"),Vr=be(),ks=R1(),T9=fb(),O1=Qn(),Xh=Ue(),xn=Zn(),D9=Qt(),Ht=xs(),ep=~(1<<31),w9=~(1<<31),I9=2e4,{HTTP2_HEADER_PATH:k1}=Mi.constants,A9="server";function N9(){}function hb(n){return{code:Vr.Status.UNIMPLEMENTED,details:`The server does not implement the method ${n}`}}function M9(n,e){let t=hb(e);switch(n){case"unary":return(r,i)=>{i(t,null)};case"clientStream":return(r,i)=>{i(t,null)};case"serverStream":return r=>{r.emit("error",t)};case"bidi":return r=>{r.emit("error",t)};default:throw new Error(`Invalid handlerType ${n}`)}}var pb=class{constructor(e){var t,r,i,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new Ht.ChannelzTrace,this.callTracker=new Ht.ChannelzCallTracker,this.listenerChildrenTracker=new Ht.ChannelzChildrenTracker,this.sessionChildrenTracker=new Ht.ChannelzChildrenTracker,this.options=e??{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,Ht.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(t=this.options["grpc.max_connection_age_ms"])!==null&&t!==void 0?t:ep,this.maxConnectionAgeGraceMs=(r=this.options["grpc.max_connection_age_grace_ms"])!==null&&r!==void 0?r:ep,this.keepaliveTimeMs=(i=this.options["grpc.keepalive_time_ms"])!==null&&i!==void 0?i:w9,this.keepaliveTimeoutMs=(s=this.options["grpc.keepalive_timeout_ms"])!==null&&s!==void 0?s:I9,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,r,i;let s=this.sessions.get(e),o=e.socket,a=o.remoteAddress?(0,xn.stringToSubchannelAddress)(o.remoteAddress,o.remotePort):null,c=o.localAddress?(0,xn.stringToSubchannelAddress)(o.localAddress,o.localPort):null,l;if(e.encrypted){let d=o,f=d.getCipher(),h=d.getCertificate(),_=d.getPeerCertificate();l={cipherSuiteStandardName:(t=f.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:f.standardName?null:f.name,localCertificate:h&&"raw"in h?h.raw:null,remoteCertificate:_&&"raw"in _?_.raw:null}}else l=null;return{remoteAddress:a,localAddress:c,security:l,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(r=e.state.localWindowSize)!==null&&r!==void 0?r:null,remoteFlowControlWindow:(i=e.state.remoteWindowSize)!==null&&i!==void 0?i:null}}}trace(e){Xh.trace(Vr.LogVerbosity.DEBUG,A9,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!="object"||t===null||typeof t!="object")throw new Error("addService() requires two objects as arguments");let r=Object.keys(e);if(r.length===0)throw new Error("Cannot add an empty service to a server");r.forEach(i=>{let s=e[i],o;s.requestStream?s.responseStream?o="bidi":o="clientStream":s.responseStream?o="serverStream":o="unary";let a=t[i],c;if(a===void 0&&typeof s.originalName=="string"&&(a=t[s.originalName]),a!==void 0?c=a.bind(t):c=M9(o,i),this.register(s.path,c,s.responseSerialize,s.requestDeserialize,o)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(r=>{let i=e[r];this.unregister(i.path)})}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,r){if(this.started===!0)throw new Error("server is already started");if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof e!="string")throw new TypeError("port must be a string");if(t===null||!(t instanceof T9.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof r!="function")throw new TypeError("callback must be a function");let i=(0,D9.parseUri)(e);if(i===null)throw new Error(`Could not parse port "${e}"`);let s=(0,O1.mapUriDefaultScheme)(i);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let o={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?o.maxSessionMemory=this.options["grpc-node.max_session_memory"]:o.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(o.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let a=(h,_)=>{process.nextTick(()=>r(h,_))},c=()=>{let h;if(t._isSecure()){let _=Object.assign(o,t._getSettings());_.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,h=Mi.createSecureServer(_),h.on("secureConnection",b=>{b.on("error",T=>{this.trace("An incoming TLS connection closed with error: "+T.message)})})}else h=Mi.createServer(o);return h.setTimeout(0,N9),this._setupHandlers(h),h},l=(h,_,b)=>h.length===0?Promise.resolve({port:_,count:b}):Promise.all(h.map(T=>{this.trace("Attempting to bind "+(0,xn.subchannelAddressToString)(T));let D;(0,xn.isTcpSubchannelAddress)(T)?D={host:T.host,port:_}:D=T;let k=c();return new Promise((P,w)=>{let q=z=>{this.trace("Failed to bind "+(0,xn.subchannelAddressToString)(T)+" with error "+z.message),P(z)};k.once("error",q),k.listen(D,()=>{if(this.shutdown){k.close(),P(new Error("bindAsync failed because server is shutdown"));return}let z=k.address(),C;typeof z=="string"?C={path:z}:C={host:z.address,port:z.port};let y=(0,Ht.registerChannelzSocket)((0,xn.subchannelAddressToString)(C),()=>({localAddress:C,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(y),this.http2ServerList.push({server:k,channelzRef:y}),this.trace("Successfully bound "+(0,xn.subchannelAddressToString)(C)),P("port"in C?C.port:_),k.removeListener("error",q)})})})).then(T=>{let D=0;for(let k of T)if(typeof k=="number"&&(D+=1,k!==_))throw new Error("Invalid state: multiple port numbers added from single address");return{port:_,count:D+b}}),u=h=>{if(h.length===0)return Promise.resolve({port:0,count:0});let _=h[0],b=c();return new Promise((T,D)=>{let k=P=>{this.trace("Failed to bind "+(0,xn.subchannelAddressToString)(_)+" with error "+P.message),T(u(h.slice(1)))};b.once("error",k),b.listen(_,()=>{if(this.shutdown){b.close(),T({port:0,count:0});return}let P=b.address(),w={host:P.address,port:P.port},q=(0,Ht.registerChannelzSocket)((0,xn.subchannelAddressToString)(w),()=>({localAddress:w,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(q),this.http2ServerList.push({server:b,channelzRef:q}),this.trace("Successfully bound "+(0,xn.subchannelAddressToString)(w)),T(l(h.slice(1),P.port,1)),b.removeListener("error",k)})})},d={onSuccessfulResolution:(h,_,b)=>{if(d.onSuccessfulResolution=()=>{},this.shutdown&&a(new Error("bindAsync failed because server is shutdown"),0),h.length===0){a(new Error(`No addresses resolved for port ${e}`),0);return}let T;(0,xn.isTcpSubchannelAddress)(h[0])?h[0].port===0?T=u(h):T=l(h,h[0].port,0):T=l(h,1,0),T.then(D=>{if(D.count===0){let k=`No address added out of total ${h.length} resolved`;Xh.log(Vr.LogVerbosity.ERROR,k),a(new Error(k),0)}else D.count<h.length&&Xh.log(Vr.LogVerbosity.INFO,`WARNING Only ${D.count} addresses added out of total ${h.length} resolved`),a(null,D.port)},D=>{let k=`No address added out of total ${h.length} resolved`;Xh.log(Vr.LogVerbosity.ERROR,k),a(new Error(k),0)})},onError:h=>{a(new Error(h.details),0)}};(0,O1.createResolver)(s,d,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,Ht.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy(Mi.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,Ht.unregisterChannelzRef)(this.channelzRef)}register(e,t,r,i,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:t,serialize:r,deserialize:i,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=s=>{this.channelzEnabled&&(0,Ht.unregisterChannelzRef)(this.channelzRef),e(s)},r=0;function i(){r--,r===0&&t()}this.started=!1,this.shutdown=!0;for(let{server:s,channelzRef:o}of this.http2ServerList)s.listening&&(r++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(o),(0,Ht.unregisterChannelzRef)(o)),i()}));this.sessions.forEach((s,o)=>{o.closed||(r+=1,o.close(i))}),r===0&&t()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let r=t[Mi.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof r!="string"||!r.startsWith("application/grpc")?(e.respond({[Mi.constants.HTTP2_HEADER_STATUS]:Mi.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return t===void 0?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,r=null){let i=new ks.Http2ServerCallStream(t,null,this.options);e.code===void 0&&(e.code=Vr.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed()),i.sendError(e)}_channelzHandler(e,t){let r=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),r?.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed();return}let i=t[k1],s=this._retrieveHandler(i);if(!s){this._respondWithError(hb(i),e,r);return}let o=new ks.Http2ServerCallStream(e,s,this.options);o.once("callEnd",a=>{a===Vr.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),r&&(o.once("streamEnd",a=>{a?r.streamTracker.addCallSucceeded():r.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{r.messagesSent+=1,r.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{r.messagesReceived+=1,r.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,s,t)||(this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed(),o.sendError({code:Vr.Status.INTERNAL,details:`Unknown handler type: ${s.type}`}))}_streamHandler(e,t){if(this._verifyContentType(e,t)!==!0)return;let r=t[k1],i=this._retrieveHandler(r);if(!i){this._respondWithError(hb(r),e,null);return}let s=new ks.Http2ServerCallStream(e,i,this.options);this._runHandlerForCall(s,i,t)||s.sendError({code:Vr.Status.INTERNAL,details:`Unknown handler type: ${i.type}`})}_runHandlerForCall(e,t,r){var i;let s=e.receiveMetadata(r),o=(i=s.get("grpc-encoding")[0])!==null&&i!==void 0?i:"identity";s.remove("grpc-encoding");let{type:a}=t;if(a==="unary")R9(e,t,s,o);else if(a==="clientStream")x9(e,t,s,o);else if(a==="serverStream")O9(e,t,s,o);else if(a==="bidi")k9(e,t,s,o);else return!1;return!0}_setupHandlers(e){if(e===null)return;let t=e.address(),r="null";t&&(typeof t=="string"?r=t:r=t.address+":"+t.port),this.serverAddressString=r;let i=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",i.bind(this)),e.on("session",s=>{var o,a,c,l,u;if(!this.started){s.destroy();return}let d=(0,Ht.registerChannelzSocket)((o=s.socket.remoteAddress)!==null&&o!==void 0?o:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled),f={ref:d,streamTracker:new Ht.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,f);let h=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+h),this.sessionChildrenTracker.refChild(d));let _=null,b=null,T=!1;if(this.maxConnectionAgeMs!==ep){let k=this.maxConnectionAgeMs/10,P=Math.random()*k*2-k;_=(c=(a=setTimeout(()=>{var w,q;T=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+h);try{s.goaway(Mi.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==ep&&(b=(q=(w=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs)).unref)===null||q===void 0?void 0:q.call(w))},this.maxConnectionAgeMs+P)).unref)===null||c===void 0?void 0:c.call(a)}let D=(u=(l=setInterval(()=>{var k,P;let w=(P=(k=setTimeout(()=>{T=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+h),s.close()},this.keepaliveTimeoutMs)).unref)===null||P===void 0?void 0:P.call(k);try{s.ping((q,z,C)=>{clearTimeout(w)})}catch{s.destroy()}},this.keepaliveTimeMs)).unref)===null||u===void 0?void 0:u.call(l);s.on("close",()=>{this.channelzEnabled&&(T||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+h),this.sessionChildrenTracker.unrefChild(d),(0,Ht.unregisterChannelzRef)(d)),_&&clearTimeout(_),b&&clearTimeout(b),D&&clearTimeout(D),this.sessions.delete(s)})})}};tp.Server=pb;async function R9(n,e,t,r){try{let i=await n.receiveUnaryMessage(r);if(i===void 0||n.cancelled)return;let s=new ks.ServerUnaryCallImpl(n,t,i);e.func(s,(o,a,c,l)=>{n.sendUnaryMessage(o,a,c,l)})}catch(i){n.sendError(i)}}function x9(n,e,t,r){let i=new ks.ServerReadableStreamImpl(n,t,e.deserialize,r);function s(o,a,c,l){i.destroy(),n.sendUnaryMessage(o,a,c,l)}n.cancelled||(i.on("error",s),e.func(i,s))}async function O9(n,e,t,r){try{let i=await n.receiveUnaryMessage(r);if(i===void 0||n.cancelled)return;let s=new ks.ServerWritableStreamImpl(n,t,e.serialize,i);e.func(s)}catch(i){n.sendError(i)}}function k9(n,e,t,r){let i=new ks.ServerDuplexStreamImpl(n,t,e.serialize,e.deserialize,r);n.cancelled||e.func(i)}});var F1=I(np=>{"use strict";Object.defineProperty(np,"__esModule",{value:!0});np.StatusBuilder=void 0;var gb=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};np.StatusBuilder=gb});var mb=I(Ri=>{"use strict";Object.defineProperty(Ri,"__esModule",{value:!0});Ri.isDuration=Ri.durationToMs=Ri.msToDuration=void 0;function P9(n){return{seconds:n/1e3|0,nanos:n%1e3*1e6|0}}Ri.msToDuration=P9;function F9(n){return n.seconds*1e3+n.nanos/1e6|0}Ri.durationToMs=F9;function L9(n){return typeof n.seconds=="number"&&typeof n.nanos=="number"}Ri.isDuration=L9});var Tb=I(xi=>{"use strict";var yb;Object.defineProperty(xi,"__esModule",{value:!0});xi.setup=xi.OutlierDetectionLoadBalancer=xi.OutlierDetectionLoadBalancingConfig=void 0;var ip=dn(),B1=be(),Ps=mb(),V1=Db(),U1=li(),B9=Bf(),V9=hi(),L1=Zn(),U9=Gh(),j9=Ue(),q9="outlier_detection";function lt(n){j9.trace(B1.LogVerbosity.DEBUG,q9,n)}var Sb="outlier_detection",H9=((yb=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&yb!==void 0?yb:"true")==="true",$9={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},z9={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function Sa(n,e,t,r){if(e in n&&typeof n[e]!==t){let i=r?`${r}.${e}`:e;throw new Error(`outlier detection config ${i} parse error: expected ${t}, got ${typeof n[e]}`)}}function vb(n,e,t){let r=t?`${t}.${e}`:e;if(e in n){if(!(0,Ps.isDuration)(n[e]))throw new Error(`outlier detection config ${r} parse error: expected Duration, got ${typeof n[e]}`);if(!(n[e].seconds>=0&&n[e].seconds<=315576e6&&n[e].nanos>=0&&n[e].nanos<=999999999))throw new Error(`outlier detection config ${r} parse error: values out of range for non-negative Duaration`)}}function rp(n,e,t){let r=t?`${t}.${e}`:e;if(Sa(n,e,"number",t),e in n&&!(n[e]>=0&&n[e]<=100))throw new Error(`outlier detection config ${r} parse error: value out of range for percentage (0-100)`)}var ql=class n{constructor(e,t,r,i,s,o,a){if(this.childPolicy=a,a.length>0&&a[0].getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=t??3e4,this.maxEjectionTimeMs=r??3e5,this.maxEjectionPercent=i??10,this.successRateEjection=s?Object.assign(Object.assign({},$9),s):null,this.failurePercentageEjection=o?Object.assign(Object.assign({},z9),o):null}getLoadBalancerName(){return Sb}toJsonObject(){return{interval:(0,Ps.msToDuration)(this.intervalMs),base_ejection_time:(0,Ps.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,Ps.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new n(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(vb(e,"interval"),vb(e,"base_ejection_time"),vb(e,"max_ejection_time"),rp(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");Sa(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),rp(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),Sa(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),Sa(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");rp(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),rp(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),Sa(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),Sa(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new n(e.interval?(0,Ps.durationToMs)(e.interval):null,e.base_ejection_time?(0,Ps.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,Ps.durationToMs)(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(U1.validateLoadBalancingConfig))}};xi.OutlierDetectionLoadBalancingConfig=ql;var _b=class extends U9.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((r,i,s,o)=>{if(this.childSubchannelState=s,!this.ejected)for(let a of this.stateListeners)a(this,i,s,o)})}getConnectivityState(){return this.ejected?ip.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,ip.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,ip.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function Eb(){return{success:0,failure:0}}var Cb=class{constructor(){this.activeBucket=Eb(),this.inactiveBucket=Eb()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=Eb()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},bb=class{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType===V9.PickResultType.COMPLETE){let r=t.subchannel,i=r.getMapEntry();if(i){let s=t.onCallEnded;return this.countCalls&&(s=o=>{var a;o===B1.Status.OK?i.counter.addSuccess():i.counter.addFailure(),(a=t.onCallEnded)===null||a===void 0||a.call(t,o)}),Object.assign(Object.assign({},t),{subchannel:r.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},t),{subchannel:r.getWrappedSubchannel()})}else return t}},sp=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new B9.ChildLoadBalancerHandler((0,V1.createChildChannelControlHelper)(e,{createSubchannel:(t,r)=>{let i=e.createSubchannel(t,r),s=this.addressMap.get((0,L1.subchannelAddressToString)(t)),o=new _b(i,s);return s?.currentEjectionTimestamp!==null&&o.eject(),s?.subchannelWrappers.push(o),o},updateState:(t,r)=>{t===ip.ConnectivityState.READY?e.updateState(t,new bb(r,this.isCountingEnabled())):e.updateState(t,r)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())t.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;lt("Running success rate check");let r=t.request_volume,i=0,s=[];for(let[d,f]of this.addressMap){let h=f.counter.getLastSuccesses(),_=f.counter.getLastFailures();lt("Stats for "+d+": successes="+h+" failures="+_+" targetRequestVolume="+r),h+_>=r&&(i+=1,s.push(h/(h+_)))}if(lt("Found "+i+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),i<t.minimum_hosts)return;let o=s.reduce((d,f)=>d+f)/s.length,a=0;for(let d of s){let f=d-o;a+=f*f}let c=a/s.length,l=Math.sqrt(c),u=o-l*(t.stdev_factor/1e3);lt("stdev="+l+" ejectionThreshold="+u);for(let[d,f]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let h=f.counter.getLastSuccesses(),_=f.counter.getLastFailures();if(h+_<r)continue;let b=h/(h+_);if(lt("Checking candidate "+d+" successRate="+b),b<u){let T=Math.random()*100;lt("Candidate "+d+" randomNumber="+T+" enforcement_percentage="+t.enforcement_percentage),T<t.enforcement_percentage&&(lt("Ejecting candidate "+d),this.eject(f,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;lt("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let r=0;for(let i of this.addressMap.values()){let s=i.counter.getLastSuccesses(),o=i.counter.getLastFailures();s+o>=t.request_volume&&(r+=1)}if(!(r<t.minimum_hosts))for(let[i,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let o=s.counter.getLastSuccesses(),a=s.counter.getLastFailures();if(lt("Candidate successes="+o+" failures="+a),o+a<t.request_volume)continue;if(a*100/(a+o)>t.threshold){let l=Math.random()*100;lt("Candidate "+i+" randomNumber="+l+" enforcement_percentage="+t.enforcement_percentage),l<t.enforcement_percentage&&(lt("Ejecting candidate "+i),this.eject(s,e))}}}eject(e,t){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let r of e.subchannelWrappers)r.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let t of e.subchannelWrappers)t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,r;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(r=(t=this.ejectionTimer).unref)===null||r===void 0||r.call(t)}runChecks(){let e=new Date;if(lt("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[t,r]of this.addressMap.entries())if(r.currentEjectionTimestamp===null)r.ejectionTimeMultiplier>0&&(r.ejectionTimeMultiplier-=1);else{let i=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),o=new Date(r.currentEjectionTimestamp.getTime());o.setMilliseconds(o.getMilliseconds()+Math.min(i*r.ejectionTimeMultiplier,Math.max(i,s))),o<new Date&&(lt("Unejecting "+t),this.uneject(r))}}}updateAddressList(e,t,r){if(!(t instanceof ql))return;let i=new Set;for(let o of e)i.add((0,L1.subchannelAddressToString)(o));for(let o of i)this.addressMap.has(o)||(lt("Adding map entry for "+o),this.addressMap.set(o,{counter:new Cb,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let o of this.addressMap.keys())i.has(o)||(lt("Removing map entry for "+o),this.addressMap.delete(o));let s=(0,U1.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,r),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){lt("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let o=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(o)}else lt("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else{lt("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let o of this.addressMap.values())this.uneject(o),o.ejectionTimeMultiplier=0}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return Sb}};xi.OutlierDetectionLoadBalancer=sp;function G9(){H9&&(0,V1.registerLoadBalancerType)(Sb,sp,ql)}xi.setup=G9});var Db=I(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.OutlierDetectionLoadBalancingConfig=J.BaseSubchannelWrapper=J.registerAdminService=J.FilterStackFactory=J.BaseFilter=J.PickResultType=J.QueuePicker=J.UnavailablePicker=J.ChildLoadBalancerHandler=J.subchannelAddressToString=J.validateLoadBalancingConfig=J.getFirstUsableConfig=J.registerLoadBalancerType=J.createChildChannelControlHelper=J.BackoffTimeout=J.durationToMs=J.uriToString=J.createResolver=J.registerResolver=J.log=J.trace=void 0;var j1=Ue();Object.defineProperty(J,"trace",{enumerable:!0,get:function(){return j1.trace}});Object.defineProperty(J,"log",{enumerable:!0,get:function(){return j1.log}});var q1=Qn();Object.defineProperty(J,"registerResolver",{enumerable:!0,get:function(){return q1.registerResolver}});Object.defineProperty(J,"createResolver",{enumerable:!0,get:function(){return q1.createResolver}});var W9=Qt();Object.defineProperty(J,"uriToString",{enumerable:!0,get:function(){return W9.uriToString}});var K9=mb();Object.defineProperty(J,"durationToMs",{enumerable:!0,get:function(){return K9.durationToMs}});var Q9=al();Object.defineProperty(J,"BackoffTimeout",{enumerable:!0,get:function(){return Q9.BackoffTimeout}});var op=li();Object.defineProperty(J,"createChildChannelControlHelper",{enumerable:!0,get:function(){return op.createChildChannelControlHelper}});Object.defineProperty(J,"registerLoadBalancerType",{enumerable:!0,get:function(){return op.registerLoadBalancerType}});Object.defineProperty(J,"getFirstUsableConfig",{enumerable:!0,get:function(){return op.getFirstUsableConfig}});Object.defineProperty(J,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return op.validateLoadBalancingConfig}});var Y9=Zn();Object.defineProperty(J,"subchannelAddressToString",{enumerable:!0,get:function(){return Y9.subchannelAddressToString}});var Z9=Bf();Object.defineProperty(J,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return Z9.ChildLoadBalancerHandler}});var wb=hi();Object.defineProperty(J,"UnavailablePicker",{enumerable:!0,get:function(){return wb.UnavailablePicker}});Object.defineProperty(J,"QueuePicker",{enumerable:!0,get:function(){return wb.QueuePicker}});Object.defineProperty(J,"PickResultType",{enumerable:!0,get:function(){return wb.PickResultType}});var J9=jC();Object.defineProperty(J,"BaseFilter",{enumerable:!0,get:function(){return J9.BaseFilter}});var X9=BC();Object.defineProperty(J,"FilterStackFactory",{enumerable:!0,get:function(){return X9.FilterStackFactory}});var e5=Uf();Object.defineProperty(J,"registerAdminService",{enumerable:!0,get:function(){return e5.registerAdminService}});var t5=Gh();Object.defineProperty(J,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return t5.BaseSubchannelWrapper}});var n5=Tb();Object.defineProperty(J,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return n5.OutlierDetectionLoadBalancingConfig}})});var H1=I(ap=>{"use strict";Object.defineProperty(ap,"__esModule",{value:!0});ap.setup=void 0;var r5=Qn(),Ib=class{constructor(e,t,r){this.listener=t,this.addresses=[],this.hasReturnedResult=!1;let i;e.authority===""?i="/"+e.path:i=e.path,this.addresses=[{path:i}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}};function i5(){(0,r5.registerResolver)("unix",Ib)}ap.setup=i5});var K1=I(up=>{"use strict";Object.defineProperty(up,"__esModule",{value:!0});up.setup=void 0;var $1=De("net"),cp=be(),Ab=Ut(),z1=Qn(),G1=Qt(),s5=Ue(),o5="ip_resolver";function W1(n){s5.trace(cp.LogVerbosity.DEBUG,o5,n)}var Nb="ipv4",Mb="ipv6",a5=443,lp=class{constructor(e,t,r){var i;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,W1("Resolver constructed for target "+(0,G1.uriToString)(e));let s=[];if(!(e.scheme===Nb||e.scheme===Mb)){this.error={code:cp.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new Ab.Metadata};return}let o=e.path.split(",");for(let a of o){let c=(0,G1.splitHostPort)(a);if(c===null){this.error={code:cp.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new Ab.Metadata};return}if(e.scheme===Nb&&!(0,$1.isIPv4)(c.host)||e.scheme===Mb&&!(0,$1.isIPv6)(c.host)){this.error={code:cp.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new Ab.Metadata};return}s.push({host:c.host,port:(i=c.port)!==null&&i!==void 0?i:a5})}this.addresses=s,W1("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function c5(){(0,z1.registerResolver)(Nb,lp),(0,z1.registerResolver)(Mb,lp)}up.setup=c5});var Z1=I(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.setup=ur.PickFirstLoadBalancer=ur.shuffled=ur.PickFirstLoadBalancingConfig=void 0;var Q1=li(),wt=dn(),dp=hi(),l5=Ue(),u5=be(),d5="pick_first";function Rb(n){l5.trace(u5.LogVerbosity.DEBUG,d5,n)}var Hl="pick_first",f5=250,$l=class n{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return Hl}toJsonObject(){return{[Hl]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new n(e.shuffleAddressList===!0)}};ur.PickFirstLoadBalancingConfig=$l;var xb=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:dp.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function Y1(n){let e=n.slice();for(let t=e.length-1;t>1;t--){let r=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[r],e[r]=i}return e}ur.shuffled=Y1;var fp=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=wt.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(t,r,i,s,o)=>{this.onSubchannelStateUpdate(t,r,i,o)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(wt.ConnectivityState.READY,new xb(this.currentPick)):this.children.length===0?this.updateState(wt.ConnectivityState.IDLE,new dp.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(wt.ConnectivityState.TRANSIENT_FAILURE,new dp.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(wt.ConnectivityState.CONNECTING,new dp.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,r,i){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){r!==wt.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[o,a]of this.children.entries())if(e.realSubchannelEquals(a.subchannel)){r===wt.ConnectivityState.READY&&this.pickSubchannel(a.subchannel),r===wt.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0,i&&(this.lastError=i),this.maybeEnterStickyTransientFailureMode(),o===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(o+1)),a.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,r]of this.children.entries())if(t>=e){let i=r.subchannel.getConnectivityState();if(i===wt.ConnectivityState.IDLE||i===wt.ConnectivityState.CONNECTING){this.startConnecting(t);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,r;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===wt.ConnectivityState.IDLE&&(Rb("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var i;(i=this.children[e])===null||i===void 0||i.subchannel.startConnecting()})),this.connectionDelayTimeout=(r=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},f5)).unref)===null||r===void 0?void 0:r.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(Rb("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.currentPick!==null&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){Rb(wt.ConnectivityState[this.currentState]+" -> "+wt.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(r=>({subchannel:this.channelControlHelper.createSubchannel(r,{}),hasReportedTransientFailure:!1}));for(let{subchannel:r}of t)r.ref(),this.channelControlHelper.addChannelzChild(r.getChannelzRef());this.resetSubchannelList(),this.children=t;for(let{subchannel:r}of this.children)if(r.addConnectivityStateListener(this.subchannelStateListener),r.getConnectivityState()===wt.ConnectivityState.READY){this.pickSubchannel(r);return}for(let r of this.children)r.subchannel.getConnectivityState()===wt.ConnectivityState.TRANSIENT_FAILURE&&(r.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof $l&&(t.getShuffleAddressList()&&(e=Y1(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===wt.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return Hl}};ur.PickFirstLoadBalancer=fp;function h5(){(0,Q1.registerLoadBalancerType)(Hl,fp,$l),(0,Q1.registerDefaultLoadBalancerType)(Hl)}ur.setup=h5});var X1=I(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.setup=Ta.RoundRobinLoadBalancer=void 0;var p5=li(),It=dn(),hp=hi(),g5=Zn(),m5=Ue(),y5=be(),v5="round_robin";function J1(n){m5.trace(y5.LogVerbosity.DEBUG,v5,n)}var pp="round_robin",Ob=class n{getLoadBalancerName(){return pp}constructor(){}toJsonObject(){return{[pp]:{}}}static createFromJson(e){return new n}},kb=class{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:hp.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},gp=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=It.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(t,r,i,s,o)=>{this.calculateAndUpdateState(),(i===It.ConnectivityState.TRANSIENT_FAILURE||i===It.ConnectivityState.IDLE)&&(o&&(this.lastError=o),this.channelControlHelper.requestReresolution(),t.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(It.ConnectivityState.READY)>0){let e=this.subchannels.filter(r=>r.getConnectivityState()===It.ConnectivityState.READY),t=0;this.currentReadyPicker!==null&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),t<0&&(t=0)),this.updateState(It.ConnectivityState.READY,new kb(e,t))}else this.countSubchannelsWithState(It.ConnectivityState.CONNECTING)>0?this.updateState(It.ConnectivityState.CONNECTING,new hp.QueuePicker(this)):this.countSubchannelsWithState(It.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(It.ConnectivityState.TRANSIENT_FAILURE,new hp.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(It.ConnectivityState.IDLE,new hp.QueuePicker(this))}updateState(e,t){J1(It.ConnectivityState[this.currentState]+" -> "+It.ConnectivityState[e]),e===It.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList(),J1("Connect to address list "+e.map(r=>(0,g5.subchannelAddressToString)(r))),this.subchannels=e.map(r=>this.channelControlHelper.createSubchannel(r,{}));for(let r of this.subchannels){r.ref(),r.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(r.getChannelzRef());let i=r.getConnectivityState();(i===It.ConnectivityState.IDLE||i===It.ConnectivityState.TRANSIENT_FAILURE)&&r.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return pp}};Ta.RoundRobinLoadBalancer=gp;function E5(){(0,p5.registerLoadBalancerType)(pp,gp,Ob)}Ta.setup=E5});var rk=I(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.experimental=F.addAdminServicesToServer=F.getChannelzHandlers=F.getChannelzServiceDefinition=F.InterceptorConfigurationError=F.InterceptingCall=F.RequesterBuilder=F.ListenerBuilder=F.StatusBuilder=F.getClientChannel=F.ServerCredentials=F.Server=F.setLogVerbosity=F.setLogger=F.load=F.loadObject=F.CallCredentials=F.ChannelCredentials=F.waitForClientReady=F.closeClient=F.Channel=F.makeGenericClientConstructor=F.makeClientConstructor=F.loadPackageDefinition=F.Client=F.compressionAlgorithms=F.propagate=F.connectivityState=F.status=F.logVerbosity=F.Metadata=F.credentials=void 0;var mp=NE();Object.defineProperty(F,"CallCredentials",{enumerable:!0,get:function(){return mp.CallCredentials}});var _5=a_();Object.defineProperty(F,"Channel",{enumerable:!0,get:function(){return _5.ChannelImplementation}});var C5=VC();Object.defineProperty(F,"compressionAlgorithms",{enumerable:!0,get:function(){return C5.CompressionAlgorithms}});var b5=dn();Object.defineProperty(F,"connectivityState",{enumerable:!0,get:function(){return b5.ConnectivityState}});var yp=Rf();Object.defineProperty(F,"ChannelCredentials",{enumerable:!0,get:function(){return yp.ChannelCredentials}});var ek=o_();Object.defineProperty(F,"Client",{enumerable:!0,get:function(){return ek.Client}});var Pb=be();Object.defineProperty(F,"logVerbosity",{enumerable:!0,get:function(){return Pb.LogVerbosity}});Object.defineProperty(F,"status",{enumerable:!0,get:function(){return Pb.Status}});Object.defineProperty(F,"propagate",{enumerable:!0,get:function(){return Pb.Propagate}});var tk=Ue(),Fb=l_();Object.defineProperty(F,"loadPackageDefinition",{enumerable:!0,get:function(){return Fb.loadPackageDefinition}});Object.defineProperty(F,"makeClientConstructor",{enumerable:!0,get:function(){return Fb.makeClientConstructor}});Object.defineProperty(F,"makeGenericClientConstructor",{enumerable:!0,get:function(){return Fb.makeClientConstructor}});var S5=Ut();Object.defineProperty(F,"Metadata",{enumerable:!0,get:function(){return S5.Metadata}});var T5=P1();Object.defineProperty(F,"Server",{enumerable:!0,get:function(){return T5.Server}});var D5=fb();Object.defineProperty(F,"ServerCredentials",{enumerable:!0,get:function(){return D5.ServerCredentials}});var w5=F1();Object.defineProperty(F,"StatusBuilder",{enumerable:!0,get:function(){return w5.StatusBuilder}});F.credentials={combineChannelCredentials:(n,...e)=>e.reduce((t,r)=>t.compose(r),n),combineCallCredentials:(n,...e)=>e.reduce((t,r)=>t.compose(r),n),createInsecure:yp.ChannelCredentials.createInsecure,createSsl:yp.ChannelCredentials.createSsl,createFromSecureContext:yp.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:mp.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:mp.CallCredentials.createFromGoogleCredential,createEmpty:mp.CallCredentials.createEmpty};var I5=n=>n.close();F.closeClient=I5;var A5=(n,e,t)=>n.waitForReady(e,t);F.waitForClientReady=A5;var N5=(n,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};F.loadObject=N5;var M5=(n,e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};F.load=M5;var R5=n=>{tk.setLogger(n)};F.setLogger=R5;var x5=n=>{tk.setLoggerVerbosity(n)};F.setLogVerbosity=x5;var O5=n=>ek.Client.prototype.getChannel.call(n);F.getClientChannel=O5;var vp=r_();Object.defineProperty(F,"ListenerBuilder",{enumerable:!0,get:function(){return vp.ListenerBuilder}});Object.defineProperty(F,"RequesterBuilder",{enumerable:!0,get:function(){return vp.RequesterBuilder}});Object.defineProperty(F,"InterceptingCall",{enumerable:!0,get:function(){return vp.InterceptingCall}});Object.defineProperty(F,"InterceptorConfigurationError",{enumerable:!0,get:function(){return vp.InterceptorConfigurationError}});var nk=xs();Object.defineProperty(F,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return nk.getChannelzServiceDefinition}});Object.defineProperty(F,"getChannelzHandlers",{enumerable:!0,get:function(){return nk.getChannelzHandlers}});var k5=Uf();Object.defineProperty(F,"addAdminServicesToServer",{enumerable:!0,get:function(){return k5.addAdminServicesToServer}});var P5=Db();F.experimental=P5;var F5=wC(),L5=H1(),B5=K1(),V5=Z1(),U5=X1(),j5=Tb(),q5=xs();F5.setup(),L5.setup(),B5.setup(),V5.setup(),U5.setup(),j5.setup(),q5.setup()});var pg;function fu(){return pg}function Vn(n){let e=pg;return pg=n,e}var GT=Symbol("NotFound");function Qs(n){return n===GT||n?.name==="\u0275NotFound"}function yu(n,e){return Object.is(n,e)}var Et=null,hu=!1,gg=1,DF=null,_t=Symbol("SIGNAL");function ee(n){let e=Et;return Et=n,e}function vu(){return Et}var Ys={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Zs(n){if(hu)throw new Error("");if(Et===null)return;Et.consumerOnSignalRead(n);let e=Et.producersTail;if(e!==void 0&&e.producer===n)return;let t,r=Et.recomputing;if(r&&(t=e!==void 0?e.nextProducer:Et.producers,t!==void 0&&t.producer===n)){Et.producersTail=t,t.lastReadVersion=n.version;return}let i=n.consumersTail;if(i!==void 0&&i.consumer===Et&&(!r||IF(i,Et)))return;let s=Xs(Et),o={producer:n,consumer:Et,nextProducer:t,prevConsumer:i,lastReadVersion:n.version,nextConsumer:void 0};Et.producersTail=o,e!==void 0?e.nextProducer=o:Et.producers=o,s&&KT(n,o)}function WT(){gg++}function Eu(n){if(!(Xs(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===gg)){if(!n.producerMustRecompute(n)&&!tc(n)){mu(n);return}n.producerRecomputeValue(n),mu(n)}}function mg(n){if(n.consumers===void 0)return;let e=hu;hu=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||wF(r)}}finally{hu=e}}function yg(){return Et?.consumerAllowSignalWrites!==!1}function wF(n){n.dirty=!0,mg(n),n.consumerMarkedDirty?.(n)}function mu(n){n.dirty=!1,n.lastCleanEpoch=gg}function Js(n){return n&&(n.producersTail=void 0,n.recomputing=!0),ee(n)}function ec(n,e){if(ee(e),!n)return;n.recomputing=!1;let t=n.producersTail,r=t!==void 0?t.nextProducer:n.producers;if(r!==void 0){if(Xs(n))do r=vg(r);while(r!==void 0);t!==void 0?t.nextProducer=void 0:n.producers=void 0}}function tc(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,r=e.lastReadVersion;if(r!==t.version||(Eu(t),r!==t.version))return!0}return!1}function nc(n){if(Xs(n)){let e=n.producers;for(;e!==void 0;)e=vg(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function KT(n,e){let t=n.consumersTail,r=Xs(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!r)for(let i=n.producers;i!==void 0;i=i.nextProducer)KT(i.producer,i)}function vg(n){let e=n.producer,t=n.nextProducer,r=n.nextConsumer,i=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,r!==void 0?r.prevConsumer=i:e.consumersTail=i,i!==void 0)i.nextConsumer=r;else if(e.consumers=r,!Xs(e)){let s=e.producers;for(;s!==void 0;)s=vg(s)}return t}function Xs(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function _u(n){DF?.(n)}function IF(n,e){let t=e.producersTail;if(t!==void 0){let r=e.producers;do{if(r===n)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function Cu(n,e){let t=Object.create(AF);t.computation=n,e!==void 0&&(t.equal=e);let r=()=>{if(Eu(t),Zs(t),t.value===Xa)throw t.error;return t.value};return r[_t]=t,_u(t),r}var pu=Symbol("UNSET"),gu=Symbol("COMPUTING"),Xa=Symbol("ERRORED"),AF=Ce(K({},Ys),{value:pu,dirty:!0,error:null,equal:yu,kind:"computed",producerMustRecompute(n){return n.value===pu||n.value===gu},producerRecomputeValue(n){if(n.value===gu)throw new Error("");let e=n.value;n.value=gu;let t=Js(n),r,i=!1;try{r=n.computation(),ee(null),i=e!==pu&&e!==Xa&&r!==Xa&&n.equal(e,r)}catch(s){r=Xa,n.error=s}finally{ec(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function NF(){throw new Error}var QT=NF;function YT(n){QT(n)}function Eg(n){QT=n}var MF=null;function _g(n,e){let t=Object.create(bu);t.value=n,e!==void 0&&(t.equal=e);let r=()=>ZT(t);return r[_t]=t,_u(t),[r,o=>eo(t,o),o=>Cg(t,o)]}function ZT(n){return Zs(n),n.value}function eo(n,e){yg()||YT(n),n.equal(n.value,e)||(n.value=e,RF(n))}function Cg(n,e){yg()||YT(n),eo(n,e(n.value))}var bu=Ce(K({},Ys),{equal:yu,value:void 0,kind:"signal"});function RF(n){n.version++,WT(),mg(n),MF?.(n)}function te(n){return typeof n=="function"}function to(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Su=to(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function rc(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var rt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(te(r))try{r()}catch(s){e=s instanceof Su?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{JT(s)}catch(o){e=e??[],o instanceof Su?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Su(e)}}add(e){var t;if(e&&e!==this)if(this.closed)JT(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&rc(t,e)}remove(e){let{_finalizers:t}=this;t&&rc(t,e),e instanceof n&&e._removeParent(this)}};rt.EMPTY=(()=>{let n=new rt;return n.closed=!0,n})();var bg=rt.EMPTY;function Tu(n){return n instanceof rt||n&&"closed"in n&&te(n.remove)&&te(n.add)&&te(n.unsubscribe)}function JT(n){te(n)?n():n.unsubscribe()}var _n={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var no={setTimeout(n,e,...t){let{delegate:r}=no;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=no;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Du(n){no.setTimeout(()=>{let{onUnhandledError:e}=_n;if(e)e(n);else throw n})}function ic(){}var XT=Sg("C",void 0,void 0);function eD(n){return Sg("E",void 0,n)}function tD(n){return Sg("N",n,void 0)}function Sg(n,e,t){return{kind:n,value:e,error:t}}var ji=null;function ro(n){if(_n.useDeprecatedSynchronousErrorHandling){let e=!ji;if(e&&(ji={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=ji;if(ji=null,t)throw r}}else n()}function nD(n){_n.useDeprecatedSynchronousErrorHandling&&ji&&(ji.errorThrown=!0,ji.error=n)}var qi=class extends rt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Tu(e)&&e.add(this)):this.destination=kF}static create(e,t,r){return new io(e,t,r)}next(e){this.isStopped?Dg(tD(e),this):this._next(e)}error(e){this.isStopped?Dg(eD(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Dg(XT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},xF=Function.prototype.bind;function Tg(n,e){return xF.call(n,e)}var wg=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){wu(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){wu(r)}else wu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){wu(t)}}},io=class extends qi{constructor(e,t,r){super();let i;if(te(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&_n.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Tg(e.next,s),error:e.error&&Tg(e.error,s),complete:e.complete&&Tg(e.complete,s)}):i=e}this.destination=new wg(i)}};function wu(n){_n.useDeprecatedSynchronousErrorHandling?nD(n):Du(n)}function OF(n){throw n}function Dg(n,e){let{onStoppedNotification:t}=_n;t&&no.setTimeout(()=>t(n,e))}var kF={closed:!0,next:ic,error:OF,complete:ic};var so=typeof Symbol=="function"&&Symbol.observable||"@@observable";function zt(n){return n}function PF(...n){return Ig(n)}function Ig(n){return n.length===0?zt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ye=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=LF(t)?t:new io(t,r,i);return ro(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=rD(r),new r((i,s)=>{let o=new io({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[so](){return this}pipe(...t){return Ig(t)(this)}toPromise(t){return t=rD(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function rD(n){var e;return(e=n??_n.Promise)!==null&&e!==void 0?e:Promise}function FF(n){return n&&te(n.next)&&te(n.error)&&te(n.complete)}function LF(n){return n&&n instanceof qi||FF(n)&&Tu(n)}function Ag(n){return te(n?.lift)}function fe(n){return e=>{if(Ag(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ce(n,e,t,r,i){return new Ng(n,e,t,r,i)}var Ng=class extends qi{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Mg(){return fe((n,e)=>{let t=null;n._refCount++;let r=ce(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Rg=class extends ye{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ag(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new rt;let t=this.getSubject();e.add(this.source.subscribe(ce(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=rt.EMPTY)}return e}refCount(){return Mg()(this)}};var iD=to(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Cn=(()=>{class n extends ye{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Iu(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new iD}next(t){ro(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){ro(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){ro(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?bg:(this.currentObservers=null,s.push(t),new rt(()=>{this.currentObservers=null,rc(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new ye;return t.source=this,t}}return n.create=(e,t)=>new Iu(e,t),n})(),Iu=class extends Cn{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:bg}};var sc=class extends Cn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var oc=new ye(n=>n.complete());function sD(n){return n&&te(n.schedule)}function oD(n){return n[n.length-1]}function Au(n){return te(oD(n))?n.pop():void 0}function Gr(n){return sD(oD(n))?n.pop():void 0}function nX(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function cD(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function aD(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Hi(n){return this instanceof Hi?(this.v=n,this):new Hi(n)}function lD(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(h){return function(_){return Promise.resolve(_).then(h,d)}}function a(h,_){r[h]&&(i[h]=function(b){return new Promise(function(T,D){s.push([h,b,T,D])>1||c(h,b)})},_&&(i[h]=_(i[h])))}function c(h,_){try{l(r[h](_))}catch(b){f(s[0][3],b)}}function l(h){h.value instanceof Hi?Promise.resolve(h.value.v).then(u,d):f(s[0][2],h)}function u(h){c("next",h)}function d(h){c("throw",h)}function f(h,_){h(_),s.shift(),s.length&&c(s[0][0],s[0][1])}}function uD(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof aD=="function"?aD(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Nu=n=>n&&typeof n.length=="number"&&typeof n!="function";function Mu(n){return te(n?.then)}function Ru(n){return te(n[so])}function xu(n){return Symbol.asyncIterator&&te(n?.[Symbol.asyncIterator])}function Ou(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function BF(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ku=BF();function Pu(n){return te(n?.[ku])}function Fu(n){return lD(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Hi(t.read());if(i)return yield Hi(void 0);yield yield Hi(r)}}finally{t.releaseLock()}})}function Lu(n){return te(n?.getReader)}function Qe(n){if(n instanceof ye)return n;if(n!=null){if(Ru(n))return VF(n);if(Nu(n))return UF(n);if(Mu(n))return jF(n);if(xu(n))return dD(n);if(Pu(n))return qF(n);if(Lu(n))return HF(n)}throw Ou(n)}function VF(n){return new ye(e=>{let t=n[so]();if(te(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function UF(n){return new ye(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function jF(n){return new ye(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Du)})}function qF(n){return new ye(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function dD(n){return new ye(e=>{$F(n,e).catch(t=>e.error(t))})}function HF(n){return dD(Fu(n))}function $F(n,e){var t,r,i,s;return cD(this,void 0,void 0,function*(){try{for(t=uD(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function Bt(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function Bu(n,e=0){return fe((t,r)=>{t.subscribe(ce(r,i=>Bt(r,n,()=>r.next(i),e),()=>Bt(r,n,()=>r.complete(),e),i=>Bt(r,n,()=>r.error(i),e)))})}function Vu(n,e=0){return fe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function fD(n,e){return Qe(n).pipe(Vu(e),Bu(e))}function hD(n,e){return Qe(n).pipe(Vu(e),Bu(e))}function pD(n,e){return new ye(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function gD(n,e){return new ye(t=>{let r;return Bt(t,e,()=>{r=n[ku](),Bt(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>te(r?.return)&&r.return()})}function Uu(n,e){if(!n)throw new Error("Iterable cannot be null");return new ye(t=>{Bt(t,e,()=>{let r=n[Symbol.asyncIterator]();Bt(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function mD(n,e){return Uu(Fu(n),e)}function yD(n,e){if(n!=null){if(Ru(n))return fD(n,e);if(Nu(n))return pD(n,e);if(Mu(n))return hD(n,e);if(xu(n))return Uu(n,e);if(Pu(n))return gD(n,e);if(Lu(n))return mD(n,e)}throw Ou(n)}function Un(n,e){return e?yD(n,e):Qe(n)}function zF(...n){let e=Gr(n);return Un(n,e)}function GF(n,e){let t=te(n)?n:()=>n,r=i=>i.error(t());return new ye(e?i=>e.schedule(r,0,i):r)}function WF(n){return!!n&&(n instanceof ye||te(n.lift)&&te(n.subscribe))}var $i=to(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function gr(n,e){return fe((t,r)=>{let i=0;t.subscribe(ce(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:KF}=Array;function QF(n,e){return KF(e)?n(...e):n(e)}function ju(n){return gr(e=>QF(n,e))}var{isArray:YF}=Array,{getPrototypeOf:ZF,prototype:JF,keys:XF}=Object;function qu(n){if(n.length===1){let e=n[0];if(YF(e))return{args:e,keys:null};if(eL(e)){let t=XF(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function eL(n){return n&&typeof n=="object"&&ZF(n)===JF}function Hu(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function tL(...n){let e=Gr(n),t=Au(n),{args:r,keys:i}=qu(n);if(r.length===0)return Un([],e);let s=new ye(nL(r,e,i?o=>Hu(i,o):zt));return t?s.pipe(ju(t)):s}function nL(n,e,t=zt){return r=>{vD(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)vD(e,()=>{let l=Un(n[c],e),u=!1;l.subscribe(ce(r,d=>{s[c]=d,u||(u=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function vD(n,e,t){n?Bt(t,n,e):e()}function ED(n,e,t,r,i,s,o,a){let c=[],l=0,u=0,d=!1,f=()=>{d&&!c.length&&!l&&e.complete()},h=b=>l<r?_(b):c.push(b),_=b=>{s&&e.next(b),l++;let T=!1;Qe(t(b,u++)).subscribe(ce(e,D=>{i?.(D),s?h(D):e.next(D)},()=>{T=!0},void 0,()=>{if(T)try{for(l--;c.length&&l<r;){let D=c.shift();o?Bt(e,o,()=>_(D)):_(D)}f()}catch(D){e.error(D)}}))};return n.subscribe(ce(e,h,()=>{d=!0,f()})),()=>{a?.()}}function zi(n,e,t=1/0){return te(e)?zi((r,i)=>gr((s,o)=>e(r,s,i,o))(Qe(n(r,i))),t):(typeof e=="number"&&(t=e),fe((r,i)=>ED(r,i,n,t)))}function _D(n=1/0){return zi(zt,n)}function CD(){return _D(1)}function $u(...n){return CD()(Un(n,Gr(n)))}function rL(n){return new ye(e=>{Qe(n()).subscribe(e)})}function xg(...n){let e=Au(n),{args:t,keys:r}=qu(n),i=new ye(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),c=o,l=o;for(let u=0;u<o;u++){let d=!1;Qe(t[u]).subscribe(ce(s,f=>{d||(d=!0,l--),a[u]=f},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(r?Hu(r,a):a),s.complete())}))}});return e?i.pipe(ju(e)):i}function ac(n,e){return fe((t,r)=>{let i=0;t.subscribe(ce(r,s=>n.call(e,s,i++)&&r.next(s)))})}function bD(n){return fe((e,t)=>{let r=null,i=!1,s;r=e.subscribe(ce(t,void 0,void 0,o=>{s=Qe(n(o,bD(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function SD(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(ce(o,u=>{let d=l++;c=a?n(c,u,d):(a=!0,u),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function iL(n,e){return te(e)?zi(n,e,1):zi(n,1)}function cc(n){return fe((e,t)=>{let r=!1;e.subscribe(ce(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Og(n){return n<=0?()=>oc:fe((e,t)=>{let r=0;e.subscribe(ce(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function zu(n=sL){return fe((e,t)=>{let r=!1;e.subscribe(ce(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function sL(){return new $i}function oL(n){return fe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function aL(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ac((i,s)=>n(i,s,r)):zt,Og(1),t?cc(e):zu(()=>new $i))}function kg(n){return n<=0?()=>oc:fe((e,t)=>{let r=[];e.subscribe(ce(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function cL(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ac((i,s)=>n(i,s,r)):zt,kg(1),t?cc(e):zu(()=>new $i))}function lL(n,e){return fe(SD(n,e,arguments.length>=2,!0))}function uL(...n){let e=Gr(n);return fe((t,r)=>{(e?$u(n,t,e):$u(n,t)).subscribe(r)})}function dL(n,e){return fe((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(ce(r,c=>{i?.unsubscribe();let l=0,u=s++;Qe(n(c,u)).subscribe(i=ce(r,d=>r.next(e?e(c,d,u,l++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function fL(n){return fe((e,t)=>{Qe(n).subscribe(ce(t,()=>t.complete(),ic)),!t.closed&&e.subscribe(t)})}function hL(n,e,t){let r=te(n)||e||t?{next:n,error:e,complete:t}:n;return r?fe((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(ce(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):zt}function TD(n){let e=ee(null);try{return n()}finally{ee(e)}}var Wg="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",Q=class extends Error{code;constructor(e,t){super(ao(e,t)),this.code=e}};function pL(n){return`NG0${Math.abs(n)}`}function ao(n,e){return`${pL(n)}${e?": "+e:""}`}var Kg=globalThis;function Se(n){for(let e in n)if(n[e]===Se)return e;throw Error("")}function ID(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function yr(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(yr).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function Qg(n,e){return n?e?`${n} ${e}`:n:e||""}var gL=Se({__forward_ref__:Se});function rn(n){return n.__forward_ref__=rn,n.toString=function(){return yr(this())},n}function pt(n){return Yg(n)?n():n}function Yg(n){return typeof n=="function"&&n.hasOwnProperty(gL)&&n.__forward_ref__===rn}function AD(n,e){n==null&&Zg(e,n,null,"!=")}function Zg(n,e,t,r){throw new Error(`ASSERTION ERROR: ${n}`+(r==null?"":` [Expected=> ${t} ${r} ${e} <=Actual]`))}function ve(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Kr(n){return{providers:n.providers||[],imports:n.imports||[]}}function hc(n){return yL(n,Yu)}function mL(n){return hc(n)!==null}function yL(n,e){return n.hasOwnProperty(e)&&n[e]||null}function vL(n){let e=n?.[Yu]??null;return e||null}function Fg(n){return n&&n.hasOwnProperty(Wu)?n[Wu]:null}var Yu=Se({\u0275prov:Se}),Wu=Se({\u0275inj:Se}),$=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ve({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Jg(n){return n&&!!n.\u0275providers}var Xg=Se({\u0275cmp:Se}),em=Se({\u0275dir:Se}),tm=Se({\u0275pipe:Se}),nm=Se({\u0275mod:Se}),dc=Se({\u0275fac:Se}),Ji=Se({__NG_ELEMENT_ID__:Se}),DD=Se({__NG_ENV_ID__:Se});function pc(n){return typeof n=="string"?n:n==null?"":String(n)}function Ku(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():pc(n)}var rm=Se({ngErrorCode:Se}),ND=Se({ngErrorMessage:Se}),uc=Se({ngTokenPath:Se});function im(n,e){return MD("",-200,e)}function Zu(n,e){throw new Q(-201,!1)}function EL(n,e){n[uc]??=[];let t=n[uc],r;typeof e=="object"&&"multi"in e&&e?.multi===!0?(AD(e.provide,"Token with multi: true should have a provide property"),r=Ku(e.provide)):r=Ku(e),t[0]!==r&&n[uc].unshift(r)}function _L(n,e){let t=n[uc],r=n[rm],i=n[ND]||n.message;return n.message=bL(i,r,t,e),n}function MD(n,e,t){let r=new Q(e,n);return r[rm]=e,r[ND]=n,t&&(r[uc]=t),r}function CL(n){return n[rm]}function bL(n,e,t=[],r=null){let i="";t&&t.length>1&&(i=` Path: ${t.join(" -> ")}.`);let s=r?` Source: ${r}.`:"";return ao(e,`${n}${s}${i}`)}var Lg;function RD(){return Lg}function Gt(n){let e=Lg;return Lg=n,e}function sm(n,e,t){let r=hc(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;Zu(n,"Injector")}var SL={},Gi=SL,Bg="__NG_DI_FLAG__",Vg=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=Wi(t)||0;try{return this.injector.get(e,r&8?null:Gi,r)}catch(i){if(Qs(i))return i;throw i}}};function TL(n,e=0){let t=fu();if(t===void 0)throw new Q(-203,!1);if(t===null)return sm(n,void 0,e);{let r=DL(e),i=t.retrieve(n,r);if(Qs(i)){if(r.optional)return null;throw i}return i}}function $e(n,e=0){return(RD()||TL)(pt(n),e)}function G(n,e){return $e(n,Wi(e))}function Wi(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function DL(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function Ug(n){let e=[];for(let t=0;t<n.length;t++){let r=pt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new Q(900,!1);let i,s=0;for(let o=0;o<r.length;o++){let a=r[o],c=wL(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push($e(i,s))}else e.push($e(r))}return e}function xD(n,e){return n[Bg]=e,n.prototype[Bg]=e,n}function wL(n){return n[Bg]}function Ki(n,e){let t=n.hasOwnProperty(dc);return t?n[dc]:null}function Ju(n,e){n.forEach(t=>Array.isArray(t)?Ju(t,e):e(t))}function om(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function gc(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function OD(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function kD(n,e,t){let r=co(n,e);return r>=0?n[r|1]=t:(r=~r,OD(n,r,e,t)),r}function Xu(n,e){let t=co(n,e);if(t>=0)return n[t|1]}function co(n,e){return IL(n,e,1)}function IL(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var Qr={},Vt=[],vr=new $(""),am=new $("",-1),cm=new $(""),fc=class{get(e,t=Gi){if(t===Gi){let i=MD("",-201);throw i.name="\u0275NotFound",i}return t}};function lm(n){return n[nm]||null}function Er(n){return n[Xg]||null}function um(n){return n[em]||null}function PD(n){return n[tm]||null}function lo(n){return{\u0275providers:n}}function FD(n){return lo([{provide:vr,multi:!0,useValue:n}])}function LD(...n){return{\u0275providers:dm(!0,n),\u0275fromNgModule:!0}}function dm(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return Ju(e,o=>{let a=o;Qu(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&BD(i,s),t}function BD(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];fm(i,s=>{e(s,r)})}}function Qu(n,e,t,r){if(n=pt(n),!n)return!1;let i=null,s=Fg(n),o=!s&&Er(n);if(!s&&!o){let c=n.ngModule;if(s=Fg(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Qu(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{Ju(s.imports,u=>{Qu(u,e,t,r)&&(l||=[],l.push(u))})}finally{}l!==void 0&&BD(l,e)}if(!a){let l=Ki(i)||(()=>new i);e({provide:i,useFactory:l,deps:Vt},i),e({provide:cm,useValue:i,multi:!0},i),e({provide:vr,useValue:()=>$e(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;fm(c,u=>{e(u,l)})}}else return!1;return i!==n&&n.providers!==void 0}function fm(n,e){for(let t of n)Jg(t)&&(t=t.\u0275providers),Array.isArray(t)?fm(t,e):e(t)}var AL=Se({provide:String,useValue:Se});function VD(n){return n!==null&&typeof n=="object"&&AL in n}function NL(n){return!!(n&&n.useExisting)}function ML(n){return!!(n&&n.useFactory)}function Qi(n){return typeof n=="function"}function UD(n){return!!n.useClass}var hm=new $(""),Gu={},wD={},Pg;function mc(){return Pg===void 0&&(Pg=new fc),Pg}var tn=class{},Yi=class extends tn{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,qg(e,o=>this.processProvider(o)),this.records.set(am,oo(void 0,this)),i.has("environment")&&this.records.set(tn,oo(void 0,this));let s=this.records.get(hm);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(cm,Vt,{self:!0}))}retrieve(e,t){let r=Wi(t)||0;try{return this.get(e,Gi,r)}catch(i){if(Qs(i))return i;throw i}}destroy(){lc(this),this._destroyed=!0;let e=ee(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ee(e)}}onDestroy(e){return lc(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){lc(this);let t=Vn(this),r=Gt(void 0),i;try{return e()}finally{Vn(t),Gt(r)}}get(e,t=Gi,r){if(lc(this),e.hasOwnProperty(DD))return e[DD](this);let i=Wi(r),s,o=Vn(this),a=Gt(void 0);try{if(!(i&4)){let l=this.records.get(e);if(l===void 0){let u=PL(e)&&hc(e);u&&this.injectableDefInScope(u)?l=oo(jg(e),Gu):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l,i)}let c=i&2?mc():this.parent;return t=i&8&&t===Gi?null:t,c.get(e,t)}catch(c){let l=CL(c);throw l===-200||l===-201?new Q(l,null):c}finally{Gt(a),Vn(o)}}resolveInjectorInitializers(){let e=ee(null),t=Vn(this),r=Gt(void 0),i;try{let s=this.get(vr,Vt,{self:!0});for(let o of s)o()}finally{Vn(t),Gt(r),ee(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(yr(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=pt(e);let t=Qi(e)?e:pt(e&&e.provide),r=xL(e);if(!Qi(e)&&e.multi===!0){let i=this.records.get(t);i||(i=oo(void 0,Gu,!0),i.factory=()=>Ug(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=ee(null);try{if(t.value===wD)throw im(yr(e));return t.value===Gu&&(t.value=wD,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&kL(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ee(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=pt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function jg(n){let e=hc(n),t=e!==null?e.factory:Ki(n);if(t!==null)return t;if(n instanceof $)throw new Q(204,!1);if(n instanceof Function)return RL(n);throw new Q(204,!1)}function RL(n){if(n.length>0)throw new Q(204,!1);let t=vL(n);return t!==null?()=>t.factory(n):()=>new n}function xL(n){if(VD(n))return oo(void 0,n.useValue);{let e=pm(n);return oo(e,Gu)}}function pm(n,e,t){let r;if(Qi(n)){let i=pt(n);return Ki(i)||jg(i)}else if(VD(n))r=()=>pt(n.useValue);else if(ML(n))r=()=>n.useFactory(...Ug(n.deps||[]));else if(NL(n))r=(i,s)=>$e(pt(n.useExisting),s!==void 0&&s&8?8:void 0);else{let i=pt(n&&(n.useClass||n.provide));if(OL(n))r=()=>new i(...Ug(n.deps));else return Ki(i)||jg(i)}return r}function lc(n){if(n.destroyed)throw new Q(205,!1)}function oo(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function OL(n){return!!n.deps}function kL(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function PL(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function qg(n,e){for(let t of n)Array.isArray(t)?qg(t,e):t&&Jg(t)?qg(t.\u0275providers,e):e(t)}function ed(n,e){let t;n instanceof Yi?(lc(n),t=n):t=new Vg(n);let r,i=Vn(t),s=Gt(void 0);try{return e()}finally{Vn(i),Gt(s)}}function gm(){return RD()!==void 0||fu()!=null}var ze=0,H=1,Z=2,Xe=3,sn=4,on=5,an=6,Xi=7,it=8,es=9,_r=10,we=11,uo=12,mm=13,ts=14,Ot=15,ns=16,rs=17,is=18,yc=19,ym=20,mr=21,td=22,vc=23,Wt=24,nd=25,he=26,vm=1,ss=6,qn=7,Ec=8,_c=9,Ct=10;function Hn(n){return Array.isArray(n)&&typeof n[vm]=="object"}function bt(n){return Array.isArray(n)&&n[vm]===!0}function Em(n){return(n.flags&4)!==0}function $n(n){return n.componentOffset>-1}function Cc(n){return(n.flags&1)===1}function zn(n){return!!n.template}function Yr(n){return(n[Z]&512)!==0}function _m(n){return(n.type&16)===16}function jD(n){return(n[Z]&32)===32}function os(n){return(n[Z]&256)===256}var qD="svg",HD="math";function Me(n){for(;Array.isArray(n);)n=n[ze];return n}function rd(n){for(;Array.isArray(n);){if(typeof n[vm]=="object")return n;n=n[ze]}return null}function Cm(n,e){return Me(e[n])}function cn(n,e){return Me(e[n.index])}function bc(n,e){return n.data[e]}function $D(n,e){return n[e]}function ln(n,e){let t=e[n];return Hn(t)?t:t[ze]}function id(n){return(n[Z]&128)===128}function zD(n){return bt(n[Xe])}function Gn(n,e){return e==null?null:n[e]}function bm(n){n[rs]=0}function Sm(n){n[Z]&1024||(n[Z]|=1024,id(n)&&Tc(n))}function GD(n,e){for(;n>0;)e=e[ts],n--;return e}function Sc(n){return!!(n[Z]&9216||n[Wt]?.dirty)}function sd(n){n[_r].changeDetectionScheduler?.notify(8),n[Z]&64&&(n[Z]|=1024),Sc(n)&&Tc(n)}function Tc(n){n[_r].changeDetectionScheduler?.notify(0);let e=Wr(n);for(;e!==null&&!(e[Z]&8192||(e[Z]|=8192,!id(e)));)e=Wr(e)}function Tm(n,e){if(os(n))throw new Q(911,!1);n[mr]===null&&(n[mr]=[]),n[mr].push(e)}function WD(n,e){if(n[mr]===null)return;let t=n[mr].indexOf(e);t!==-1&&n[mr].splice(t,1)}function Wr(n){let e=n[Xe];return bt(e)?e[Xe]:e}function KD(n){return n[Xi]??=[]}function QD(n){return n.cleanup??=[]}var se={lFrame:dw(null),bindingsEnabled:!0,skipHydrationRootTNode:null},Dc=(function(n){return n[n.Off=0]="Off",n[n.Exhaustive=1]="Exhaustive",n[n.OnlyDirtyViews=2]="OnlyDirtyViews",n})(Dc||{}),FL=0,Hg=!1;function YD(){return se.lFrame.elementDepthCount}function ZD(){se.lFrame.elementDepthCount++}function Dm(){se.lFrame.elementDepthCount--}function wm(){return se.bindingsEnabled}function Im(){return se.skipHydrationRootTNode!==null}function Am(n){return se.skipHydrationRootTNode===n}function JD(n){se.skipHydrationRootTNode=n}function Nm(){se.skipHydrationRootTNode=null}function Ie(){return se.lFrame.lView}function kt(){return se.lFrame.tView}function XD(n){return se.lFrame.contextLView=n,n[it]}function ew(n){return se.lFrame.contextLView=null,n}function Pt(){let n=Mm();for(;n!==null&&n.type===64;)n=n.parent;return n}function Mm(){return se.lFrame.currentTNode}function tw(){let n=se.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function fo(n,e){let t=se.lFrame;t.currentTNode=n,t.isParent=e}function Rm(){return se.lFrame.isParent}function nw(){se.lFrame.isParent=!1}function rw(){return se.lFrame.contextLView}function xm(n){Zg("Must never be called in production mode"),FL=n}function Om(){return Hg}function km(n){let e=Hg;return Hg=n,e}function iw(n){return se.lFrame.bindingIndex=n}function ho(){return se.lFrame.bindingIndex++}function sw(n){let e=se.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function ow(){return se.lFrame.inI18n}function aw(n,e){let t=se.lFrame;t.bindingIndex=t.bindingRootIndex=n,od(e)}function cw(){return se.lFrame.currentDirectiveIndex}function od(n){se.lFrame.currentDirectiveIndex=n}function lw(n){let e=se.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Pm(n){se.lFrame.currentQueryIndex=n}function LL(n){let e=n[H];return e.type===2?e.declTNode:e.type===1?n[on]:null}function Fm(n,e,t){if(t&4){let i=e,s=n;for(;i=i.parent,i===null&&!(t&1);)if(i=LL(s),i===null||(s=s[ts],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=se.lFrame=uw();return r.currentTNode=e,r.lView=n,!0}function ad(n){let e=uw(),t=n[H];se.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function uw(){let n=se.lFrame,e=n===null?null:n.child;return e===null?dw(n):e}function dw(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function fw(){let n=se.lFrame;return se.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Lm=fw;function cd(){let n=fw();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function hw(n){return(se.lFrame.contextLView=GD(n,se.lFrame.contextLView))[it]}function as(){return se.lFrame.selectedIndex}function Zr(n){se.lFrame.selectedIndex=n}function ld(){let n=se.lFrame;return bc(n.tView,n.selectedIndex)}function Bm(){return se.lFrame.currentNamespace}var pw=!0;function ud(){return pw}function Cr(n){pw=n}var BL={elements:void 0};function gw(){return BL}function $g(n,e=null,t=null,r){let i=Vm(n,e,t,r);return i.resolveInjectorInitializers(),i}function Vm(n,e=null,t=null,r,i=new Set){let s=[t||Vt,LD(n)];return r=r||(typeof n=="object"?void 0:yr(n)),new Yi(s,e||mc(),r||null,i)}var nn=class n{static THROW_IF_NOT_FOUND=Gi;static NULL=new fc;static create(e,t){if(Array.isArray(e))return $g({name:""},t,e,"");{let r=e.name??"";return $g({name:r},e.parent,e.providers,r)}}static \u0275prov=ve({token:n,providedIn:"any",factory:()=>$e(am)});static __NG_ELEMENT_ID__=-1},cs=new $(""),ls=(()=>{class n{static __NG_ELEMENT_ID__=VL;static __NG_ENV_ID__=t=>t}return n})(),zg=class extends ls{_lView;constructor(e){super(),this._lView=e}get destroyed(){return os(this._lView)}onDestroy(e){let t=this._lView;return Tm(t,e),()=>WD(t,e)}};function VL(){return new zg(Ie())}var Zi=class{_console=console;handleError(e){this._console.error("ERROR",e)}},bn=new $("",{providedIn:"root",factory:()=>{let n=G(tn),e;return t=>{n.destroyed&&!e?setTimeout(()=>{throw t}):(e??=n.get(Zi),e.handleError(t))}}}),Um={provide:vr,useValue:()=>void G(Zi),multi:!0},UL=new $("",{providedIn:"root",factory:()=>{}});function jL(){return lo([FD(()=>void G(UL))])}function jm(n){return typeof n=="function"&&n[_t]!==void 0}function Jr(n,e){let[t,r,i]=_g(n,e?.equal),s=t,o=s[_t];return s.set=r,s.update=i,s.asReadonly=mw.bind(s),s}function mw(){let n=this[_t];if(n.readonlyFn===void 0){let e=()=>this();e[_t]=n,n.readonlyFn=e}return n.readonlyFn}function qm(n){return jm(n)&&typeof n.set=="function"}var jn=class{},wc=new $("",{providedIn:"root",factory:()=>!1});var Hm=new $(""),dd=new $("");var Xr=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new sc(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new ye(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=ve({token:n,providedIn:"root",factory:()=>new n})}return n})(),yw=(()=>{class n{internalPendingTasks=G(Xr);scheduler=G(jn);errorHandler=G(bn);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let r=this.add();t().catch(this.errorHandler).finally(r)}static \u0275prov=ve({token:n,providedIn:"root",factory:()=>new n})}return n})();function Ic(...n){}var $m=(()=>{class n{static \u0275prov=ve({token:n,providedIn:"root",factory:()=>new Gg})}return n})(),Gg=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}};var zm={JSACTION:"jsaction"};function So(n){return{toString:n}.toString()}var fd="__parameters__";function ZL(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function JL(n,e,t){return So(()=>{let r=ZL(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,u){let d=c.hasOwnProperty(fd)?c[fd]:Object.defineProperty(c,fd,{value:[]})[fd];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var XL=xD(JL("Optional"),8);function Kw(n){let e=Kg.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function e2(n){return typeof n=="function"}var Ed=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function Qw(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var ms=(()=>{let n=()=>Yw;return n.ngInherit=!0,n})();function Yw(n){return n.type.prototype.ngOnChanges&&(n.setInput=n2),t2}function t2(){let n=Jw(this),e=n?.current;if(e){let t=n.previous;if(t===Qr)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function n2(n,e,t,r,i){let s=this.declaredInputs[r],o=Jw(n)||r2(n,{previous:Qr,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new Ed(l&&l.currentValue,t,c===Qr),Qw(n,e,i,t)}var Zw="__ngSimpleChanges__";function Jw(n){return n[Zw]||null}function r2(n,e){return n[Zw]=e}var vw=[];var Re=function(n,e=null,t){for(let r=0;r<vw.length;r++){let i=vw[r];i(n,e,t)}};function i2(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=Yw(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function Xw(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),u!=null&&(n.destroyHooks??=[]).push(t,u)}}function gd(n,e,t){eI(n,e,3,t)}function md(n,e,t,r){(n[Z]&3)===t&&eI(n,e,t,r)}function Gm(n,e){let t=n[Z];(t&3)===e&&(t&=16383,t+=1,n[Z]=t)}function eI(n,e,t,r){let i=r!==void 0?n[rs]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[rs]+=65536),(a<s||s==-1)&&(s2(n,t,e,c),n[rs]=(n[rs]&4294901760)+c+2),c++}function Ew(n,e){Re(4,n,e);let t=ee(null);try{e.call(n)}finally{ee(t),Re(5,n,e)}}function s2(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[Z]>>14<n[rs]>>16&&(n[Z]&3)===e&&(n[Z]+=16384,Ew(a,s)):Ew(a,s)}var go=-1,fs=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r,i){this.factory=e,this.name=i,this.canSeeViewProviders=t,this.injectImpl=r}};function Ry(n){return n!=null&&typeof n=="object"&&(n.insertBeforeIndex===null||typeof n.insertBeforeIndex=="number"||Array.isArray(n.insertBeforeIndex))}function tI(n){return!!(n.type&128)}function o2(n){return(n.flags&8)!==0}function a2(n){return(n.flags&16)!==0}function c2(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];u2(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function l2(n){return n===3||n===4||n===6}function u2(n){return n.charCodeAt(0)===64}function yo(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?_w(n,t,i,null,e[++r]):_w(n,t,i,null,null))}}return n}function _w(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){i!==null&&(n[s+1]=i);return}s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),i!==null&&n.splice(s++,0,i)}function nI(n){return n!==go}function _d(n){return n&32767}function d2(n){return n>>16}function Cd(n,e){let t=d2(n),r=e;for(;t>0;)r=r[ts],t--;return r}var sy=!0;function Cw(n){let e=sy;return sy=n,e}var f2=256,rI=f2-1,iI=5,h2=0,Wn={};function p2(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Ji)&&(r=t[Ji]),r==null&&(r=t[Ji]=h2++);let i=r&rI,s=1<<i;e.data[n+(i>>iI)]|=s}function bd(n,e){let t=sI(n,e);if(t!==-1)return t;let r=e[H];r.firstCreatePass&&(n.injectorIndex=e.length,Wm(r.data,n),Wm(e,null),Wm(r.blueprint,null));let i=xy(n,e),s=n.injectorIndex;if(nI(i)){let o=_d(i),a=Cd(i,e),c=a[H].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Wm(n,e){n.push(0,0,0,0,0,0,0,0,e)}function sI(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function xy(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=uI(i),r===null)return go;if(t++,i=i[ts],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return go}function oy(n,e,t){p2(n,e,t)}function oI(n,e,t){if(t&8||n!==void 0)return n;Zu(e,"NodeInjector")}function aI(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let i=n[es],s=Gt(void 0);try{return i?i.get(e,r,t&8):sm(e,r,t&8)}finally{Gt(s)}}return oI(r,e,t)}function cI(n,e,t,r=0,i){if(n!==null){if(e[Z]&2048&&!(r&2)){let o=E2(n,e,t,r,Wn);if(o!==Wn)return o}let s=lI(n,e,t,r,Wn);if(s!==Wn)return s}return aI(e,t,r,i)}function lI(n,e,t,r,i){let s=y2(t);if(typeof s=="function"){if(!Fm(e,n,r))return r&1?oI(i,t,r):aI(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&8))Zu(t);else return o}finally{Lm()}}else if(typeof s=="number"){let o=null,a=sI(n,e),c=go,l=r&1?e[Ot][on]:null;for((a===-1||r&4)&&(c=a===-1?xy(n,e):e[a+8],c===go||!Sw(r,!1)?a=-1:(o=e[H],a=_d(c),e=Cd(c,e)));a!==-1;){let u=e[H];if(bw(s,a,u.data)){let d=g2(a,e,t,o,r,l);if(d!==Wn)return d}c=e[a+8],c!==go&&Sw(r,e[H].data[a+8]===l)&&bw(s,a,e)?(o=u,a=_d(c),e=Cd(c,e)):a=-1}}return i}function g2(n,e,t,r,i,s){let o=e[H],a=o.data[n+8],c=r==null?$n(a)&&sy:r!=o&&(a.type&3)!==0,l=i&1&&s===a,u=m2(a,o,t,c,l);return u!==null?Sd(e,o,u,a,i):Wn}function m2(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,u=s>>20,d=r?a:a+u,f=i?a+u:l;for(let h=d;h<f;h++){let _=o[h];if(h<c&&t===_||h>=c&&_.type===t)return h}if(i){let h=o[c];if(h&&zn(h)&&h.type===t)return c}return null}function Sd(n,e,t,r,i){let s=n[t],o=e.data;if(s instanceof fs){let a=s;if(a.resolving){let h=Ku(o[t]);throw im(h)}let c=Cw(a.canSeeViewProviders);a.resolving=!0;let l=o[t].type||o[t],u,d=a.injectImpl?Gt(a.injectImpl):null,f=Fm(n,r,0);try{s=n[t]=a.factory(void 0,i,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&i2(t,o[t],e)}finally{d!==null&&Gt(d),Cw(c),a.resolving=!1,Lm()}}return s}function y2(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Ji)?n[Ji]:void 0;return typeof e=="number"?e>=0?e&rI:v2:e}function bw(n,e,t){let r=1<<n;return!!(t[e+(n>>iI)]&r)}function Sw(n,e){return!(n&2)&&!(n&1&&e)}var ds=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return cI(this._tNode,this._lView,e,Wi(r),t)}};function v2(){return new ds(Pt(),Ie())}function Fc(n){return So(()=>{let e=n.prototype.constructor,t=e[dc]||ay(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[dc]||ay(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function ay(n){return Yg(n)?()=>{let e=ay(pt(n));return e&&e()}:Ki(n)}function E2(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[Z]&2048&&!Yr(o);){let a=lI(s,o,t,r|2,Wn);if(a!==Wn)return a;let c=s.parent;if(!c){let l=o[ym];if(l){let u=l.get(t,Wn,r);if(u!==Wn)return u}c=uI(o),o=o[ts]}s=c}return i}function uI(n){let e=n[H],t=e.type;return t===2?e.declTNode:t===1?n[on]:null}function _2(){return kd(Pt(),Ie())}function kd(n,e){return new ys(cn(n,e))}var ys=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=_2}return n})();var To="ngSkipHydration",C2="ngskiphydration";function Oy(n){let e=n.mergedAttrs;if(e===null)return!1;for(let t=0;t<e.length;t+=2){let r=e[t];if(typeof r=="number")return!1;if(typeof r=="string"&&r.toLowerCase()===C2)return!0}return!1}function dI(n){return n.hasAttribute(To)}function Nc(n){return(n.flags&128)===128}function Do(n){if(Nc(n))return!0;let e=n.parent;for(;e;){if(Nc(n)||Oy(e))return!0;e=e.parent}return!1}function b2(n){return Nc(n)||Oy(n)||Do(n)}var ky=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(ky||{}),fI=new Map,S2=0;function T2(){return S2++}function D2(n){fI.set(n[yc],n)}function cy(n){fI.delete(n[yc])}var Tw="__ngContext__";function vo(n,e){Hn(e)?(n[Tw]=e[yc],D2(e)):n[Tw]=e}function hI(n){return gI(n[uo])}function pI(n){return gI(n[sn])}function gI(n){for(;n!==null&&!bt(n);)n=n[sn];return n}var ly;function w2(n){ly=n}function Pd(){if(ly!==void 0)return ly;if(typeof document<"u")return document;throw new Q(210,!1)}var mI=new $("",{providedIn:"root",factory:()=>I2}),I2="ng",yI=new $(""),A2=new $("",{providedIn:"platform",factory:()=>"unknown"});var N2=new $(""),M2=new $("",{providedIn:"root",factory:()=>Pd().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function R2(){return new Fd}var Fd=(()=>{class n{static \u0275prov=ve({token:n,providedIn:"root",factory:R2});store={};onSerializeCallbacks={};get(t,r){return this.store[t]!==void 0?this.store[t]:r}set(t,r){this.store[t]=r}remove(t){delete this.store[t]}hasKey(t){return this.store.hasOwnProperty(t)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(t,r){this.onSerializeCallbacks[t]=r}toJson(){for(let t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(r){console.warn("Exception in onSerialize callback: ",r)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}}return n})();var Py="h",Fy="b",vI="f",EI="n",Ld="e",Bd="t",wo="c",Lc="x",ei="r",Vd="i",Ud="n",Io="d",Ly="l",By="di",Vy="s",_I="p",CI="t",Uy=new $(""),bI=!1,x2=new $("",{providedIn:"root",factory:()=>bI}),SI=new $(""),jy=new $(""),TI=!1,DI=new $("");var O2=["click","keydown"],k2=["mouseenter","mouseover","focusin"];var wI="ngb";function qy(n,e,t=null){if(e.length===0||n.nodeType!==Node.ELEMENT_NODE)return;let r=n.getAttribute(zm.JSACTION),i=e.reduce((o,a)=>(r?.indexOf(a)??-1)===-1?o+a+":;":o,"");n.setAttribute(zm.JSACTION,`${r??""}${i}`);let s=t??"";s!==""&&i.length>0&&n.setAttribute(wI,s)}var P2=(n,e,t,r)=>{};function F2(n,e,t,r){P2(n,e,t,r)}function Bc(n){return(n.flags&32)===32}var L2="__nghData__",Hy=L2,B2="__nghDeferData__",II=B2;var mo="ngh",AI="nghm",NI=()=>null;function V2(n,e,t=!1){let r=n.getAttribute(mo);if(r==null)return null;let[i,s]=r.split("|");if(r=t?s:i,!r)return null;let o=s?`|${s}`:"",a=t?i:o,c={};if(r!==""){let u=e.get(Fd,null,{optional:!0});u!==null&&(c=u.get(Hy,[])[Number(r)])}let l={data:c,firstChild:n.firstChild??null};return t&&(l.firstChild=n,jd(l,0,n.nextSibling)),a?n.setAttribute(mo,a):n.removeAttribute(mo),l}function MI(){NI=V2}function RI(n,e,t=!1){return NI(n,e,t)}function xI(n){let e=n._lView;return e[H].type===2?null:(Yr(e)&&(e=e[he]),e)}function U2(n){return n.textContent?.replace(/\s/gm,"")}function j2(n){let e=Pd(),t=e.createNodeIterator(n,NodeFilter.SHOW_COMMENT,{acceptNode(s){let o=U2(s);return o==="ngetn"||o==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),r,i=[];for(;r=t.nextNode();)i.push(r);for(let s of i)s.textContent==="ngetn"?s.replaceWith(e.createTextNode("")):s.remove()}function jd(n,e,t){n.segmentHeads??={},n.segmentHeads[e]=t}function uy(n,e){return n.segmentHeads?.[e]??null}function OI(n){return n.get(DI,!1,{optional:!0})}function q2(n,e){let t=n.data,r=t[Ld]?.[e]??null;return r===null&&t[wo]?.[e]&&(r=$y(n,e)),r}function kI(n,e){return n.data[wo]?.[e]??null}function $y(n,e){let t=kI(n,e)??[],r=0;for(let i of t)r+=i[ei]*(i[Lc]??1);return r}function H2(n){if(typeof n.disconnectedNodes>"u"){let e=n.data[Io];n.disconnectedNodes=e?new Set(e):null}return n.disconnectedNodes}function PI(n,e){if(typeof n.disconnectedNodes>"u"){let t=n.data[Io];n.disconnectedNodes=t?new Set(t):null}return!!H2(n)?.has(e)}function qd(n,e){let t=n[an];return t!==null&&!Im()&&!Bc(e)&&!PI(t,e.index-he)}function zy(n,e){let t=e,r=n.corruptedTextNodes;t.textContent===""?r.set(t,"ngetn"):t.nextSibling?.nodeType===Node.TEXT_NODE&&r.set(t,"ngtns")}function FI(n){let e=[];return n!==null&&(n.has(4)&&e.push(...k2),n.has(3)&&e.push(...O2)),e}function Km(n){return!!n&&n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===AI}function Dw(n){for(;n&&n.nodeType===Node.TEXT_NODE;)n=n.previousSibling;return n}function LI(n){for(let r of n.body.childNodes)if(Km(r))return;let e=Dw(n.body.previousSibling);if(Km(e))return;let t=Dw(n.head.lastChild);if(!Km(t))throw new Q(-507,!1)}function BI(n,e){let t=n.contentQueries;if(t!==null){let r=ee(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];Pm(s),a.contentQueries(2,e[o],o)}}}finally{ee(r)}}}function dy(n,e,t){Pm(0);let r=ee(null);try{e(n,t)}finally{ee(r)}}function VI(n,e,t){if(Em(e)){let r=ee(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{ee(r)}}}var hs=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n})(hs||{});var fy=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Wg})`}};function Gy(n){return n instanceof fy?n.changingThisBreaksApplicationSecurity:n}var $2=/^>|^->|<!--|-->|--!>|<!-$/g,z2=/(<|>)/g,G2="\u200B$1\u200B";function W2(n){return n.replace($2,e=>e.replace(z2,G2))}function UI(n){return n.ownerDocument.body}function jI(n){return n instanceof Function?n():n}function K2(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}var qI="ng-template";function Q2(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&K2(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Wy(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Wy(n){return n.type===4&&n.value!==qI}function Y2(n,e,t){let r=n.type===4&&!t?qI:n.value;return e===r}function Z2(n,e,t){let r=4,i=n.attrs,s=i!==null?eB(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Sn(r)&&!Sn(c))return!1;if(o&&Sn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!Y2(n,c,t)||c===""&&e.length===1){if(Sn(r))return!1;o=!0}}else if(r&8){if(i===null||!Q2(n,i,c,t)){if(Sn(r))return!1;o=!0}}else{let l=e[++a],u=J2(c,i,Wy(n),t);if(u===-1){if(Sn(r))return!1;o=!0;continue}if(l!==""){let d;if(u>s?d="":d=i[u+1].toLowerCase(),r&2&&l!==d){if(Sn(r))return!1;o=!0}}}}return Sn(r)||o}function Sn(n){return(n&1)===0}function J2(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return tB(e,n)}function X2(n,e,t=!1){for(let r=0;r<e.length;r++)if(Z2(n,e[r],t))return!0;return!1}function eB(n){for(let e=0;e<n.length;e++){let t=n[e];if(l2(t))return e}return n.length}function tB(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function ww(n,e){return n?":not("+e.trim()+")":e}function nB(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Sn(o)&&(e+=ww(s,i),i=""),r=o,s=s||!Sn(r);t++}return i!==""&&(e+=ww(s,i)),e}function rB(n){return n.map(nB).join(",")}function iB(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!Sn(i))break;i=s}r++}return t.length&&e.push(1,...t),e}var br={};function HI(n,e){return n.createText(e)}function sB(n,e,t){n.setValue(e,t)}function $I(n,e){return n.createComment(W2(e))}function Ky(n,e,t){return n.createElement(e,t)}function Td(n,e,t,r,i){n.insertBefore(e,t,r,i)}function zI(n,e,t){n.appendChild(e,t)}function Iw(n,e,t,r,i){r!==null?Td(n,e,t,r,i):zI(n,e,t)}function GI(n,e,t){n.removeChild(null,e,t)}function WI(n){n.textContent=""}function oB(n,e,t){n.setAttribute(e,"style",t)}function aB(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function KI(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&c2(n,e,r),i!==null&&aB(n,e,i),s!==null&&oB(n,e,s)}function Qy(n,e,t,r,i,s,o,a,c,l,u){let d=he+r,f=d+i,h=cB(d,f),_=typeof l=="function"?l():l;return h[H]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:_,incompleteFirstPass:!1,ssrId:u}}function cB(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:br);return t}function lB(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Qy(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Yy(n,e,t,r,i,s,o,a,c,l,u){let d=e.blueprint.slice();return d[ze]=i,d[Z]=r|4|128|8|64|1024,(l!==null||n&&n[Z]&2048)&&(d[Z]|=2048),bm(d),d[Xe]=d[ts]=n,d[it]=t,d[_r]=o||n&&n[_r],d[we]=a||n&&n[we],d[es]=c||n&&n[es]||null,d[on]=s,d[yc]=T2(),d[an]=u,d[ym]=l,d[Ot]=e.type==2?n[Ot]:d,d}function uB(n,e,t){let r=cn(e,n),i=lB(t),s=n[_r].rendererFactory,o=Zy(n,Yy(n,i,null,QI(t),r,e,null,s.createRenderer(r,t),null,null,null));return n[e.index]=o}function QI(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function YI(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function Zy(n,e){return n[uo]?n[mm][sn]=e:n[uo]=e,n[mm]=e,e}function dB(n=1){ZI(kt(),Ie(),as()+n,!1)}function ZI(n,e,t,r){if(!r)if((e[Z]&3)===3){let s=n.preOrderCheckHooks;s!==null&&gd(e,s,t)}else{let s=n.preOrderHooks;s!==null&&md(e,s,0,t)}Zr(t)}var Hd=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Hd||{});function hy(n,e,t,r){let i=ee(null);try{let[s,o,a]=n.inputs[t],c=null;(o&Hd.SignalBased)!==0&&(c=e[s][_t]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,c,r,t,s):Qw(e,c,s,r)}finally{ee(i)}}var Mc=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Mc||{}),fB;function Jy(n,e){return fB(n,e)}function po(n,e,t,r,i){if(r!=null){let s,o=!1;bt(r)?s=r:Hn(r)&&(o=!0,r=r[ze]);let a=Me(r);n===0&&t!==null?i==null?zI(e,t,a):Td(e,t,a,i||null,!0):n===1&&t!==null?Td(e,t,a,i||null,!0):n===2?GI(e,a,o):n===3&&e.destroyNode(a),s!=null&&SB(e,n,s,t,i)}}function hB(n,e){JI(n,e),e[ze]=null,e[on]=null}function pB(n,e,t,r,i,s){r[ze]=i,r[on]=e,$d(n,r,t,1,i,s)}function JI(n,e){e[_r].changeDetectionScheduler?.notify(9),$d(n,e,e[we],2,null,null)}function gB(n){let e=n[uo];if(!e)return Qm(n[H],n);for(;e;){let t=null;if(Hn(e))t=e[uo];else{let r=e[Ct];r&&(t=r)}if(!t){for(;e&&!e[sn]&&e!==n;)Hn(e)&&Qm(e[H],e),e=e[Xe];e===null&&(e=n),Hn(e)&&Qm(e[H],e),t=e&&e[sn]}e=t}}function Xy(n,e){let t=n[_c],r=t.indexOf(e);t.splice(r,1)}function ev(n,e){if(os(e))return;let t=e[we];t.destroyNode&&$d(n,e,t,3,null,null),gB(e)}function Qm(n,e){if(os(e))return;let t=ee(null);try{e[Z]&=-129,e[Z]|=256,e[Wt]&&nc(e[Wt]),yB(n,e),mB(n,e),e[H].type===1&&e[we].destroy();let r=e[ns];if(r!==null&&bt(e[Xe])){r!==e[Xe]&&Xy(r,e);let i=e[is];i!==null&&i.detachView(n)}cy(e)}finally{ee(t)}}function mB(n,e){let t=n.cleanup,r=e[Xi];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let a=t[o+3];a>=0?r[a]():r[-a].unsubscribe(),o+=2}else{let a=r[t[o+1]];t[o].call(a)}r!==null&&(e[Xi]=null);let i=e[mr];if(i!==null){e[mr]=null;for(let o=0;o<i.length;o++){let a=i[o];a()}}let s=e[vc];if(s!==null){e[vc]=null;for(let o of s)o.destroy()}}function yB(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof fs)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Re(4,a,c);try{c.call(a)}finally{Re(5,a,c)}}else{Re(4,i,s);try{s.call(i)}finally{Re(5,i,s)}}}}}function XI(n,e,t){return vB(n,e.parent,t)}function vB(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[ze];if($n(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===hs.None||i===hs.Emulated)return null}return cn(r,t)}function EB(n,e,t){return CB(n,e,t)}function _B(n,e,t){return n.type&40?cn(n,t):null}var CB=_B,Aw;function tv(n,e,t,r){let i=XI(n,r,e),s=e[we],o=r.parent||e[on],a=EB(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)Iw(s,i,t[c],a,!1);else Iw(s,i,t,a,!1);Aw!==void 0&&Aw(s,r,e,t,i)}function us(n,e){if(e!==null){let t=e.type;if(t&3)return cn(e,n);if(t&4)return py(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return us(n,r);{let i=n[e.index];return bt(i)?py(-1,i):Me(i)}}else{if(t&128)return us(n,e.next);if(t&32)return Jy(e,n)()||Me(n[e.index]);{let r=e0(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Wr(n[Ot]);return us(i,r)}else return us(n,e.next)}}}return null}function e0(n,e){if(e!==null){let r=n[Ot][on],i=e.projection;return r.projection[i]}return null}function py(n,e){let t=Ct+n+1;if(t<e.length){let r=e[t],i=r[H].firstChild;if(i!==null)return us(r,i)}return e[qn]}function nv(n,e,t,r,i,s,o){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(o&&e===0&&(a&&vo(Me(a),r),t.flags|=2),!Bc(t))if(c&8)nv(n,e,t.child,r,i,s,!1),po(e,n,i,a,s);else if(c&32){let l=Jy(t,r),u;for(;u=l();)po(e,n,i,u,s);po(e,n,i,a,s)}else c&16?bB(n,e,r,t,i,s):po(e,n,i,a,s);t=o?t.projectionNext:t.next}}function $d(n,e,t,r,i,s){nv(t,r,n.firstChild,e,i,s,!1)}function bB(n,e,t,r,i,s){let o=t[Ot],c=o[on].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];po(e,n,i,u,s)}else{let l=c,u=o[Xe];Nc(r)&&(l.flags|=128),nv(n,e,l,u,i,s,!0)}}function SB(n,e,t,r,i){let s=t[qn],o=Me(t);s!==o&&po(e,n,r,s,i);for(let a=Ct;a<t.length;a++){let c=t[a];$d(c[H],c,n,e,r,s)}}function TB(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:Mc.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Mc.Important),n.setStyle(t,r,i,s))}}function t0(n,e,t,r,i){let s=as(),o=r&2;try{Zr(-1),o&&e.length>he&&ZI(n,e,he,!1),Re(o?2:0,i,t),t(r,i)}finally{Zr(s),Re(o?3:1,i,t)}}function rv(n,e,t){RB(n,e,t),(t.flags&64)===64&&xB(n,e,t)}function zd(n,e,t=cn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function DB(n,e,t,r){let s=r.get(x2,bI)||t===hs.ShadowDom,o=n.selectRootElement(e,s);return wB(o),o}function wB(n){n0(n)}var n0=()=>null;function IB(n){dI(n)?WI(n):j2(n)}function r0(){n0=IB}function AB(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function i0(n,e,t,r,i,s){let o=e[H];if(iv(n,o,e,t,r)){$n(n)&&MB(e,n.index);return}n.type&3&&(t=AB(t)),NB(n,e,t,r,i,s)}function NB(n,e,t,r,i,s){if(n.type&3){let o=cn(n,e);r=s!=null?s(r,n.value||"",t):r,i.setProperty(o,t,r)}else n.type&12}function MB(n,e){let t=ln(e,n);t[Z]&16||(t[Z]|=64)}function RB(n,e,t){let r=t.directiveStart,i=t.directiveEnd;$n(t)&&uB(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||bd(t,e);let s=t.initialInputs;for(let o=r;o<i;o++){let a=n.data[o],c=Sd(e,n,o,t);if(vo(c,e),s!==null&&FB(e,o-r,c,a,t,s),zn(a)){let l=ln(t.index,e);l[it]=Sd(e,n,o,t)}}}function xB(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=cw();try{Zr(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];od(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&OB(c,l)}}finally{Zr(-1),od(o)}}function OB(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function s0(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let s=t[i];X2(e,s.selectors,!1)&&(r??=[],zn(s)?r.unshift(s):r.push(s))}return r}function kB(n,e,t,r,i,s){let o=cn(n,e);PB(e[we],o,s,n.value,t,r,i)}function PB(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?pc(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function FB(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;a+=2){let c=o[a],l=o[a+1];hy(r,t,c,l)}}function o0(n,e,t,r,i){let s=he+t,o=e[H],a=i(o,e,n,r,t);e[s]=a,fo(n,!0);let c=n.type===2;return c?(KI(e[we],a,n),(YD()===0||Cc(n))&&vo(a,e),ZD()):vo(a,e),ud()&&(!c||!Bc(n))&&tv(o,e,a,n),n}function a0(n){let e=n;return Rm()?nw():(e=e.parent,fo(e,!1)),e}function LB(n,e){let t=n[es];if(!t)return;let r;try{r=t.get(bn,null)}catch{r=null}r?.(e)}function iv(n,e,t,r,i){let s=n.inputs?.[r],o=n.hostDirectiveInputs?.[r],a=!1;if(o)for(let c=0;c<o.length;c+=2){let l=o[c],u=o[c+1],d=e.data[l];hy(d,t[l],u,i),a=!0}if(s)for(let c of s){let l=t[c],u=e.data[c];hy(u,l,r,i),a=!0}return a}function BB(n,e){let t=ln(e,n),r=t[H];VB(r,t);let i=t[ze];i!==null&&t[an]===null&&(t[an]=RI(i,t[es])),Re(18),sv(r,t,t[it]),Re(19,t[it])}function VB(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function sv(n,e,t){ad(e);try{let r=n.viewQuery;r!==null&&dy(1,r,t);let i=n.template;i!==null&&t0(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[is]?.finishViewCreation(n),n.staticContentQueries&&BI(n,e),n.staticViewQueries&&dy(2,n.viewQuery,t);let s=n.components;s!==null&&UB(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[Z]&=-5,cd()}}function UB(n,e){for(let t=0;t<e.length;t++)BB(n,e[t])}function c0(n,e,t,r){let i=ee(null);try{let s=e.tView,a=n[Z]&4096?4096:16,c=Yy(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[ns]=l;let u=n[is];return u!==null&&(c[is]=u.createEmbeddedView(s)),sv(s,c,t),c}finally{ee(i)}}function gy(n,e){return!e||e.firstChild===null||Nc(n)}var Nw=!1,jB=new $("");function Eo(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&r.push(Me(s)),bt(s)&&Gd(s,r);let o=t.type;if(o&8)Eo(n,e,t.child,r);else if(o&32){let a=Jy(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=e0(e,t);if(Array.isArray(a))r.push(...a);else{let c=Wr(e[Ot]);Eo(c[H],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function Gd(n,e){for(let t=Ct;t<n.length;t++){let r=n[t],i=r[H].firstChild;i!==null&&Eo(r[H],r,i,e)}n[qn]!==n[ze]&&e.push(n[qn])}function l0(n){if(n[nd]!==null){for(let e of n[nd])e.impl.addSequence(e);n[nd].length=0}}var u0=[];function qB(n){return n[Wt]??HB(n)}function HB(n){let e=u0.pop()??Object.create(zB);return e.lView=n,e}function $B(n){n.lView[Wt]!==n&&(n.lView=null,u0.push(n))}var zB=Ce(K({},Ys),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Tc(n.lView)},consumerOnSignalRead(){this.lView[Wt]=this}});function GB(n){let e=n[Wt]??Object.create(WB);return e.lView=n,e}var WB=Ce(K({},Ys),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Wr(n.lView);for(;e&&!d0(e[H]);)e=Wr(e);e&&Sm(e)},consumerOnSignalRead(){this.lView[Wt]=this}});function d0(n){return n.type!==2}function f0(n){if(n[vc]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[vc])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[Z]&8192)}}var KB=100;function ov(n,e=0){let r=n[_r].rendererFactory,i=!1;i||r.begin?.();try{QB(n,e)}finally{i||r.end?.()}}function QB(n,e){let t=Om();try{km(!0),my(n,e);let r=0;for(;Sc(n);){if(r===KB)throw new Q(103,!1);r++,my(n,1)}}finally{km(t)}}function h0(n,e){xm(e?Dc.Exhaustive:Dc.OnlyDirtyViews);try{ov(n)}finally{xm(Dc.Off)}}function YB(n,e,t,r){if(os(e))return;let i=e[Z],s=!1,o=!1;ad(e);let a=!0,c=null,l=null;s||(d0(n)?(l=qB(e),c=Js(l)):vu()===null?(a=!1,l=GB(e),c=Js(l)):e[Wt]&&(nc(e[Wt]),e[Wt]=null));try{bm(e),iw(n.bindingStartIndex),t!==null&&t0(n,e,t,2,r);let u=(i&3)===3;if(!s)if(u){let h=n.preOrderCheckHooks;h!==null&&gd(e,h,null)}else{let h=n.preOrderHooks;h!==null&&md(e,h,0,null),Gm(e,0)}if(o||ZB(e),f0(e),p0(e,0),n.contentQueries!==null&&BI(n,e),!s)if(u){let h=n.contentCheckHooks;h!==null&&gd(e,h)}else{let h=n.contentHooks;h!==null&&md(e,h,1),Gm(e,1)}XB(n,e);let d=n.components;d!==null&&m0(e,d,0);let f=n.viewQuery;if(f!==null&&dy(2,f,r),!s)if(u){let h=n.viewCheckHooks;h!==null&&gd(e,h)}else{let h=n.viewHooks;h!==null&&md(e,h,2),Gm(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[td]){for(let h of e[td])h();e[td]=null}s||(l0(e),e[Z]&=-73)}catch(u){throw s||Tc(e),u}finally{l!==null&&(ec(l,c),a&&$B(l)),cd()}}function p0(n,e){for(let t=hI(n);t!==null;t=pI(t))for(let r=Ct;r<t.length;r++){let i=t[r];g0(i,e)}}function ZB(n){for(let e=hI(n);e!==null;e=pI(e)){if(!(e[Z]&2))continue;let t=e[_c];for(let r=0;r<t.length;r++){let i=t[r];Sm(i)}}}function JB(n,e,t){Re(18);let r=ln(e,n);g0(r,t),Re(19,r[it])}function g0(n,e){id(n)&&my(n,e)}function my(n,e){let r=n[H],i=n[Z],s=n[Wt],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&tc(s)),o||=!1,s&&(s.dirty=!1),n[Z]&=-9217,o)YB(r,n,r.template,n[it]);else if(i&8192){let a=ee(null);try{f0(n),p0(n,1);let c=r.components;c!==null&&m0(n,c,1),l0(n)}finally{ee(a)}}}function m0(n,e,t){for(let r=0;r<e.length;r++)JB(n,e[r],t)}function XB(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Zr(~i);else{let s=i,o=t[++r],a=t[++r];aw(o,s);let c=e[s];Re(24,c),a(2,c),Re(25,c)}}}finally{Zr(-1)}}function av(n,e){let t=Om()?64:1088;for(n[_r].changeDetectionScheduler?.notify(e);n;){n[Z]|=t;let r=Wr(n);if(Yr(n)&&!r)return n;n=r}return null}function y0(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function eV(n,e){let t=Ct+e;if(t<n.length)return n[t]}function v0(n,e,t,r=!0){let i=e[H];if(nV(i,e,n,t),r){let o=py(t,n),a=e[we],c=a.parentNode(n[qn]);c!==null&&pB(i,n[on],a,e,c,o)}let s=e[an];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function tV(n,e){let t=Dd(n,e);return t!==void 0&&ev(t[H],t),t}function Dd(n,e){if(n.length<=Ct)return;let t=Ct+e,r=n[t];if(r){let i=r[ns];i!==null&&i!==n&&Xy(i,r),e>0&&(n[t-1][sn]=r[sn]);let s=gc(n,Ct+e);hB(r[H],r);let o=s[is];o!==null&&o.detachView(s[H]),r[Xe]=null,r[sn]=null,r[Z]&=-129}return r}function nV(n,e,t,r){let i=Ct+r,s=t.length;r>0&&(t[i-1][sn]=e),r<s-Ct?(e[sn]=t[i],om(t,Ct+r,e)):(t.push(e),e[sn]=null),e[Xe]=t;let o=e[ns];o!==null&&t!==o&&E0(o,e);let a=e[is];a!==null&&a.insertView(n),sd(e),e[Z]|=128}function E0(n,e){let t=n[_c],r=e[Xe];if(Hn(r))n[Z]|=2;else{let i=r[Xe][Ot];e[Ot]!==i&&(n[Z]|=2)}t===null?n[_c]=[e]:t.push(e)}var ti=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[H];return Eo(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[it]}set context(e){this._lView[it]=e}get destroyed(){return os(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Xe];if(bt(e)){let t=e[Ec],r=t?t.indexOf(this):-1;r>-1&&(Dd(e,r),gc(t,r))}this._attachedToViewContainer=!1}ev(this._lView[H],this._lView)}onDestroy(e){Tm(this._lView,e)}markForCheck(){av(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Z]&=-129}reattach(){sd(this._lView),this._lView[Z]|=128}detectChanges(){this._lView[Z]|=1024,ov(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Q(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Yr(this._lView),t=this._lView[ns];t!==null&&!e&&Xy(t,this._lView),JI(this._lView[H],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Q(902,!1);this._appRef=e;let t=Yr(this._lView),r=this._lView[ns];r!==null&&!t&&E0(r,this._lView),sd(this._lView)}};var Vc=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=rV;constructor(t,r,i){this._declarationLView=t,this._declarationTContainer=r,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,r){return this.createEmbeddedViewImpl(t,r)}createEmbeddedViewImpl(t,r,i){let s=c0(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:r,dehydratedView:i});return new ti(s)}}return n})();function rV(){return iV(Pt(),Ie())}function iV(n,e){return n.type&4?new Vc(e,n,kd(n,e)):null}var yy="<-- AT THIS LOCATION";function sV(n){switch(n){case 4:return"view container";case 2:return"element";case 8:return"ng-container";case 32:return"icu";case 64:return"i18n";case 16:return"projection";case 1:return"text";case 128:return"@let";default:return"<unknown>"}}function oV(n,e){let t=`During serialization, Angular was unable to find an element in the DOM:

`,r=`${uV(n,e,!1)}

`,i=fV();throw new Q(-502,t+r+i)}function _0(n){let e="During serialization, Angular detected DOM nodes that were created outside of Angular context and provided as projectable nodes (likely via `ViewContainerRef.createComponent` or `createComponent` APIs). Hydration is not supported for such cases, consider refactoring the code to avoid this pattern or using `ngSkipHydration` on the host element of the component.\n\n",t=`${dV(n)}

`,r=e+t+hV();return new Q(-503,r)}function aV(n){let e=[];if(n.attrs)for(let t=0;t<n.attrs.length;){let r=n.attrs[t++];if(typeof r=="number")break;let i=n.attrs[t++];e.push(`${r}="${wd(i)}"`)}return e.join(" ")}var cV=new Set(["ngh","ng-version","ng-server-context"]);function lV(n){let e=[];for(let t=0;t<n.attributes.length;t++){let r=n.attributes[t];cV.has(r.name)||e.push(`${r.name}="${wd(r.value)}"`)}return e.join(" ")}function Ym(n,e="\u2026"){switch(n.type){case 1:return`#text${n.value?`(${n.value})`:""}`;case 2:let r=aV(n),i=n.value.toLowerCase();return`<${i}${r?" "+r:""}>${e}</${i}>`;case 8:return"<!-- ng-container -->";case 4:return"<!-- container -->";default:return`#node(${sV(n.type)})`}}function yd(n,e="\u2026"){let t=n;switch(t.nodeType){case Node.ELEMENT_NODE:let r=t.tagName.toLowerCase(),i=lV(t);return`<${r}${i?" "+i:""}>${e}</${r}>`;case Node.TEXT_NODE:let s=t.textContent?wd(t.textContent):"";return`#text${s?`(${s})`:""}`;case Node.COMMENT_NODE:return`<!-- ${wd(t.textContent??"")} -->`;default:return`#node(${t.nodeType})`}}function uV(n,e,t){let i="";e.prev?(i+=`  \u2026
`,i+="  "+Ym(e.prev)+`
`):e.type&&e.type&12&&(i+=`  \u2026
`),t?(i+="  "+Ym(e)+`
`,i+=`  <!-- container -->  ${yy}
`):i+="  "+Ym(e)+`  ${yy}
`,i+=`  \u2026
`;let s=e.type?XI(n[H],e,n):null;return s&&(i=yd(s,`
`+i)),i}function dV(n){let t="",r=n;return r.previousSibling&&(t+=`  \u2026
`,t+="  "+yd(r.previousSibling)+`
`),t+="  "+yd(r)+`  ${yy}
`,n.nextSibling&&(t+=`  \u2026
`),n.parentNode&&(t=yd(r.parentNode,`
`+t)),t}function fV(n){return`To fix this problem:
  * check ${n?`the "${n}"`:"corresponding"} component for hydration-related issues
  * check to see if your template has valid HTML structure
  * or skip hydration by adding the \`ngSkipHydration\` attribute to its host node in a template

`}function hV(){return`Note: attributes are only displayed to better represent the DOM but have no effect on hydration mismatches.

`}function pV(n){return n.replace(/\s+/gm,"")}function wd(n,e=50){return n?(n=pV(n),n.length>e?`${n.substring(0,e-1)}\u2026`:n):""}function Uc(n,e,t,r,i){let s=n.data[e];if(s===null)s=gV(n,e,t,r,i),ow()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=tw();s.injectorIndex=o===null?-1:o.injectorIndex}return fo(s,!0),s}function gV(n,e,t,r,i){let s=Mm(),o=Rm(),a=o?s:s&&s.parent,c=n.data[e]=yV(n,a,t,e,r,i);return mV(n,c,s,o),c}function mV(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function yV(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return Im()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function vV(n,e){let t=e[n.currentCaseLViewIndex];return t===null?t:t<0?~t:t}function C0(n,e,t){n.index=0;let r=vV(e,t);r!==null?n.removes=e.remove[r]:n.removes=Vt}function vy(n){if(n.index<n.removes.length){let e=n.removes[n.index++];if(e>0)return n.lView[e];{n.stack.push(n.index,n.removes);let t=~e,r=n.lView[H].data[t];return C0(n,r,n.lView),vy(n)}}else return n.stack.length===0?null:(n.removes=n.stack.pop(),n.index=n.stack.pop(),vy(n))}function EV(n,e){let t={stack:[],index:-1,lView:e};return C0(t,n,e),vy.bind(null,t)}var _V=new RegExp(`^(\\d+)*(${Fy}|${Py})*(.*)`);function CV(n,e){let t=[n];for(let r of e){let i=t.length-1;if(i>0&&t[i-1]===r){let s=t[i]||1;t[i]=s+1}else t.push(r,"")}return t.join("")}function bV(n){let e=n.match(_V),[t,r,i,s]=e,o=r?parseInt(r,10):i,a=[];for(let[c,l,u]of s.matchAll(/(f|n)(\d*)/g)){let d=parseInt(u,10)||1;a.push(l,d)}return[o,...a]}function SV(n){return!n.prev&&n.parent?.type===8}function Zm(n){return n.index-he}function Ao(n,e){return!(n.type&144)&&!!e[n.index]&&b0(Me(e[n.index]))}function b0(n){return!!n&&!n.isConnected}function TV(n,e){let t=n.i18nNodes;if(t)return t.get(e)}function Wd(n,e,t,r){let i=Zm(r),s=TV(n,i);if(s===void 0){let o=n.data[Ud];if(o?.[i])s=wV(o[i],t);else if(e.firstChild===r)s=n.firstChild;else{let a=r.prev===null,c=r.prev??r.parent;if(SV(r)){let l=Zm(r.parent);s=uy(n,l)}else{let l=cn(c,t);if(a)s=l.firstChild;else{let u=Zm(c),d=uy(n,u);if(c.type===2&&d){let h=$y(n,u)+1;s=Kd(h,d)}else s=l.nextSibling}}}}return s}function Kd(n,e){let t=e;for(let r=0;r<n;r++)t=t.nextSibling;return t}function DV(n,e){let t=n;for(let r=0;r<e.length;r+=2){let i=e[r],s=e[r+1];for(let o=0;o<s;o++)switch(i){case vI:t=t.firstChild;break;case EI:t=t.nextSibling;break}}return t}function wV(n,e){let[t,...r]=bV(n),i;if(t===Py)i=e[Ot][ze];else if(t===Fy)i=UI(e[Ot][ze]);else{let s=Number(t);i=Me(e[s+he])}return DV(i,r)}function Ey(n,e){if(n===e)return[];if(n.parentElement==null||e.parentElement==null)return null;if(n.parentElement===e.parentElement)return IV(n,e);{let t=e.parentElement,r=Ey(n,t),i=Ey(t.firstChild,e);return!r||!i?null:[...r,vI,...i]}}function IV(n,e){let t=[],r=null;for(r=n;r!=null&&r!==e;r=r.nextSibling)t.push(EI);return r==null?null:t}function Mw(n,e,t){let r=Ey(n,e);return r===null?null:CV(t,r)}function S0(n,e,t){let r=n.parent,i,s,o;for(;r!==null&&(Ao(r,e)||t?.has(r.index));)r=r.parent;r===null||!(r.type&3)?(i=o=Py,s=e[Ot][ze]):(i=r.index,s=Me(e[i]),o=pc(i-he));let a=Me(e[n.index]);if(n.type&44){let l=us(e,n);l&&(a=l)}let c=Mw(s,a,o);if(c===null&&s!==a){let l=s.ownerDocument.body;if(c=Mw(l,a,Fy),c===null)throw oV(e,n)}return c}var T0=!1;function D0(n){T0=n}function w0(){return T0}function I0(n){return n=n??G(nn),n.get(SI,!1)}function A0(n,e){let t=e.i18nChildren.get(n);return t===void 0&&(t=AV(n),e.i18nChildren.set(n,t)),t}function AV(n){let e=new Set;function t(r){switch(e.add(r.index),r.kind){case 1:case 2:{for(let i of r.children)t(i);break}case 3:{for(let i of r.cases)for(let s of i)t(s);break}}}for(let r=he;r<n.bindingStartIndex;r++){let i=n.data[r];if(!(!i||!i.ast))for(let s of i.ast)t(s)}return e.size===0?null:e}function N0(n,e,t){if(!t.isI18nHydrationEnabled)return null;let r=n[H],i=r.data[e];if(!i||!i.ast)return null;let s=r.data[i.parentTNodeIndex];if(s&&b2(s))return null;let o={caseQueue:[],disconnectedNodes:new Set,disjointNodes:new Set};return _y(n,o,t,i.ast),o.caseQueue.length===0&&o.disconnectedNodes.size===0&&o.disjointNodes.size===0?null:o}function _y(n,e,t,r){let i=null;for(let s of r){let o=MV(n,e,t,s);o&&(NV(i,o)&&e.disjointNodes.add(s.index-he),i=o)}return i}function NV(n,e){return n&&n.nextSibling!==e}function MV(n,e,t,r){let i=Me(n[r.index]);if(!i||b0(i))return e.disconnectedNodes.add(r.index-he),null;let s=i;switch(r.kind){case 0:{zy(t,s);break}case 1:case 2:{_y(n,e,t,r.children);break}case 3:{let o=n[r.currentCaseLViewIndex];if(o!=null){let a=o<0?~o:o;e.caseQueue.push(a),_y(n,e,t,r.cases[a])}break}}return RV(n,r)}function RV(n,e){let r=n[H].data[e.index];return Ry(r)?us(n,r):e.kind===3?EV(r,n)()??Me(n[e.index]):Me(n[e.index])??null}function M0(n){let e=n[ss]??[],r=n[Xe][we],i=[];for(let s of e)s.data[By]!==void 0?i.push(s):xV(s,r);n[ss]=i}function xV(n,e){let t=0,r=n.firstChild;if(r){let i=n.data[ei];for(;t<i;){let s=r.nextSibling;GI(e,r,!1),r=s,t++}}}function OV(n,e){let t=[];for(let r of e)for(let i=0;i<(r[Lc]??1);i++){let s={data:r,firstChild:null};r[ei]>0&&(s.firstChild=n,n=Kd(r[ei],n)),t.push(s)}return[n,t]}var R0=()=>null,x0=()=>null;function O0(){R0=kV,x0=PV}function kV(n,e){return k0(n,e)?n[ss].shift():(M0(n),null)}function Cy(n,e){return R0(n,e)}function PV(n,e,t){if(e.tView.ssrId===null)return null;let r=Cy(n,e.tView.ssrId);return t[H].firstUpdatePass&&r===null&&LV(t,e),r}function FV(n,e,t){return x0(n,e,t)}function LV(n,e){let t=e;for(;t;){if(Rw(n,t))return;if((t.flags&256)===256)break;t=t.prev}for(t=e.next;t&&(t.flags&512)===512;){if(Rw(n,t))return;t=t.next}}function k0(n,e){let t=n[ss];return!e||t===null||t.length===0?!1:t[0].data[Vd]===e}function Rw(n,e){let t=e.tView?.ssrId;if(t==null)return!1;let r=n[e.index];return bt(r)&&k0(r,t)?(M0(r),!0):!1}var P0=class{},Qd=class{},by=class{resolveComponentFactory(e){throw new Q(917,!1)}},jc=class{static NULL=new by},Rc=class{},No=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>BV()}return n})();function BV(){let n=Ie(),e=Pt(),t=ln(e.index,n);return(Hn(t)?t:n)[we]}var F0=(()=>{class n{static \u0275prov=ve({token:n,providedIn:"root",factory:()=>null})}return n})();var vd={},Sy=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let i=this.injector.get(e,vd,r);return i!==vd||t===vd?i:this.parentInjector.get(e,t,r)}};function Id(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=Qg(i,a);else if(s==2){let c=a,l=e[++o];r=Qg(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function de(n,e=0){let t=Ie();if(t===null)return $e(n,e);let r=Pt();return cI(r,t,pt(n),e)}function L0(n,e,t,r,i){let s=r===null?null:{"":-1},o=i(n,t);if(o!==null){let a=o,c=null,l=null;for(let u of o)if(u.resolveHostDirectives!==null){[a,c,l]=u.resolveHostDirectives(o);break}jV(n,e,t,a,s,c,l)}s!==null&&r!==null&&VV(t,r,s)}function VV(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new Q(-301,!1);r.push(e[i],s)}}function UV(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function jV(n,e,t,r,i,s,o){let a=r.length,c=!1;for(let f=0;f<a;f++){let h=r[f];!c&&zn(h)&&(c=!0,UV(n,t,f)),oy(bd(t,e),n,h.type)}WV(t,n.data.length,a);for(let f=0;f<a;f++){let h=r[f];h.providersResolver&&h.providersResolver(h)}let l=!1,u=!1,d=YI(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let f=0;f<a;f++){let h=r[f];if(t.mergedAttrs=yo(t.mergedAttrs,h.hostAttrs),HV(n,t,e,d,h),GV(d,h,i),o!==null&&o.has(h)){let[b,T]=o.get(h);t.directiveToIndex.set(h.type,[d,b+t.directiveStart,T+t.directiveStart])}else(s===null||!s.has(h))&&t.directiveToIndex.set(h.type,d);h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let _=h.type.prototype;!l&&(_.ngOnChanges||_.ngOnInit||_.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),l=!0),!u&&(_.ngOnChanges||_.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),u=!0),d++}qV(n,t,s)}function qV(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))xw(0,e,i,r),xw(1,e,i,r),kw(e,r,!1);else{let s=t.get(i);Ow(0,e,s,r),Ow(1,e,s,r),kw(e,r,!0)}}}function xw(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o;n===0?o=e.inputs??={}:o=e.outputs??={},o[s]??=[],o[s].push(r),B0(e,s)}}function Ow(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o=i[s],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[o]??=[],a[o].push(r,s),B0(e,o)}}function B0(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function kw(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:s}=n;if(r===null||!t&&i===null||t&&s===null||Wy(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let o=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&i.hasOwnProperty(c)){let l=i[c];for(let u of l)if(u===e){o??=[],o.push(c,r[a+1]);break}}else if(t&&s.hasOwnProperty(c)){let l=s[c];for(let u=0;u<l.length;u+=2)if(l[u]===e){o??=[],o.push(l[u+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(o)}function HV(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Ki(i.type,!0)),o=new fs(s,zn(i),de,null);n.blueprint[r]=o,t[r]=o,$V(n,e,r,YI(n,t,i.hostVars,br),i)}function $V(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;zV(o)!=a&&o.push(a),o.push(t,r,s)}}function zV(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function GV(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;zn(e)&&(t[""]=n)}}function WV(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function V0(n,e,t,r,i,s,o,a){let c=e[H],l=c.consts,u=Gn(l,o),d=Uc(c,n,t,r,u);return s&&L0(c,e,d,Gn(l,a),i),d.mergedAttrs=yo(d.mergedAttrs,d.attrs),d.attrs!==null&&Id(d,d.attrs,!1),d.mergedAttrs!==null&&Id(d,d.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,d),d}function U0(n,e){Xw(n,e),Em(e)&&n.queries.elementEnd(e)}function KV(n,e,t,r,i,s){let o=e.consts,a=Gn(o,i),c=Uc(e,n,t,r,a);if(c.mergedAttrs=yo(c.mergedAttrs,c.attrs),s!=null){let l=Gn(o,s);c.localNames=[];for(let u=0;u<l.length;u+=2)c.localNames.push(l[u],-1)}return c.attrs!==null&&Id(c,c.attrs,!1),c.mergedAttrs!==null&&Id(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function cv(n){return q0(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function j0(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function q0(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Mo(n,e,t){if(t===br)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function Jm(n,e,t){return function r(i){let s=$n(n)?ln(n.index,e):e;av(s,5);let o=e[it],a=Pw(e,o,t,i),c=r.__ngNextListenerFn__;for(;c;)a=Pw(e,o,c,i)&&a,c=c.__ngNextListenerFn__;return a}}function Pw(n,e,t,r){let i=ee(null);try{return Re(6,e,t),t(r)!==!1}catch(s){return LB(n,s),!1}finally{Re(7,e,t),ee(i)}}function QV(n,e,t,r,i,s,o,a){let c=Cc(n),l=!1,u=null;if(!r&&c&&(u=YV(e,t,s,n.index)),u!==null){let d=u.__ngLastListenerFn__||u;d.__ngNextListenerFn__=o,u.__ngLastListenerFn__=o,l=!0}else{let d=cn(n,t),f=r?r(d):d;F2(t,f,s,a);let h=i.listen(f,s,a),_=r?b=>r(Me(b[n.index])):n.index;H0(_,e,t,s,a,h,!1)}return l}function YV(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Xi],c=i[s+2];return a&&a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function H0(n,e,t,r,i,s,o){let a=e.firstCreatePass?QD(e):null,c=KD(t),l=c.length;c.push(i,s),a&&a.push(r,n,l,(l+1)*(o?-1:1))}function Fw(n,e,t,r,i,s){let o=e[t],a=e[H],l=a.data[t].outputs[r],d=o[l].subscribe(s);H0(n.index,a,e,i,s,d,!0)}var Ty=Symbol("BINDING");var Ad=class extends jc{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Er(e);return new _o(t,this.ngModule)}};function ZV(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],s={propName:t,templateName:e,isSignal:(r&Hd.SignalBased)!==0};return i&&(s.transform=i),s})}function JV(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function XV(n,e,t){let r=e instanceof tn?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new Sy(t,r):t}function eU(n){let e=n.get(Rc,null);if(e===null)throw new Q(407,!1);let t=n.get(F0,null),r=n.get(jn,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function tU(n,e){let t=$0(n);return Ky(e,t,t==="svg"?qD:t==="math"?HD:null)}function $0(n){return(n.selectors[0][0]||"div").toLowerCase()}var _o=class extends Qd{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=ZV(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=JV(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=rB(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i,s,o){Re(22);let a=ee(null);try{let c=this.componentDef,l=nU(r,c,o,s),u=XV(c,i||this.ngModule,e),d=eU(u),f=d.rendererFactory.createRenderer(null,c),h=r?DB(f,r,c.encapsulation,u):tU(c,f),_=o?.some(Lw)||s?.some(D=>typeof D!="function"&&D.bindings.some(Lw)),b=Yy(null,l,null,512|QI(c),null,null,d,f,u,null,RI(h,u,!0));b[he]=h,ad(b);let T=null;try{let D=V0(he,b,2,"#host",()=>l.directiveRegistry,!0,0);h&&(KI(f,h,D),vo(h,b)),rv(l,b,D),VI(l,D,b),U0(l,D),t!==void 0&&iU(D,this.ngContentSelectors,t),T=ln(D.index,b),b[it]=T[it],sv(l,b,null)}catch(D){throw T!==null&&cy(T),cy(b),D}finally{Re(23),cd()}return new Nd(this.componentType,b,!!_)}finally{ee(a)}}};function nU(n,e,t,r){let i=n?["ng-version","20.2.4"]:iB(e.selectors[0]),s=null,o=null,a=0;if(t)for(let u of t)a+=u[Ty].requiredVars,u.create&&(u.targetIdx=0,(s??=[]).push(u)),u.update&&(u.targetIdx=0,(o??=[]).push(u));if(r)for(let u=0;u<r.length;u++){let d=r[u];if(typeof d!="function")for(let f of d.bindings){a+=f[Ty].requiredVars;let h=u+1;f.create&&(f.targetIdx=h,(s??=[]).push(f)),f.update&&(f.targetIdx=h,(o??=[]).push(f))}}let c=[e];if(r)for(let u of r){let d=typeof u=="function"?u:u.type,f=um(d);c.push(f)}return Qy(0,null,rU(s,o),1,a,c,null,null,null,[i],null)}function rU(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function Lw(n){let e=n[Ty].kind;return e==="input"||e==="twoWay"}var Nd=class extends P0{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=bc(t[H],he),this.location=kd(this._tNode,t),this.instance=ln(this._tNode.index,t)[it],this.hostView=this.changeDetectorRef=new ti(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,s=iv(r,i[H],i,e,t);this.previousInputValues.set(e,t);let o=ln(r.index,i);av(o,1)}get injector(){return new ds(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function iU(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null&&s.length?Array.from(s):null)}}var qc=(()=>{class n{static __NG_ELEMENT_ID__=sU}return n})();function sU(){let n=Pt();return aU(n,Ie())}var oU=qc,z0=class extends oU{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return kd(this._hostTNode,this._hostLView)}get injector(){return new ds(this._hostTNode,this._hostLView)}get parentInjector(){let e=xy(this._hostTNode,this._hostLView);if(nI(e)){let t=Cd(e,this._hostLView),r=_d(e),i=t[H].data[r+8];return new ds(i,t)}else return new ds(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=Bw(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Ct}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=Cy(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,gy(this._hostTNode,o)),a}createComponent(e,t,r,i,s,o,a){let c=e&&!e2(e),l;if(c)l=t;else{let T=t||{};l=T.index,r=T.injector,i=T.projectableNodes,s=T.environmentInjector||T.ngModuleRef,o=T.directives,a=T.bindings}let u=c?e:new _o(Er(e)),d=r||this.parentInjector;if(!s&&u.ngModule==null){let D=(c?d:this.parentInjector).get(tn,null);D&&(s=D)}let f=Er(u.componentType??{}),h=Cy(this._lContainer,f?.id??null),_=h?.firstChild??null,b=u.create(d,i,_,s,o,a);return this.insertImpl(b.hostView,l,gy(this._hostTNode,h)),b}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(zD(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Xe],l=new z0(c,c[on],c[Xe]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return v0(o,i,s,r),e.attachToViewContainerRef(),om(Xm(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=Bw(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Dd(this._lContainer,t);r&&(gc(Xm(this._lContainer),t),ev(r[H],r))}detach(e){let t=this._adjustIndex(e,-1),r=Dd(this._lContainer,t);return r&&gc(Xm(this._lContainer),t)!=null?new ti(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function Bw(n){return n[Ec]}function Xm(n){return n[Ec]||(n[Ec]=[])}function aU(n,e){let t,r=e[n.index];return bt(r)?t=r:(t=y0(r,e,null,n),e[n.index]=t,Zy(e,t)),G0(t,e,n,r),new z0(t,n,e)}function cU(n,e){let t=n[we],r=t.createComment(""),i=cn(e,n),s=t.parentNode(i);return Td(t,s,r,t.nextSibling(i),!1),r}var G0=W0,lv=()=>!1;function lU(n,e,t){return lv(n,e,t)}function W0(n,e,t,r){if(n[qn])return;let i;t.type&8?i=Me(r):i=cU(e,t),n[qn]=i}function uU(n,e,t){if(n[qn]&&n[ss])return!0;let r=t[an],i=e.index-he;if(!r||Do(e)||PI(r,i))return!1;let o=uy(r,i),a=r.data[wo]?.[i],[c,l]=OV(o,a);return n[qn]=c,n[ss]=l,!0}function dU(n,e,t,r){lv(n,t,e)||W0(n,e,t,r)}function K0(){G0=dU,lv=uU}function Q0(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(a=>hU(i,a)))}return s}return Md.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,u=i.styleUrls;i.styleUrls.forEach((d,f)=>{a.push(""),o.push(r(d).then(h=>{a[l+f]=h,u.splice(u.indexOf(d),1),u.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>pU(s));e.push(c)}),Y0(),Promise.all(e).then(()=>{})}var Md=new Map,fU=new Set;function Y0(){let n=Md;return Md=new Map,n}function Z0(){return Md.size===0}function hU(n,e){return typeof e=="string"?e:e.status!==void 0&&e.status!==200?Promise.reject(new Q(918,!1)):e.text()}function pU(n){fU.delete(n)}var Vw=new Set;function Sr(n){Vw.has(n)||(Vw.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var ps=class{},J0=class{};var xc=class extends ps{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Ad(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let s=lm(e);this._bootstrapComponents=jI(s.bootstrap),this._r3Injector=Vm(e,t,[{provide:ps,useValue:this},{provide:jc,useValue:this.componentFactoryResolver},...r],yr(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Oc=class extends J0{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new xc(this.moduleType,e,[])}};function X0(n,e,t){return new xc(n,e,t,!1)}var kc=class extends ps{injector;componentFactoryResolver=new Ad(this);instance=null;constructor(e){super();let t=new Yi([...e.providers,{provide:ps,useValue:this},{provide:jc,useValue:this.componentFactoryResolver}],e.parent||mc(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function eA(n,e,t=null){return new kc({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var gU=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=dm(!1,t.type),i=r.length>0?eA([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=ve({token:n,providedIn:"environment",factory:()=>new n($e(tn))})}return n})();function mU(n){return So(()=>{let e=tA(n),t=Ce(K({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===ky.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(gU).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||hs.Emulated,styles:n.styles||Vt,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Sr("NgStandalone"),nA(t);let r=n.dependencies;return t.directiveDefs=Uw(r,yU),t.pipeDefs=Uw(r,PD),t.id=CU(t),t})}function yU(n){return Er(n)||um(n)}function vs(n){return So(()=>({type:n.type,bootstrap:n.bootstrap||Vt,declarations:n.declarations||Vt,imports:n.imports||Vt,exports:n.exports||Vt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function vU(n,e){if(n==null)return Qr;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a,c;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s,c=i[3]||null):(s=i,o=i,a=Hd.None,c=null),t[s]=[r,a,c],e[s]=o}return t}function EU(n){if(n==null)return Qr;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function st(n){return So(()=>{let e=tA(n);return nA(e),e})}function tA(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Qr,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Vt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:vU(n.inputs,e),outputs:EU(n.outputs),debugInfo:null}}function nA(n){n.features?.forEach(e=>e(n))}function Uw(n,e){return n?()=>{let t=typeof n=="function"?n():n,r=[];for(let i of t){let s=e(i);s!==null&&r.push(s)}return r}:null}var _U=new Map;function CU(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let s of r.join("|"))e=Math.imul(31,e)+s.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function bU(n){return Object.getPrototypeOf(n.prototype).constructor}function Kt(n){let e=bU(n.type),t=!0,r=[n];for(;e;){let i;if(zn(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Q(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=ey(n.inputs),o.declaredInputs=ey(n.declaredInputs),o.outputs=ey(n.outputs);let a=i.hostBindings;a&&IU(n,a);let c=i.viewQuery,l=i.contentQueries;if(c&&DU(n,c),l&&wU(n,l),SU(n,i),ID(n.outputs,i.outputs),zn(i)&&i.data.animation){let u=n.data;u.animation=(u.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===Kt&&(t=!1)}}e=Object.getPrototypeOf(e)}TU(r)}function SU(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t])}}function TU(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=yo(i.hostAttrs,t=yo(t,i.hostAttrs))}}function ey(n){return n===Qr?{}:n===Vt?[]:n}function DU(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function wU(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function IU(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function rA(n,e,t,r,i,s,o,a){if(t.firstCreatePass){n.mergedAttrs=yo(n.mergedAttrs,n.attrs);let u=n.tView=Qy(2,n,i,s,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),u.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),fo(n,!1);let c=oA(t,e,n,r);ud()&&tv(t,e,c,n),vo(c,e);let l=y0(c,e,c,n);e[r+he]=l,Zy(e,l),lU(l,n,e)}function AU(n,e,t,r,i,s,o,a,c,l,u){let d=t+he,f;return e.firstCreatePass?(f=Uc(e,d,4,o||null,a||null),wm()&&L0(e,n,f,Gn(e.consts,l),s0),Xw(e,f)):f=e.data[d],rA(f,n,e,t,r,i,s,c),Cc(f)&&rv(e,n,f),l!=null&&zd(n,f,u),f}function iA(n,e,t,r,i,s,o,a,c,l,u){let d=t+he,f;if(e.firstCreatePass){if(f=Uc(e,d,4,o||null,a||null),l!=null){let h=Gn(e.consts,l);f.localNames=[];for(let _=0;_<h.length;_+=2)f.localNames.push(h[_],-1)}}else f=e.data[d];return rA(f,n,e,t,r,i,s,c),l!=null&&zd(n,f,u),f}function sA(n,e,t,r,i,s,o,a){let c=Ie(),l=kt(),u=Gn(l.consts,s);return AU(c,l,n,e,t,r,i,u,void 0,o,a),sA}var oA=aA;function aA(n,e,t,r){return Cr(!0),e[we].createComment("")}function NU(n,e,t,r){let i=!qd(e,t);Cr(i);let s=e[an]?.data[Bd]?.[r]??null;if(s!==null&&t.tView!==null&&t.tView.ssrId===null&&(t.tView.ssrId=s),i)return aA(n,e);let o=e[an],a=Wd(o,n,e,t);jd(o,r,a);let c=$y(o,r);return Kd(c,a)}function cA(){oA=NU}var uv=1;var dv=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(dv||{}),fv=new $(""),lA=!1,Dy=class extends Cn{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,gm()&&(this.destroyRef=G(ls,{optional:!0})??void 0,this.pendingTasks=G(Xr,{optional:!0})??void 0)}emit(e){let t=ee(null);try{super.next(e)}finally{ee(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof rt&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},St=Dy;function uA(n){let e,t;function r(){n=Ic;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function jw(n){return queueMicrotask(()=>n()),()=>{n=Ic}}var hv="isAngularZone",Rd=hv+"_ID",MU=0,gt=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new St(!1);onMicrotaskEmpty=new St(!1);onStable=new St(!1);onError=new St(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=lA}=e;if(typeof Zone>"u")throw new Q(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,OU(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(hv)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Q(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Q(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,RU,Ic,Ic);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},RU={};function pv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function xU(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){uA(()=>{n.callbackScheduled=!1,wy(n),n.isCheckStableRunning=!0,pv(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),wy(n)}function OU(n){let e=()=>{xU(n)},t=MU++;n._inner=n._inner.fork({name:"angular",properties:{[hv]:!0,[Rd]:t,[Rd+t]:!0},onInvokeTask:(r,i,s,o,a,c)=>{if(kU(c))return r.invokeTask(s,o,a,c);try{return qw(n),r.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),Hw(n)}},onInvoke:(r,i,s,o,a,c,l)=>{try{return qw(n),r.invoke(s,o,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!PU(c)&&e(),Hw(n)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&(o.change=="microTask"?(n._hasPendingMicrotasks=o.microTask,wy(n),pv(n)):o.change=="macroTask"&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}function wy(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function qw(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Hw(n){n._nesting--,pv(n)}var Co=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new St;onMicrotaskEmpty=new St;onStable=new St;onError=new St;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function kU(n){return dA(n,"__ignore_ng_zone__")}function PU(n){return dA(n,"__scheduler_tick__")}function dA(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}function fA(n="zone.js",e){return n==="noop"?new Co:n==="zone.js"?new gt(e):n}var hA=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=ve({token:n,providedIn:"root",factory:()=>new n})}return n})();function gv(n){return n+1}function pA(n,e){let t=n[H],r=gv(e.index);return n[r]}function mv(n,e){let t=gv(e.index);return n.data[t]}function FU(n){return n!==null&&typeof n=="object"&&typeof n.primaryTmplIndex=="number"}function gA(n,e){let t=null,r=gv(e.index);return he<r&&r<n.bindingStartIndex&&(t=mv(n,e)),!!t&&FU(t)}var LU=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var mA=new $(""),yA=new $(""),BU=(()=>{class n{_ngZone;registry;_isZoneStable=!0;_callbacks=[];_taskTrackingZone=null;_destroyRef;constructor(t,r,i){this._ngZone=t,this.registry=r,gm()&&(this._destroyRef=G(ls,{optional:!0})??void 0),yv||(EA(i),i.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this._taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){let t=this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),r=this._ngZone.runOutsideAngular(()=>this._ngZone.onStable.subscribe({next:()=>{gt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}}));this._destroyRef?.onDestroy(()=>{t.unsubscribe(),r.unsubscribe()})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>r.updateCb&&r.updateCb(t)?(clearTimeout(r.timeoutId),!1):!0)}}getPendingTasks(){return this._taskTrackingZone?this._taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t()},r)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:i})}whenStable(t,r,i){if(i&&!this._taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,i){return[]}static \u0275fac=function(r){return new(r||n)($e(gt),$e(vA),$e(yA))};static \u0275prov=ve({token:n,factory:n.\u0275fac})}return n})(),vA=(()=>{class n{_applications=new Map;registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return yv?.findTestabilityInTree(this,t,r)??null}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function EA(n){yv=n}var yv;function Ro(n){return!!n&&typeof n.then=="function"}function vv(n){return!!n&&typeof n.subscribe=="function"}var _A=new $("");var Ev=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=G(_A,{optional:!0})??[];injector=G(nn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=ed(this.injector,i);if(Ro(s))t.push(s);else if(vv(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),CA=new $("");function _v(){Eg(()=>{let n="";throw new Q(600,n)})}function bA(n){return n.isBoundToModule}var VU=10;function Cv(n,e){return Array.isArray(e)?e.reduce(Cv,n):K(K({},n),e)}var Es=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=G(bn);afterRenderManager=G(hA);zonelessEnabled=G(wc);rootEffectScheduler=G($m);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new Cn;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=G(Xr);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(gr(t=>!t))}constructor(){G(fv,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=G(tn);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=nn.NULL){return this._injector.get(gt).run(()=>{Re(10);let o=t instanceof Qd;if(!this._injector.get(Ev).done){let _="";throw new Q(405,_)}let c;o?c=t:c=this._injector.get(jc).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let l=bA(c)?void 0:this._injector.get(ps),u=r||c.selector,d=c.create(i,[],u,l),f=d.location.nativeElement,h=d.injector.get(mA,null);return h?.registerApplication(f),d.onDestroy(()=>{this.detachView(d.hostView),Ac(this.components,d),h?.unregisterApplication(f)}),this._loadComponent(d),Re(11,d),d})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Re(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(dv.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new Q(101,!1);let t=ee(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,ee(t),this.afterTick.next(),Re(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Rc,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<VU;)Re(14),this.synchronizeOnce(),Re(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!Sc(i))continue;let s=r&&!this.zonelessEnabled?0:1;ov(i,s),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Sc(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Ac(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(t),this._injector.get(CA,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Ac(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Q(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ac(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Hc(n,e,t,r){let i=Ie(),s=ho();if(Mo(i,s,e)){let o=kt(),a=ld();kB(a,i,n,e,t,r)}return Hc}var UU=new $("",{providedIn:"root",factory:()=>!1}),jU=new $("",{providedIn:"root",factory:()=>qU}),qU=4e3;function HU(n,e,t,r,i,s,o,a){Sr("NgControlFlow");let c=Ie(),l=kt(),u=Gn(l.consts,s);return iA(c,l,n,e,t,r,i,u,256,o,a),bv}function bv(n,e,t,r,i,s,o,a){Sr("NgControlFlow");let c=Ie(),l=kt(),u=Gn(l.consts,s);return iA(c,l,n,e,t,r,i,u,512,o,a),bv}function $U(n,e){Sr("NgControlFlow");let t=Ie(),r=ho(),i=t[r]!==br?t[r]:-1,s=i!==-1?$w(t,he+i):void 0,o=0;if(Mo(t,r,n)){let a=ee(null);try{if(s!==void 0&&tV(s,o),n!==-1){let c=he+n,l=$w(t,c),u=zU(t[H],c),d=FV(l,u,t),f=c0(t,u,e,{dehydratedView:d});v0(l,f,o,gy(u,d))}}finally{ee(a)}}else if(s!==void 0){let a=eV(s,o);a!==void 0&&(a[it]=e)}}function $w(n,e){return n[e]}function zU(n,e){return bc(n,e)}function SA(n,e,t){let r=Ie(),i=ho();if(Mo(r,i,e)){let s=kt(),o=ld();i0(o,r,n,e,r[we],t)}return SA}function zw(n,e,t,r,i){iv(e,n,t,i?"class":"style",r)}function Sv(n,e,t,r){let i=Ie(),s=i[H],o=n+he,a=s.firstCreatePass?V0(o,i,2,e,s0,wm(),t,r):s.data[o];if(o0(a,i,n,e,Dv),Cc(a)){let c=i[H];rv(c,i,a),VI(c,a,i)}return r!=null&&zd(i,a),Sv}function Tv(){let n=kt(),e=Pt(),t=a0(e);return n.firstCreatePass&&U0(n,t),Am(t)&&Nm(),Dm(),t.classesWithoutHost!=null&&o2(t)&&zw(n,t,Ie(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&a2(t)&&zw(n,t,Ie(),t.stylesWithoutHost,!1),Tv}function TA(n,e,t,r){return Sv(n,e,t,r),Tv(),TA}function DA(n,e,t,r){let i=Ie(),s=i[H],o=n+he,a=s.firstCreatePass?KV(o,s,2,e,t,r):s.data[o];return o0(a,i,n,e,Dv),r!=null&&zd(i,a),DA}function wA(){let n=Pt(),e=a0(n);return Am(e)&&Nm(),Dm(),wA}var Dv=(n,e,t,r,i)=>(Cr(!0),Ky(e[we],r,Bm()));function GU(n,e,t,r,i){let s=!qd(e,t);if(Cr(s),s)return Ky(e[we],r,Bm());let o=e[an],a=Wd(o,n,e,t);return kI(o,i)&&jd(o,i,a.nextSibling),o&&(Oy(t)||dI(a))&&$n(t)&&(JD(t),WI(a)),a}function IA(){Dv=GU}var WU=(n,e,t,r,i)=>(Cr(!0),$I(e[we],""));function KU(n,e,t,r,i){let s,o=!qd(e,t);if(Cr(o),o)return $I(e[we],"");let a=e[an],c=Wd(a,n,e,t),l=q2(a,i);return jd(a,i,c),s=Kd(l,c),s}function AA(){WU=KU}function QU(){return Ie()}var $c="en-US";var YU=$c;function NA(n){typeof n=="string"&&(YU=n.toLowerCase().replace(/_/g,"-"))}function xo(n,e,t){let r=Ie(),i=kt(),s=Pt();return MA(i,r,r[we],s,n,e,t),xo}function MA(n,e,t,r,i,s,o){let a=!0,c=null;if((r.type&3||o)&&(c??=Jm(r,e,s),QV(r,n,e,o,t,i,s,c)&&(a=!1)),a){let l=r.outputs?.[i],u=r.hostDirectiveOutputs?.[i];if(u&&u.length)for(let d=0;d<u.length;d+=2){let f=u[d],h=u[d+1];c??=Jm(r,e,s),Fw(r,e,f,h,i,c)}if(l&&l.length)for(let d of l)c??=Jm(r,e,s),Fw(r,e,d,i,i,c)}}function ZU(n=1){return hw(n)}function JU(n){let e=rw();return $D(e,he+n)}function hd(n,e){return n<<17|e<<2}function gs(n){return n>>17&32767}function XU(n){return(n&2)==2}function ej(n,e){return n&131071|e<<17}function Iy(n){return n|2}function bo(n){return(n&131068)>>2}function ty(n,e){return n&-131069|e<<2}function tj(n){return(n&1)===1}function Ay(n){return n|1}function nj(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=gs(o),c=bo(o);n[r]=t;let l=!1,u;if(Array.isArray(t)){let d=t;u=d[1],(u===null||co(d,u)>0)&&(l=!0)}else u=t;if(i)if(c!==0){let f=gs(n[a+1]);n[r+1]=hd(f,a),f!==0&&(n[f+1]=ty(n[f+1],r)),n[a+1]=ej(n[a+1],r)}else n[r+1]=hd(a,0),a!==0&&(n[a+1]=ty(n[a+1],r)),a=r;else n[r+1]=hd(c,0),a===0?a=r:n[c+1]=ty(n[c+1],r),c=r;l&&(n[r+1]=Iy(n[r+1])),Gw(n,u,r,!0),Gw(n,u,r,!1),rj(e,u,n,r,s),o=hd(a,c),s?e.classBindings=o:e.styleBindings=o}function rj(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&co(s,e)>=0&&(t[r+1]=Ay(t[r+1]))}function Gw(n,e,t,r){let i=n[t+1],s=e===null,o=r?gs(i):bo(i),a=!1;for(;o!==0&&(a===!1||s);){let c=n[o],l=n[o+1];ij(c,e)&&(a=!0,n[o+1]=r?Ay(l):Iy(l)),o=r?gs(l):bo(l)}a&&(n[t+1]=r?Iy(i):Ay(i))}function ij(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?co(n,e)>=0:!1}function zc(n,e){return sj(n,e,null,!0),zc}function sj(n,e,t,r){let i=Ie(),s=kt(),o=sw(2);if(s.firstUpdatePass&&aj(s,n,o,r),e!==br&&Mo(i,o,e)){let a=s.data[as()];fj(s,a,i,i[we],n,i[o+1]=hj(e,t),r,o)}}function oj(n,e){return e>=n.expandoStartIndex}function aj(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[as()],o=oj(n,t);pj(s,r)&&e===null&&!o&&(e=!1),e=cj(i,s,e,r),nj(i,s,e,t,o,r)}}function cj(n,e,t,r){let i=lw(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=ny(null,n,e,t,r),t=Pc(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=ny(i,n,e,t,r),s===null){let c=lj(n,e,r);c!==void 0&&Array.isArray(c)&&(c=ny(null,n,e,c[1],r),c=Pc(c,e.attrs,r),uj(n,e,r,c))}else s=dj(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function lj(n,e,t){let r=t?e.classBindings:e.styleBindings;if(bo(r)!==0)return n[gs(r)]}function uj(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[gs(i)]=r}function dj(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=Pc(r,o,t)}return Pc(r,e.attrs,t)}function ny(n,e,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],r=Pc(r,s.hostAttrs,i),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function Pc(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),kD(n,o,t?!0:e[++s]))}return n===void 0?null:n}function fj(n,e,t,r,i,s,o,a){if(!(e.type&3))return;let c=n.data,l=c[a+1],u=tj(l)?Ww(c,e,t,i,bo(l),o):void 0;if(!xd(u)){xd(s)||XU(l)&&(s=Ww(c,null,t,i,a,o));let d=Cm(as(),t);TB(r,o,d,i,s)}}function Ww(n,e,t,r,i,s){let o=e===null,a;for(;i>0;){let c=n[i],l=Array.isArray(c),u=l?c[1]:c,d=u===null,f=t[i+1];f===br&&(f=d?Vt:void 0);let h=d?Xu(f,r):u===r?f:void 0;if(l&&!xd(h)&&(h=Xu(c,r)),xd(h)&&(a=h,o))return a;let _=n[i+1];i=o?gs(_):bo(_)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=Xu(c,r))}return a}function xd(n){return n!==void 0}function hj(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=yr(Gy(n)))),n}function pj(n,e){return(n.flags&(e?8:16))!==0}function gj(n,e=""){let t=Ie(),r=kt(),i=n+he,s=r.firstCreatePass?Uc(r,i,1,e,null):r.data[i],o=RA(r,t,s,e,n);t[i]=o,ud()&&tv(r,t,o,s),fo(s,!1)}var RA=(n,e,t,r,i)=>(Cr(!0),HI(e[we],r));function mj(n,e,t,r,i){let s=!qd(e,t);if(Cr(s),s)return HI(e[we],r);let o=e[an];return Wd(o,n,e,t)}function xA(){RA=mj}function yj(n,e,t,r=""){return Mo(n,ho(),t)?e+pc(t)+r:br}function OA(n){return wv("",n),OA}function wv(n,e,t){let r=Ie(),i=yj(r,n,e,t);return i!==br&&vj(r,as(),i),wv}function vj(n,e,t){let r=Cm(e,n);sB(n[we],r,t)}function kA(n,e,t){qm(e)&&(e=e());let r=Ie(),i=ho();if(Mo(r,i,e)){let s=kt(),o=ld();i0(o,r,n,e,r[we],t)}return kA}function Ej(n,e){let t=qm(n);return t&&n.set(e),t}function PA(n,e){let t=Ie(),r=kt(),i=Pt();return MA(r,t,t[we],i,n,e),PA}function _j(n,e,t){let r=kt();if(r.firstCreatePass){let i=zn(n);Ny(t,r.data,r.blueprint,i,!0),Ny(e,r.data,r.blueprint,i,!1)}}function Ny(n,e,t,r,i){if(n=pt(n),Array.isArray(n))for(let s=0;s<n.length;s++)Ny(n[s],e,t,r,i);else{let s=kt(),o=Ie(),a=Pt(),c=Qi(n)?n:pt(n.provide),l=pm(n),u=a.providerIndexes&1048575,d=a.directiveStart,f=a.providerIndexes>>20;if(Qi(n)||!n.multi){let h=new fs(l,i,de,null),_=iy(c,e,i?u:u+f,d);_===-1?(oy(bd(a,o),s,c),ry(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(h),o.push(h)):(t[_]=h,o[_]=h)}else{let h=iy(c,e,u+f,d),_=iy(c,e,u,u+f),b=h>=0&&t[h],T=_>=0&&t[_];if(i&&!T||!i&&!b){oy(bd(a,o),s,c);let D=Sj(i?bj:Cj,t.length,i,r,l,n);!i&&T&&(t[_].providerFactory=D),ry(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(D),o.push(D)}else{let D=FA(t[i?_:h],l,!i&&r);ry(s,n,h>-1?h:_,D)}!i&&r&&T&&t[_].componentProviders++}}}function ry(n,e,t,r){let i=Qi(e),s=UD(e);if(i||s){let c=(s?pt(e.useClass):e).prototype.ngOnDestroy;if(c){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let u=l.indexOf(t);u===-1?l.push(t,[r,c]):l[u+1].push(r,c)}else l.push(t,c)}}}function FA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function iy(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function Cj(n,e,t,r,i){return My(this.multi,[])}function bj(n,e,t,r,i){let s=this.multi,o;if(this.providerFactory){let a=this.providerFactory.componentProviders,c=Sd(r,r[H],this.providerFactory.index,i);o=c.slice(0,a),My(s,o);for(let l=a;l<c.length;l++)o.push(c[l])}else o=[],My(s,o);return o}function My(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function Sj(n,e,t,r,i,s){let o=new fs(n,t,de,null);return o.multi=[],o.index=e,o.componentProviders=0,FA(o,i,r&&!t),o}function Tr(n,e=[]){return t=>{t.providersResolver=(r,i)=>_j(r,i?i(n):n,e)}}var pd=null;function LA(n){pd!==null&&(n.defaultEncapsulation!==pd.defaultEncapsulation||n.preserveWhitespaces!==pd.preserveWhitespaces)||(pd=n)}var Tj=[];var Dj=new WeakMap,wj=new WeakMap;function Ij(){Dj=new WeakMap,wj=new WeakMap,Tj.length=0,_U.clear()}var Od=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Aj=(()=>{class n{compileModuleSync(t){return new Oc(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=lm(t),s=jI(i.declarations).reduce((o,a)=>{let c=Er(a);return c&&o.push(new _o(c)),o},[]);return new Od(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),BA=new $("");var Nj=(()=>{class n{zone=G(gt);changeDetectionScheduler=G(jn);applicationRef=G(Es);applicationErrorHandler=G(bn);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Iv({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new gt(Ce(K({},Av()),{scheduleInRootZone:t})),[{provide:gt,useFactory:n},{provide:vr,multi:!0,useFactory:()=>{let r=G(Nj,{optional:!0});return()=>r.initialize()}},{provide:vr,multi:!0,useFactory:()=>{let r=G(Mj);return()=>{r.initialize()}}},e===!0?{provide:Hm,useValue:!0}:[],{provide:dd,useValue:t??lA},{provide:bn,useFactory:()=>{let r=G(gt),i=G(tn),s;return o=>{r.runOutsideAngular(()=>{i.destroyed&&!s?setTimeout(()=>{throw o}):(s??=i.get(Zi),s.handleError(o))})}}}]}function Av(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var Mj=(()=>{class n{subscription=new rt;initialized=!1;zone=G(gt);pendingTasks=G(Xr);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{gt.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{gt.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Yd=(()=>{class n{applicationErrorHandler=G(bn);appRef=G(Es);taskService=G(Xr);ngZone=G(gt);zonelessEnabled=G(wc);tracing=G(fv,{optional:!0});disableScheduling=G(Hm,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new rt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Rd):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(G(dd,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Co||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{this.appRef.dirtyFlags|=16,r=!0;break}case 13:{this.appRef.dirtyFlags|=2,r=!0;break}case 11:{r=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?jw:uA;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Rd+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(t),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,jw(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Rj(){return Sr("NgZoneless"),lo([{provide:jn,useExisting:Yd},{provide:gt,useClass:Co},{provide:wc,useValue:!0},{provide:dd,useValue:!1},[]])}function xj(){return typeof $localize<"u"&&$localize.locale||$c}var Zd=new $("",{providedIn:"root",factory:()=>G(Zd,{optional:!0,skipSelf:!0})||xj()});function Tn(n){return TD(n)}function _s(n,e){return Cu(n,e?.equal)}var VA=class{[_t];constructor(e){this[_t]=e}destroy(){this[_t].destroy()}};var Ge={AUXCLICK:"auxclick",CHANGE:"change",CLICK:"click",CLICKMOD:"clickmod",CLICKONLY:"clickonly",DBLCLICK:"dblclick",FOCUS:"focus",FOCUSIN:"focusin",BLUR:"blur",FOCUSOUT:"focusout",SUBMIT:"submit",KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup",MOUSEUP:"mouseup",MOUSEDOWN:"mousedown",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",POINTERUP:"pointerup",POINTERDOWN:"pointerdown",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERMOVE:"pointermove",POINTERCANCEL:"pointercancel",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",ERROR:"error",LOAD:"load",UNLOAD:"unload",TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove",INPUT:"input",SCROLL:"scroll",TOGGLE:"toggle",CUSTOM:"_custom"},Cse=[Ge.MOUSEENTER,Ge.MOUSELEAVE,"pointerenter","pointerleave"],Oj=[Ge.CLICK,Ge.DBLCLICK,Ge.FOCUSIN,Ge.FOCUSOUT,Ge.KEYDOWN,Ge.KEYUP,Ge.KEYPRESS,Ge.MOUSEOVER,Ge.MOUSEOUT,Ge.SUBMIT,Ge.TOUCHSTART,Ge.TOUCHEND,Ge.TOUCHMOVE,"touchcancel","auxclick","change","compositionstart","compositionupdate","compositionend","beforeinput","input","select","copy","cut","paste","mousedown","mouseup","wheel","contextmenu","dragover","dragenter","dragleave","drop","dragstart","dragend","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerout","gotpointercapture","lostpointercapture","ended","loadedmetadata","pagehide","pageshow","visibilitychange","beforematch"],UA=[Ge.FOCUS,Ge.BLUR,Ge.ERROR,Ge.LOAD,Ge.TOGGLE],jA=n=>UA.indexOf(n)>=0,kj=Oj.concat(UA),qA=n=>kj.indexOf(n)>=0;var bse=typeof navigator<"u"&&/Macintosh/.test(navigator.userAgent);var Sse=typeof navigator<"u"&&/iPhone|iPad|iPod/.test(navigator.userAgent);var Tse=Ge.CLICK;var ZA=Symbol("InputSignalNode#UNSET"),Wj=Ce(K({},bu),{transformFn:void 0,applyValueToInputSignal(n,e){eo(n,e)}});function JA(n,e){let t=Object.create(Wj);t.value=n,t.transformFn=e?.transform;function r(){if(Zs(t),t.value===ZA){let i=null;throw new Q(-950,i)}return t.value}return r[_t]=t,r}var Kj=new $("");Kj.__NG_ELEMENT_ID__=n=>{let e=Pt();if(e===null)throw new Q(204,!1);if(e.type&2)return e.value;if(n&8)return null;throw new Q(204,!1)};function HA(n,e){return JA(n,e)}function Qj(n){return JA(ZA,n)}var Gue=(HA.required=Qj,HA);var Kc=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},Wue=new Kc("20.2.4");function Yj(n,e,t){let r=new Oc(t);return Promise.resolve(r)}function $A(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var Jd=new $(""),Zj=new $("");function Gc(n){return!n.moduleRef}function XA(n){let e=Gc(n)?n.r3Injector:n.moduleRef.injector,t=e.get(gt);return t.run(()=>{Gc(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(bn),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:r})}),Gc(n)){let s=()=>e.destroy(),o=n.platformInjector.get(Jd);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{let s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(Jd);o.add(s),n.moduleRef.onDestroy(()=>{Ac(n.allPlatformModules,n.moduleRef),i.unsubscribe(),o.delete(s)})}return Xj(r,t,()=>{let s=e.get(Xr),o=s.add(),a=e.get(Ev);return a.runInitializers(),a.donePromise.then(()=>{let c=e.get(Zd,$c);if(NA(c||$c),!e.get(Zj,!0))return Gc(n)?e.get(Es):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Gc(n)){let u=e.get(Es);return n.rootComponent!==void 0&&u.bootstrap(n.rootComponent),u}else return eN?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void s.remove(o))})})}var eN;function zA(){eN=Jj}function Jj(n,e){let t=n.injector.get(Es);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new Q(-403,!1);e.push(n)}function Xj(n,e,t){try{let r=t();return Ro(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var tN=(()=>{class n{_injector;_modules=[];_destroyListeners=[];_destroyed=!1;constructor(t){this._injector=t}bootstrapModuleFactory(t,r){let i=r?.scheduleInRootZone,s=()=>fA(r?.ngZone,Ce(K({},Av({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing})),{scheduleInRootZone:i})),o=r?.ignoreChangesOutsideZone,a=[Iv({ngZoneFactory:s,ignoreChangesOutsideZone:o}),{provide:jn,useExisting:Yd},Um],c=X0(t.moduleType,this.injector,a);return zA(),XA({moduleRef:c,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(t,r=[]){let i=Cv({},r);return zA(),Yj(this.injector,i,t).then(s=>this.bootstrapModuleFactory(s,i))}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Q(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());let t=this._injector.get(Jd,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static \u0275fac=function(r){return new(r||n)($e(nn))};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),ni=null,nN=new $("");function e3(n){if(ni&&!ni.get(nN,!1))throw new Q(400,!1);_v(),ni=n;let e=n.get(tN);return sN(n),e}function t3(n,e,t=[]){let r=`Platform: ${e}`,i=new $(r);return(s=[])=>{let o=iN();if(!o||o.injector.get(nN,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):e3(rN(a,r))}return n3(i)}}function rN(n=[],e){return nn.create({name:e,providers:[{provide:hm,useValue:"platform"},{provide:Jd,useValue:new Set([()=>ni=null])},...n]})}function n3(n){let e=iN();if(!e)throw new Q(401,!1);return e}function iN(){return ni?.get(tN)??null}function r3(n=[]){if(ni)return ni;let e=rN(n);return ni=e,_v(),sN(e),e}function sN(n){let e=n.get(yI,null);ed(n,()=>{e?.forEach(t=>t())})}var tf=(()=>{class n{static __NG_ELEMENT_ID__=i3}return n})();function i3(n){return s3(Pt(),Ie(),(n&16)===16)}function s3(n,e,t){if($n(n)&&!t){let r=ln(n.index,e);return new ti(r,r)}else if(n.type&175){let r=e[Ot];return new ti(r,e)}return null}var Mv=class{constructor(){}supports(e){return cv(e)}create(e){return new Rv(e)}},o3=(n,e)=>e,Rv=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||o3}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<GA(r,i,s)?t:r,a=GA(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,u=c-i;if(l!=u){for(let f=0;f<l;f++){let h=f<s.length?s[f]:s[f]=0,_=h+f;u<=_&&_<l&&(s[f]=h+1)}let d=o.previousIndex;s[d]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!cv(e))throw new Q(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,j0(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new xv(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Xd),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Xd),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},xv=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},Ov=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Xd=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Ov,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function GA(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function WA(){return new Pv([new Mv])}var Pv=(()=>{class n{factories;static \u0275prov=ve({token:n,providedIn:"root",factory:WA});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:()=>{let r=G(n,{optional:!0,skipSelf:!0});return n.create(t,r||WA())}}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new Q(901,!1)}}return n})();var Kue=t3(null,"core",[]);function Que(n){Re(8);try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=r3(r),s=[Iv({}),{provide:jn,useExisting:Yd},Um,...t||[]],o=new kc({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1});return XA({r3Injector:o.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}finally{Re(9)}}function Yue(){return[{provide:jy,useFactory:()=>{let e=!0;return e&&Sr("NgEventReplay"),e}}]}function a3(n,e,t){let r=new Map,i=e[Xi],s=n.cleanup;if(!s||!i)return r;for(let o=0;o<s.length;){let a=s[o++],c=s[o++];if(typeof a!="string")continue;let l=a;if(!qA(l))continue;jA(l)?t.capture.add(l):t.regular.add(l);let u=Me(e[c]);o++;let d=s[o++];(typeof d=="boolean"||d>=0)&&(r.has(u)?r.get(u).push(l):r.set(u,[l]))}return r}var kv=class{views=[];indexByContent=new Map;add(e){let t=JSON.stringify(e);if(!this.indexByContent.has(t)){let r=this.views.length;return this.views.push(e),this.indexByContent.set(t,r),r}return this.indexByContent.get(t)}getAll(){return this.views}},c3=0;function oN(n){return n.ssrId||(n.ssrId=`t${c3++}`),n.ssrId}function aN(n,e,t){let r=[];return Eo(n,e,t,r),r.length}function l3(n){let e=[];return Gd(n,e),e.length}function cN(n,e,t){let r=n[ze];return r&&!r.hasAttribute(To)?ef(r,n,null,e):null}function lN(n,e,t){let r=rd(n[ze]),i=cN(r,e);if(i===null)return;let s=Me(r[ze]),o=n[Xe],a=ef(s,o,null,e),c=r[we],l=`${i}|${a}`;c.setAttribute(s,mo,l)}function Zue(n,e){let t=n.injector,r=I0(t),i=OI(t),s=new kv,o=new Map,a=n._views,c=t.get(jy,TI),l={regular:new Set,capture:new Set},u=new Map,d=n.injector.get(mI);for(let _ of a){let b=xI(_);if(b!==null){let T={serializedViewCollection:s,corruptedTextNodes:o,isI18nHydrationEnabled:r,isIncrementalHydrationEnabled:i,i18nChildren:new Map,eventTypesToReplay:l,shouldReplayEvents:c,appId:d,deferBlocks:u};bt(b)?lN(b,T):cN(b,T),p3(o,e)}}let f=s.getAll(),h=t.get(Fd);if(h.set(Hy,f),u.size>0){let _={};for(let[b,T]of u.entries())_[b]=T;h.set(II,_)}return l}function u3(n,e,t,r,i){let s=[],o="";for(let a=Ct;a<n.length;a++){let c=n[a],l,u,d;if(Yr(c)&&(c=c[he],bt(c))){u=l3(c)+1,lN(c,i);let h=rd(c[ze]);d={[Vd]:h[H].ssrId,[ei]:u}}if(!d){let h=c[H];h.type===1?(l=h.ssrId,u=1):(l=oN(h),u=aN(h,c,h.firstChild)),d={[Vd]:l,[ei]:u};let _=!1;if(gA(t[H],e)){let b=pA(t,e),T=mv(t[H],e);if(i.isIncrementalHydrationEnabled&&T.hydrateTriggers!==null){let D=`d${i.deferBlocks.size}`;T.hydrateTriggers.has(7)&&(_=!0);let k=[];Gd(n,k);let P={[ei]:k.length,[Vy]:b[uv]},w=d3(T.hydrateTriggers);w.length>0&&(P[CI]=w),r!==null&&(P[_I]=r),i.deferBlocks.set(D,P);let q=Me(n);q!==void 0?q.nodeType===Node.COMMENT_NODE&&KA(q,D):KA(q,D),_||m3(T,k,D,i),r=D,d[By]=D}d[Vy]=b[uv]}_||Object.assign(d,uN(n[a],r,i))}let f=JSON.stringify(d);if(s.length>0&&f===o){let h=s[s.length-1];h[Lc]??=1,h[Lc]++}else o=f,s.push(d)}return s}function d3(n){let e=new Set([0,1,2,5]),t=[];for(let[r,i]of n)e.has(r)&&(i===null?t.push(r):t.push({trigger:r,delay:i.delay}));return t}function Wc(n,e,t,r){let i=e.index-he;n[Ud]??={},n[Ud][i]??=S0(e,t,r)}function Nv(n,e){let t=typeof e=="number"?e:e.index-he;n[Io]??=[],n[Io].includes(t)||n[Io].push(t)}function uN(n,e=null,t){let r={},i=n[H],s=A0(i,t),o=t.shouldReplayEvents?a3(i,n,t.eventTypesToReplay):null;for(let a=he;a<i.bindingStartIndex;a++){let c=i.data[a],l=a-he,u=N0(n,a,t);if(u){r[Ly]??={},r[Ly][l]=u.caseQueue;for(let d of u.disconnectedNodes)Nv(r,d);for(let d of u.disjointNodes){let f=i.data[d+he];Wc(r,f,n,s)}continue}if(Ry(c)&&!Bc(c)){if(bt(n[a])&&c.tView&&(r[Bd]??={},r[Bd][l]=oN(c.tView)),Ao(c,n)&&g3(c)){Nv(r,c);continue}if(Array.isArray(c.projection)){for(let d of c.projection)if(d)if(!Array.isArray(d))!_m(d)&&!Do(d)&&(Ao(d,n)?Nv(r,d):Wc(r,d,n,s));else throw _0(Me(n[a]))}if(f3(r,c,n,s),bt(n[a])){let d=n[a][ze];if(Array.isArray(d)){let f=Me(d);f.hasAttribute(To)||ef(f,d,e,t)}r[wo]??={},r[wo][l]=u3(n[a],c,n,e,t)}else if(Array.isArray(n[a])&&!tI(c)){let d=Me(n[a][ze]);d.hasAttribute(To)||ef(d,n[a],e,t)}else if(c.type&8)r[Ld]??={},r[Ld][l]=aN(i,n,c.child);else if(c.type&144){let d=c.next;for(;d!==null&&d.type&144;)d=d.next;d&&!Do(d)&&Wc(r,d,n,s)}else if(c.type&1){let d=Me(n[a]);zy(t,d)}if(o&&c.type&2){let d=Me(n[a]);o.has(d)&&qy(d,o.get(d),e)}}}return r}function f3(n,e,t,r){_m(e)||(e.projectionNext&&e.projectionNext!==e.next&&!Do(e.projectionNext)&&Wc(n,e.projectionNext,t,r),e.prev===null&&e.parent!==null&&Ao(e.parent,t)&&!Ao(e,t)&&Wc(n,e,t,r))}function h3(n){let e=n[it];return e?.constructor?Er(e.constructor)?.encapsulation===hs.ShadowDom:!1}function ef(n,e,t,r){let i=e[we];if(jD(e)&&!w0()||h3(e))return i.setAttribute(n,To,""),null;{let s=uN(e,t,r),o=r.serializedViewCollection.add(s);return i.setAttribute(n,mo,o.toString()),o}}function KA(n,e){n.textContent=`ngh=${e}`}function p3(n,e){for(let[t,r]of n)t.after(e.createComment(r))}function g3(n){let e=n;for(;e!=null;){if($n(e))return!0;e=e.parent}return!1}function m3(n,e,t,r){let i=FI(n.hydrateTriggers);for(let s of i)r.eventTypesToReplay.regular.add(s);if(i.length>0){let s=e.filter(o=>o.nodeType===Node.ELEMENT_NODE);for(let o of s)qy(o,i,t)}}var QA=!1;function y3(){QA||(QA=!0,MI(),IA(),xA(),AA(),cA(),K0(),O0(),r0())}function Jue(){return lo([{provide:Uy,useFactory:()=>{let e=!0;return e&&Sr("NgHydration"),e}},{provide:vr,useValue:()=>{D0(!1)},multi:!0}])}function nf(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var v3="\u{1F170}\uFE0F",dN=!1;function Xue(n){if(!dN)return;let{startLabel:e}=fN(n);performance.mark(e)}function ede(n){if(!dN)return;let{startLabel:e,labelName:t,endLabel:r}=fN(n);performance.mark(r),performance.measure(t,e,r),performance.clearMarks(e),performance.clearMarks(r)}function fN(n){let e=`${v3}:${n}`;return{labelName:e,startLabel:`start:${e}`,endLabel:`end:${e}`}}function tde(...n){return n.reduce((e,t)=>Object.assign(e,t,{providers:[...e.providers,...t.providers]}),{providers:[]})}var nde=new $("",{providedIn:"platform",factory:()=>null}),rde=new $("",{providedIn:"platform",factory:()=>null}),ide=new $("",{providedIn:"platform",factory:()=>null});var gN=null;function Cs(){return gN}function E3(n){gN??=n}var Lv=class{},Bv=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:()=>G(mN),providedIn:"platform"})}return n})();var mN=(()=>{class n extends Bv{_location;_history;_doc=G(cs);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Cs().getBaseHref(this._doc)}onPopState(t){let r=Cs().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Cs().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function yN(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function hN(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function ri(n){return n&&n[0]!=="?"?`?${n}`:n}var rf=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:()=>G(EN),providedIn:"root"})}return n})(),vN=new $(""),EN=(()=>{class n extends rf{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??G(cs).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return yN(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+ri(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+ri(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+ri(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)($e(Bv),$e(vN,8))};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),_N=(()=>{class n{_subject=new Cn;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=b3(hN(pN(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+ri(r))}normalize(t){return n.stripTrailingSlash(C3(this._basePath,pN(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ri(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+ri(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=ri;static joinWithSlash=yN;static stripTrailingSlash=hN;static \u0275fac=function(r){return new(r||n)($e(rf))};static \u0275prov=ve({token:n,factory:()=>_3(),providedIn:"root"})}return n})();function _3(){return new _N($e(rf))}function C3(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function pN(n){return n.replace(/\/index.html$/,"")}function b3(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var sf=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},SN=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,s,o)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new sf(i.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)r.remove(s===null?void 0:s);else if(s!==null){let a=r.get(s);r.move(a,o),CN(a,i)}});for(let i=0,s=r.length;i<s;i++){let a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);CN(s,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(de(qc),de(Vc),de(Pv))};static \u0275dir=st({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function CN(n,e){n.context.$implicit=e.item}var S3=(()=>{class n{_viewContainer;_context=new of;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){bN(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){bN(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(de(qc),de(Vc))};static \u0275dir=st({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),of=class{$implicit=null;ngIf=null};function bN(n,e){if(n&&!n.createEmbeddedView)throw new Q(2020,!1)}var T3=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=vs({type:n});static \u0275inj=Kr({})}return n})();function D3(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Vv=class{};var w3="browser",Hfe="server";function $fe(n){return n===w3}var zfe=(()=>{class n{static \u0275prov=ve({token:n,providedIn:"root",factory:()=>new Uv})}return n})();var Uv=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}};var ON=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(de(No),de(ys))};static \u0275dir=st({type:n})}return n})(),I3=(()=>{class n extends ON{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Fc(n)))(i||n)}})();static \u0275dir=st({type:n,features:[Kt]})}return n})(),$v=new $("");var A3={provide:$v,useExisting:rn(()=>kN),multi:!0};function N3(){let n=Cs()?Cs().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var M3=new $(""),kN=(()=>{class n extends ON{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!N3())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(de(No),de(ys),de(M3,8))};static \u0275dir=st({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&xo("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},standalone:!1,features:[Tr([A3]),Kt]})}return n})();function zv(n){return n==null||Gv(n)===0}function Gv(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var Lo=new $(""),vf=new $(""),R3=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,TN=class{static min(e){return x3(e)}static max(e){return O3(e)}static required(e){return PN(e)}static requiredTrue(e){return k3(e)}static email(e){return P3(e)}static minLength(e){return F3(e)}static maxLength(e){return FN(e)}static pattern(e){return L3(e)}static nullValidator(e){return cf()}static compose(e){return qN(e)}static composeAsync(e){return HN(e)}};function x3(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function O3(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function PN(n){return zv(n.value)?{required:!0}:null}function k3(n){return n.value===!0?null:{required:!0}}function P3(n){return zv(n.value)||R3.test(n.value)?null:{email:!0}}function F3(n){return e=>{let t=e.value?.length??Gv(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function FN(n){return e=>{let t=e.value?.length??Gv(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function L3(n){if(!n)return cf;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(zv(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function cf(n){return null}function LN(n){return n!=null}function BN(n){return Ro(n)?Un(n):n}function VN(n){let e={};return n.forEach(t=>{e=t!=null?K(K({},e),t):e}),Object.keys(e).length===0?null:e}function UN(n,e){return e.map(t=>t(n))}function B3(n){return!n.validate}function jN(n){return n.map(e=>B3(e)?e:t=>e.validate(t))}function qN(n){if(!n)return null;let e=n.filter(LN);return e.length==0?null:function(t){return VN(UN(t,e))}}function Wv(n){return n!=null?qN(jN(n)):null}function HN(n){if(!n)return null;let e=n.filter(LN);return e.length==0?null:function(t){let r=UN(t,e).map(BN);return xg(r).pipe(gr(VN))}}function Kv(n){return n!=null?HN(jN(n)):null}function DN(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function $N(n){return n._rawValidators}function zN(n){return n._rawAsyncValidators}function jv(n){return n?Array.isArray(n)?n:[n]:[]}function lf(n,e){return Array.isArray(n)?n.includes(e):n===e}function wN(n,e){let t=jv(e);return jv(n).forEach(i=>{lf(t,i)||t.push(i)}),t}function IN(n,e){return jv(e).filter(t=>!lf(n,t))}var uf=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Wv(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Kv(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Dr=class extends uf{name;get formDirective(){return null}get path(){return null}},bs=class extends uf{_parent=null;name=null;valueAccessor=null},df=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},V3={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},hhe=Ce(K({},V3),{"[class.ng-submitted]":"isSubmitted"}),phe=(()=>{class n extends df{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(de(bs,2))};static \u0275dir=st({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&zc("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Kt]})}return n})(),ghe=(()=>{class n extends df{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(de(Dr,10))};static \u0275dir=st({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&zc("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Kt]})}return n})();var Qc="VALID",af="INVALID",Oo="PENDING",Yc="DISABLED",ii=class{},ff=class extends ii{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Jc=class extends ii{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Xc=class extends ii{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},ko=class extends ii{status;source;constructor(e,t){super(),this.status=e,this.source=t}},hf=class extends ii{source;constructor(e){super(),this.source=e}},pf=class extends ii{source;constructor(e){super(),this.source=e}};function Qv(n){return(Ef(n)?n.validators:n)||null}function U3(n){return Array.isArray(n)?Wv(n):n||null}function Yv(n,e){return(Ef(e)?e.asyncValidators:n)||null}function j3(n){return Array.isArray(n)?Kv(n):n||null}function Ef(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function GN(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Q(1e3,"");if(!r[t])throw new Q(1001,"")}function WN(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Q(1002,"")})}var Po=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Tn(this.statusReactive)}set status(e){Tn(()=>this.statusReactive.set(e))}_status=_s(()=>this.statusReactive());statusReactive=Jr(void 0);get valid(){return this.status===Qc}get invalid(){return this.status===af}get pending(){return this.status==Oo}get disabled(){return this.status===Yc}get enabled(){return this.status!==Yc}errors;get pristine(){return Tn(this.pristineReactive)}set pristine(e){Tn(()=>this.pristineReactive.set(e))}_pristine=_s(()=>this.pristineReactive());pristineReactive=Jr(!0);get dirty(){return!this.pristine}get touched(){return Tn(this.touchedReactive)}set touched(e){Tn(()=>this.touchedReactive.set(e))}_touched=_s(()=>this.touchedReactive());touchedReactive=Jr(!1);get untouched(){return!this.touched}_events=new Cn;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(wN(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(wN(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(IN(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(IN(e,this._rawAsyncValidators))}hasValidator(e){return lf(this._rawValidators,e)}hasAsyncValidator(e){return lf(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Ce(K({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Xc(!0,r))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Xc(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Ce(K({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Jc(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Jc(!0,r))}markAsPending(e={}){this.status=Oo;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ko(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Ce(K({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Yc,this.errors=null,this._forEachChild(i=>{i.disable(Ce(K({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ff(this.value,r)),this._events.next(new ko(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Ce(K({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Qc,this._forEachChild(r=>{r.enable(Ce(K({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Ce(K({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Qc||this.status===Oo)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ff(this.value,t)),this._events.next(new ko(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Ce(K({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Yc:Qc}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Oo,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let r=BN(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new ko(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new St,this.statusChanges=new St}_calculateStatus(){return this._allControlsDisabled()?Yc:this.errors?af:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Oo)?Oo:this._anyControlsHaveStatus(af)?af:Qc}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Jc(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Xc(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ef(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=U3(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=j3(this._rawAsyncValidators)}},Fo=class extends Po{constructor(e,t,r){super(Qv(t),Yv(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){WN(this,!0,e),Object.keys(e).forEach(r=>{GN(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var qv=class extends Fo{};var tl=new $("",{providedIn:"root",factory:()=>_f}),_f="always";function KN(n,e){return[...e.path,n]}function gf(n,e,t=_f){Zv(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),H3(n,e),z3(n,e),$3(n,e),q3(n,e)}function AN(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),yf(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function mf(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function q3(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Zv(n,e){let t=$N(n);e.validator!==null?n.setValidators(DN(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=zN(n);e.asyncValidator!==null?n.setAsyncValidators(DN(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();mf(e._rawValidators,i),mf(e._rawAsyncValidators,i)}function yf(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=$N(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let i=zN(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}let r=()=>{};return mf(e._rawValidators,r),mf(e._rawAsyncValidators,r),t}function H3(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&QN(n,e)})}function $3(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&QN(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function QN(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function z3(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function YN(n,e){n==null,Zv(n,e)}function G3(n,e){return yf(n,e)}function ZN(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function W3(n){return Object.getPrototypeOf(n.constructor)===I3}function JN(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function XN(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===kN?t=s:W3(s)?r=s:i=s}),i||r||t||null}function K3(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}var Q3={provide:Dr,useExisting:rn(()=>Y3)},Zc=Promise.resolve(),Y3=(()=>{class n extends Dr{callSetDisabledState;get submitted(){return Tn(this.submittedReactive)}_submitted=_s(()=>this.submittedReactive());submittedReactive=Jr(!1);_directives=new Set;form;ngSubmit=new St;options;constructor(t,r,i){super(),this.callSetDisabledState=i,this.form=new Fo({},Wv(t),Kv(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Zc.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),gf(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Zc.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Zc.then(()=>{let r=this._findContainer(t.path),i=new Fo({});YN(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Zc.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){Zc.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),JN(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new hf(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1),this.form._events.next(new pf(this.form))}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(r){return new(r||n)(de(Lo,10),de(vf,10),de(tl,8))};static \u0275dir=st({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&xo("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Tr([Q3]),Kt]})}return n})();function NN(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function MN(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var el=class extends Po{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(Qv(t),Yv(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ef(t)&&(t.nonNullable||t.initialValueIsDefault)&&(MN(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){NN(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){NN(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){MN(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Z3=n=>n instanceof el;var J3={provide:bs,useExisting:rn(()=>X3)},RN=Promise.resolve(),X3=(()=>{class n extends bs{_changeDetectorRef;callSetDisabledState;control=new el;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new St;constructor(t,r,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=XN(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),ZN(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){gf(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){RN.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&nf(r);RN.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?KN(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(de(Dr,9),de(Lo,10),de(vf,10),de($v,10),de(tf,8),de(tl,8))};static \u0275dir=st({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Tr([J3]),Kt,ms]})}return n})();var yhe=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=st({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var eM=new $("");var e4={provide:Dr,useExisting:rn(()=>t4)},t4=(()=>{class n extends Dr{callSetDisabledState;get submitted(){return Tn(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=_s(()=>this._submittedReactive());_submittedReactive=Jr(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new St;constructor(t,r,i){super(),this.callSetDisabledState=i,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(yf(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return gf(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){AN(t.control||null,t,!1),K3(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),JN(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new hf(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0,r={}){this.form.reset(t,r),this._submittedReactive.set(!1),r?.emitEvent!==!1&&this.form._events.next(new pf(this.form))}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(AN(r||null,t),Z3(i)&&(gf(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);YN(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&G3(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Zv(this.form,this),this._oldForm&&yf(this._oldForm,this)}static \u0275fac=function(r){return new(r||n)(de(Lo,10),de(vf,10),de(tl,8))};static \u0275dir=st({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&xo("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Tr([e4]),Kt,ms]})}return n})();var n4={provide:bs,useExisting:rn(()=>r4)},r4=(()=>{class n extends bs{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new St;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,r,i,s,o){super(),this._ngModelWarningConfig=o,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=XN(this,s)}ngOnChanges(t){this._added||this._setUpControl(),ZN(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return KN(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||n)(de(Dr,13),de(Lo,10),de(vf,10),de($v,10),de(eM,8))};static \u0275dir=st({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Tr([n4]),Kt,ms]})}return n})();function i4(n){return typeof n=="number"?n:parseInt(n,10)}var tM=(()=>{class n{_validator=cf;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):cf,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(r){return new(r||n)};static \u0275dir=st({type:n,features:[ms]})}return n})();var s4={provide:Lo,useExisting:rn(()=>o4),multi:!0};var o4=(()=>{class n extends tM{required;inputName="required";normalizeInput=nf;createValidator=t=>PN;enabled(t){return t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Fc(n)))(i||n)}})();static \u0275dir=st({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&Hc("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Tr([s4]),Kt]})}return n})();var a4={provide:Lo,useExisting:rn(()=>c4),multi:!0},c4=(()=>{class n extends tM{maxlength;inputName="maxlength";normalizeInput=t=>i4(t);createValidator=t=>FN(t);static \u0275fac=(()=>{let t;return function(i){return(t||(t=Fc(n)))(i||n)}})();static \u0275dir=st({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&Hc("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},standalone:!1,features:[Tr([a4]),Kt]})}return n})();var nM=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=vs({type:n});static \u0275inj=Kr({})}return n})(),Hv=class extends Po{constructor(e,t,r){super(Qv(t),Yv(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(r=>{this.controls.push(r),this._registerControl(r)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){WN(this,!1,e),e.forEach((r,i)=>{GN(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function xN(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var vhe=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),s={};return xN(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new Fo(i,s)}record(t,r=null){let i=this._reduceControls(t);return new qv(i,r)}control(t,r,i){let s={};return this.useNonNullable?(xN(r)?s=r:(s.validators=r,s.asyncValidators=i),new el(t,Ce(K({},s),{nonNullable:!0}))):new el(t,r,i)}array(t,r,i){let s=t.map(o=>this._createControl(o));return new Hv(s,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof el)return t;if(t instanceof Po)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,s=t.length>2?t[2]:null;return this.control(r,i,s)}else return this.control(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Ehe=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:tl,useValue:t.callSetDisabledState??_f}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=vs({type:n});static \u0275inj=Kr({imports:[nM]})}return n})(),_he=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:eM,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:tl,useValue:t.callSetDisabledState??_f}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=vs({type:n});static \u0275inj=Kr({imports:[nM]})}return n})();var rM=()=>{};var l4={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var oM=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},u4=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},aM={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,u=s>>2,d=(s&3)<<4|a>>4,f=(a&15)<<2|l>>6,h=l&63;c||(h=64,o||(f=64)),r.push(t[u],t[d],t[f],t[h])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(oM(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):u4(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let d=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||d==null)throw new Jv;let f=s<<2|a>>4;if(r.push(f),l!==64){let h=a<<4&240|l>>2;if(r.push(h),d!==64){let _=l<<6&192|d;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Jv=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},d4=function(n){let e=oM(n);return aM.encodeByteArray(e,!0)},rl=function(n){return d4(n).replace(/\./g,"")},cM=function(n){try{return aM.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function lM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var f4=()=>lM().__FIREBASE_DEFAULTS__,h4=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},p4=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&cM(n[1]);return e&&JSON.parse(e)},Xv=()=>{try{return rM()||f4()||h4()||p4()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},g4=n=>Xv()?.emulatorHosts?.[n],uM=n=>{let e=g4(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},eE=()=>Xv()?.config;var Cf=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function tE(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dM(n){return(await fetch(n,{credentials:"include"})).ok}function fM(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=K({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[rl(JSON.stringify(t)),rl(JSON.stringify(o)),""].join(".")}var nl={};function m4(){let n={prod:[],emulator:[]};for(let e of Object.keys(nl))nl[e]?n.emulator.push(e):n.prod.push(e);return n}function y4(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var iM=!1;function hM(n,e){if(typeof window>"u"||typeof document>"u"||!tE(window.location.host)||nl[n]===e||nl[n]||iM)return;nl[n]=e;function t(f){return`__firebase__banner__${f}`}let r="__firebase__banner",s=m4().prod.length>0;function o(){let f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,h){f.setAttribute("width","24"),f.setAttribute("id",h),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function l(){let f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{iM=!0,o()},f}function u(f,h){f.setAttribute("id",h),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){let f=y4(r),h=t("text"),_=document.getElementById(h)||document.createElement("span"),b=t("learnmore"),T=document.getElementById(b)||document.createElement("a"),D=t("preprendIcon"),k=document.getElementById(D)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){let P=f.element;a(P),u(T,b);let w=l();c(k,D),P.append(k,_,T,w),document.body.appendChild(P)}s?(_.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",h)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}function pM(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function v4(){let n=Xv()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function gM(){return!v4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nE(){try{return typeof indexedDB=="object"}catch{return!1}}function mM(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var E4="FirebaseError",wr=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=E4,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,il.prototype.create)}},il=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?_4(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new wr(i,a,r)}};function _4(n,e){return n.replace(C4,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var C4=/\{\$([^}]+)}/g;function Bo(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(sM(s)&&sM(o)){if(!Bo(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function sM(n){return n!==null&&typeof n=="object"}var Dhe=14400*1e3;function Vo(n){return n&&n._delegate?n._delegate:n}l4.NODE_CLIENT=!0;var Ir=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ss="[DEFAULT]";var rE=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Cf;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(S4(e))try{this.getOrInitializeService({instanceIdentifier:Ss})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ss){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ss){return this.instances.has(e)}getOptions(e=Ss){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:b4(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ss){return this.component?this.component.multipleInstances?e:Ss:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function b4(n){return n===Ss?void 0:n}function S4(n){return n.instantiationMode==="EAGER"}var bf=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new rE(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var T4=[],pe=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(pe||{}),D4={debug:pe.DEBUG,verbose:pe.VERBOSE,info:pe.INFO,warn:pe.WARN,error:pe.ERROR,silent:pe.SILENT},w4=pe.INFO,I4={[pe.DEBUG]:"log",[pe.VERBOSE]:"log",[pe.INFO]:"info",[pe.WARN]:"warn",[pe.ERROR]:"error"},A4=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=I4[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Uo=class{constructor(e){this.name=e,this._logLevel=w4,this._logHandler=A4,this._userLogHandler=null,T4.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?D4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pe.DEBUG,...e),this._logHandler(this,pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pe.VERBOSE,...e),this._logHandler(this,pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pe.INFO,...e),this._logHandler(this,pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pe.WARN,...e),this._logHandler(this,pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pe.ERROR,...e),this._logHandler(this,pe.ERROR,...e)}};var N4=(n,e)=>e.some(t=>n instanceof t),yM,vM;function M4(){return yM||(yM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function R4(){return vM||(vM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var EM=new WeakMap,sE=new WeakMap,_M=new WeakMap,iE=new WeakMap,aE=new WeakMap;function x4(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Kn(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&EM.set(t,n)}).catch(()=>{}),aE.set(e,n),e}function O4(n){if(sE.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});sE.set(n,e)}var oE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return sE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||_M.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Kn(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function CM(n){oE=n(oE)}function k4(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Sf(this),e,...t);return _M.set(r,e.sort?e.sort():[e]),Kn(r)}:R4().includes(n)?function(...e){return n.apply(Sf(this),e),Kn(EM.get(this))}:function(...e){return Kn(n.apply(Sf(this),e))}}function P4(n){return typeof n=="function"?k4(n):(n instanceof IDBTransaction&&O4(n),N4(n,M4())?new Proxy(n,oE):n)}function Kn(n){if(n instanceof IDBRequest)return x4(n);if(iE.has(n))return iE.get(n);let e=P4(n);return e!==n&&(iE.set(n,e),aE.set(e,n)),e}var Sf=n=>aE.get(n);function SM(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=Kn(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Kn(o.result),c.oldVersion,c.newVersion,Kn(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var F4=["get","getKey","getAll","getAllKeys","count"],L4=["put","add","delete","clear"],cE=new Map;function bM(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(cE.get(e))return cE.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=L4.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||F4.includes(t)))return;let s=async function(o,...a){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[t](...a),i&&c.done]))[0]};return cE.set(e,s),s}CM(n=>Ce(K({},n),{get:(e,t,r)=>bM(e,t)||n.get(e,t,r),has:(e,t)=>!!bM(e,t)||n.has(e,t)}));var uE=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(B4(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function B4(n){return n.getComponent()?.type==="VERSION"}var dE="@firebase/app",TM="0.14.2";var Ar=new Uo("@firebase/app"),V4="@firebase/app-compat",U4="@firebase/analytics-compat",j4="@firebase/analytics",q4="@firebase/app-check-compat",H4="@firebase/app-check",$4="@firebase/auth",z4="@firebase/auth-compat",G4="@firebase/database",W4="@firebase/data-connect",K4="@firebase/database-compat",Q4="@firebase/functions",Y4="@firebase/functions-compat",Z4="@firebase/installations",J4="@firebase/installations-compat",X4="@firebase/messaging",eq="@firebase/messaging-compat",tq="@firebase/performance",nq="@firebase/performance-compat",rq="@firebase/remote-config",iq="@firebase/remote-config-compat",sq="@firebase/storage",oq="@firebase/storage-compat",aq="@firebase/firestore",cq="@firebase/ai",lq="@firebase/firestore-compat",uq="firebase",dq="12.2.0";var fE="[DEFAULT]",fq={[dE]:"fire-core",[V4]:"fire-core-compat",[j4]:"fire-analytics",[U4]:"fire-analytics-compat",[H4]:"fire-app-check",[q4]:"fire-app-check-compat",[$4]:"fire-auth",[z4]:"fire-auth-compat",[G4]:"fire-rtdb",[W4]:"fire-data-connect",[K4]:"fire-rtdb-compat",[Q4]:"fire-fn",[Y4]:"fire-fn-compat",[Z4]:"fire-iid",[J4]:"fire-iid-compat",[X4]:"fire-fcm",[eq]:"fire-fcm-compat",[tq]:"fire-perf",[nq]:"fire-perf-compat",[rq]:"fire-rc",[iq]:"fire-rc-compat",[sq]:"fire-gcs",[oq]:"fire-gcs-compat",[aq]:"fire-fst",[lq]:"fire-fst-compat",[cq]:"fire-vertex","fire-js":"fire-js",[uq]:"fire-js-all"};var Tf=new Map,hq=new Map,hE=new Map;function DM(n,e){try{n.container.addComponent(e)}catch(t){Ar.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function sl(n){let e=n.name;if(hE.has(e))return Ar.debug(`There were multiple attempts to register component ${e}.`),!1;hE.set(e,n);for(let t of Tf.values())DM(t,n);for(let t of hq.values())DM(t,n);return!0}function NM(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function MM(n){return n==null?!1:n.settings!==void 0}var pq={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},si=new il("app","Firebase",pq);var pE=class{constructor(e,t,r){this._isDeleted=!1,this._options=K({},e),this._config=K({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ir("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw si.create("app-deleted",{appName:this._name})}};var RM=dq;function gq(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=K({name:fE,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw si.create("bad-app-name",{appName:String(i)});if(t||(t=eE()),!t)throw si.create("no-options");let s=Tf.get(i);if(s){if(Bo(t,s.options)&&Bo(r,s.config))return s;throw si.create("duplicate-app",{appName:i})}let o=new bf(i);for(let c of hE.values())o.addComponent(c);let a=new pE(t,r,o);return Tf.set(i,a),a}function xM(n=fE){let e=Tf.get(n);if(!e&&n===fE&&eE())return gq();if(!e)throw si.create("no-app",{appName:n});return e}function oi(n,e,t){let r=fq[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ar.warn(o.join(" "));return}sl(new Ir(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var mq="firebase-heartbeat-database",yq=1,ol="firebase-heartbeat-store",lE=null;function OM(){return lE||(lE=SM(mq,yq,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ol)}catch(t){console.warn(t)}}}}).catch(n=>{throw si.create("idb-open",{originalErrorMessage:n.message})})),lE}async function vq(n){try{let t=(await OM()).transaction(ol),r=await t.objectStore(ol).get(kM(n));return await t.done,r}catch(e){if(e instanceof wr)Ar.warn(e.message);else{let t=si.create("idb-get",{originalErrorMessage:e?.message});Ar.warn(t.message)}}}async function wM(n,e){try{let r=(await OM()).transaction(ol,"readwrite");await r.objectStore(ol).put(e,kM(n)),await r.done}catch(t){if(t instanceof wr)Ar.warn(t.message);else{let r=si.create("idb-set",{originalErrorMessage:t?.message});Ar.warn(r.message)}}}function kM(n){return`${n.name}!${n.options.appId}`}var Eq=1024,_q=30,gE=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new mE(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=IM();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>_q){let i=bq(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ar.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=IM(),{heartbeatsToSend:t,unsentEntries:r}=Cq(this._heartbeatsCache.heartbeats),i=rl(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Ar.warn(e),""}}};function IM(){return new Date().toISOString().substring(0,10)}function Cq(n,e=Eq){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),AM(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),AM(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var mE=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nE()?mM().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await vq(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return wM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return wM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function AM(n){return rl(JSON.stringify({version:2,heartbeats:n})).length}function bq(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Sq(n){sl(new Ir("platform-logger",e=>new uE(e),"PRIVATE")),sl(new Ir("heartbeat",e=>new gE(e),"PRIVATE")),oi(dE,TM,n),oi(dE,TM,"esm2020"),oi("fire-js","")}Sq("");var Tq="firebase",Dq="12.2.1";oi(Tq,Dq,"app");import{TextEncoder as H5,inspect as $5,TextDecoder as ime}from"util";var PM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},FM={};var Nr,yE;(function(){var n;function e(C,y){function v(){}v.prototype=y.prototype,C.D=y.prototype,C.prototype=new v,C.prototype.constructor=C,C.C=function(E,g,S){for(var p=Array(arguments.length-2),m=2;m<arguments.length;m++)p[m-2]=arguments[m];return y.prototype[g].apply(E,p)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,y,v){v||(v=0);var E=Array(16);if(typeof y=="string")for(var g=0;16>g;++g)E[g]=y.charCodeAt(v++)|y.charCodeAt(v++)<<8|y.charCodeAt(v++)<<16|y.charCodeAt(v++)<<24;else for(g=0;16>g;++g)E[g]=y[v++]|y[v++]<<8|y[v++]<<16|y[v++]<<24;y=C.g[0],v=C.g[1],g=C.g[2];var S=C.g[3],p=y+(S^v&(g^S))+E[0]+3614090360&4294967295;y=v+(p<<7&4294967295|p>>>25),p=S+(g^y&(v^g))+E[1]+3905402710&4294967295,S=y+(p<<12&4294967295|p>>>20),p=g+(v^S&(y^v))+E[2]+606105819&4294967295,g=S+(p<<17&4294967295|p>>>15),p=v+(y^g&(S^y))+E[3]+3250441966&4294967295,v=g+(p<<22&4294967295|p>>>10),p=y+(S^v&(g^S))+E[4]+4118548399&4294967295,y=v+(p<<7&4294967295|p>>>25),p=S+(g^y&(v^g))+E[5]+1200080426&4294967295,S=y+(p<<12&4294967295|p>>>20),p=g+(v^S&(y^v))+E[6]+2821735955&4294967295,g=S+(p<<17&4294967295|p>>>15),p=v+(y^g&(S^y))+E[7]+4249261313&4294967295,v=g+(p<<22&4294967295|p>>>10),p=y+(S^v&(g^S))+E[8]+1770035416&4294967295,y=v+(p<<7&4294967295|p>>>25),p=S+(g^y&(v^g))+E[9]+2336552879&4294967295,S=y+(p<<12&4294967295|p>>>20),p=g+(v^S&(y^v))+E[10]+4294925233&4294967295,g=S+(p<<17&4294967295|p>>>15),p=v+(y^g&(S^y))+E[11]+2304563134&4294967295,v=g+(p<<22&4294967295|p>>>10),p=y+(S^v&(g^S))+E[12]+1804603682&4294967295,y=v+(p<<7&4294967295|p>>>25),p=S+(g^y&(v^g))+E[13]+4254626195&4294967295,S=y+(p<<12&4294967295|p>>>20),p=g+(v^S&(y^v))+E[14]+2792965006&4294967295,g=S+(p<<17&4294967295|p>>>15),p=v+(y^g&(S^y))+E[15]+1236535329&4294967295,v=g+(p<<22&4294967295|p>>>10),p=y+(g^S&(v^g))+E[1]+4129170786&4294967295,y=v+(p<<5&4294967295|p>>>27),p=S+(v^g&(y^v))+E[6]+3225465664&4294967295,S=y+(p<<9&4294967295|p>>>23),p=g+(y^v&(S^y))+E[11]+643717713&4294967295,g=S+(p<<14&4294967295|p>>>18),p=v+(S^y&(g^S))+E[0]+3921069994&4294967295,v=g+(p<<20&4294967295|p>>>12),p=y+(g^S&(v^g))+E[5]+3593408605&4294967295,y=v+(p<<5&4294967295|p>>>27),p=S+(v^g&(y^v))+E[10]+38016083&4294967295,S=y+(p<<9&4294967295|p>>>23),p=g+(y^v&(S^y))+E[15]+3634488961&4294967295,g=S+(p<<14&4294967295|p>>>18),p=v+(S^y&(g^S))+E[4]+3889429448&4294967295,v=g+(p<<20&4294967295|p>>>12),p=y+(g^S&(v^g))+E[9]+568446438&4294967295,y=v+(p<<5&4294967295|p>>>27),p=S+(v^g&(y^v))+E[14]+3275163606&4294967295,S=y+(p<<9&4294967295|p>>>23),p=g+(y^v&(S^y))+E[3]+4107603335&4294967295,g=S+(p<<14&4294967295|p>>>18),p=v+(S^y&(g^S))+E[8]+1163531501&4294967295,v=g+(p<<20&4294967295|p>>>12),p=y+(g^S&(v^g))+E[13]+2850285829&4294967295,y=v+(p<<5&4294967295|p>>>27),p=S+(v^g&(y^v))+E[2]+4243563512&4294967295,S=y+(p<<9&4294967295|p>>>23),p=g+(y^v&(S^y))+E[7]+1735328473&4294967295,g=S+(p<<14&4294967295|p>>>18),p=v+(S^y&(g^S))+E[12]+2368359562&4294967295,v=g+(p<<20&4294967295|p>>>12),p=y+(v^g^S)+E[5]+4294588738&4294967295,y=v+(p<<4&4294967295|p>>>28),p=S+(y^v^g)+E[8]+2272392833&4294967295,S=y+(p<<11&4294967295|p>>>21),p=g+(S^y^v)+E[11]+1839030562&4294967295,g=S+(p<<16&4294967295|p>>>16),p=v+(g^S^y)+E[14]+4259657740&4294967295,v=g+(p<<23&4294967295|p>>>9),p=y+(v^g^S)+E[1]+2763975236&4294967295,y=v+(p<<4&4294967295|p>>>28),p=S+(y^v^g)+E[4]+1272893353&4294967295,S=y+(p<<11&4294967295|p>>>21),p=g+(S^y^v)+E[7]+4139469664&4294967295,g=S+(p<<16&4294967295|p>>>16),p=v+(g^S^y)+E[10]+3200236656&4294967295,v=g+(p<<23&4294967295|p>>>9),p=y+(v^g^S)+E[13]+681279174&4294967295,y=v+(p<<4&4294967295|p>>>28),p=S+(y^v^g)+E[0]+3936430074&4294967295,S=y+(p<<11&4294967295|p>>>21),p=g+(S^y^v)+E[3]+3572445317&4294967295,g=S+(p<<16&4294967295|p>>>16),p=v+(g^S^y)+E[6]+76029189&4294967295,v=g+(p<<23&4294967295|p>>>9),p=y+(v^g^S)+E[9]+3654602809&4294967295,y=v+(p<<4&4294967295|p>>>28),p=S+(y^v^g)+E[12]+3873151461&4294967295,S=y+(p<<11&4294967295|p>>>21),p=g+(S^y^v)+E[15]+530742520&4294967295,g=S+(p<<16&4294967295|p>>>16),p=v+(g^S^y)+E[2]+3299628645&4294967295,v=g+(p<<23&4294967295|p>>>9),p=y+(g^(v|~S))+E[0]+4096336452&4294967295,y=v+(p<<6&4294967295|p>>>26),p=S+(v^(y|~g))+E[7]+1126891415&4294967295,S=y+(p<<10&4294967295|p>>>22),p=g+(y^(S|~v))+E[14]+2878612391&4294967295,g=S+(p<<15&4294967295|p>>>17),p=v+(S^(g|~y))+E[5]+4237533241&4294967295,v=g+(p<<21&4294967295|p>>>11),p=y+(g^(v|~S))+E[12]+1700485571&4294967295,y=v+(p<<6&4294967295|p>>>26),p=S+(v^(y|~g))+E[3]+2399980690&4294967295,S=y+(p<<10&4294967295|p>>>22),p=g+(y^(S|~v))+E[10]+4293915773&4294967295,g=S+(p<<15&4294967295|p>>>17),p=v+(S^(g|~y))+E[1]+2240044497&4294967295,v=g+(p<<21&4294967295|p>>>11),p=y+(g^(v|~S))+E[8]+1873313359&4294967295,y=v+(p<<6&4294967295|p>>>26),p=S+(v^(y|~g))+E[15]+4264355552&4294967295,S=y+(p<<10&4294967295|p>>>22),p=g+(y^(S|~v))+E[6]+2734768916&4294967295,g=S+(p<<15&4294967295|p>>>17),p=v+(S^(g|~y))+E[13]+1309151649&4294967295,v=g+(p<<21&4294967295|p>>>11),p=y+(g^(v|~S))+E[4]+4149444226&4294967295,y=v+(p<<6&4294967295|p>>>26),p=S+(v^(y|~g))+E[11]+3174756917&4294967295,S=y+(p<<10&4294967295|p>>>22),p=g+(y^(S|~v))+E[2]+718787259&4294967295,g=S+(p<<15&4294967295|p>>>17),p=v+(S^(g|~y))+E[9]+3951481745&4294967295,C.g[0]=C.g[0]+y&4294967295,C.g[1]=C.g[1]+(g+(p<<21&4294967295|p>>>11))&4294967295,C.g[2]=C.g[2]+g&4294967295,C.g[3]=C.g[3]+S&4294967295}r.prototype.u=function(C,y){y===void 0&&(y=C.length);for(var v=y-this.blockSize,E=this.B,g=this.h,S=0;S<y;){if(g==0)for(;S<=v;)i(this,C,S),S+=this.blockSize;if(typeof C=="string"){for(;S<y;)if(E[g++]=C.charCodeAt(S++),g==this.blockSize){i(this,E),g=0;break}}else for(;S<y;)if(E[g++]=C[S++],g==this.blockSize){i(this,E),g=0;break}}this.h=g,this.o+=y},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var y=1;y<C.length-8;++y)C[y]=0;var v=8*this.o;for(y=C.length-8;y<C.length;++y)C[y]=v&255,v/=256;for(this.u(C),C=Array(16),y=v=0;4>y;++y)for(var E=0;32>E;E+=8)C[v++]=this.g[y]>>>E&255;return C};function s(C,y){var v=a;return Object.prototype.hasOwnProperty.call(v,C)?v[C]:v[C]=y(C)}function o(C,y){this.h=y;for(var v=[],E=!0,g=C.length-1;0<=g;g--){var S=C[g]|0;E&&S==y||(v[g]=S,E=!1)}this.g=v}var a={};function c(C){return-128<=C&&128>C?s(C,function(y){return new o([y|0],0>y?-1:0)}):new o([C|0],0>C?-1:0)}function l(C){if(isNaN(C)||!isFinite(C))return d;if(0>C)return T(l(-C));for(var y=[],v=1,E=0;C>=v;E++)y[E]=C/v|0,v*=4294967296;return new o(y,0)}function u(C,y){if(C.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(C.charAt(0)=="-")return T(u(C.substring(1),y));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=l(Math.pow(y,8)),E=d,g=0;g<C.length;g+=8){var S=Math.min(8,C.length-g),p=parseInt(C.substring(g,g+S),y);8>S?(S=l(Math.pow(y,S)),E=E.j(S).add(l(p))):(E=E.j(v),E=E.add(l(p)))}return E}var d=c(0),f=c(1),h=c(16777216);n=o.prototype,n.m=function(){if(b(this))return-T(this).m();for(var C=0,y=1,v=0;v<this.g.length;v++){var E=this.i(v);C+=(0<=E?E:4294967296+E)*y,y*=4294967296}return C},n.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(_(this))return"0";if(b(this))return"-"+T(this).toString(C);for(var y=l(Math.pow(C,6)),v=this,E="";;){var g=w(v,y).g;v=D(v,g.j(y));var S=((0<v.g.length?v.g[0]:v.h)>>>0).toString(C);if(v=g,_(v))return S+E;for(;6>S.length;)S="0"+S;E=S+E}},n.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function _(C){if(C.h!=0)return!1;for(var y=0;y<C.g.length;y++)if(C.g[y]!=0)return!1;return!0}function b(C){return C.h==-1}n.l=function(C){return C=D(this,C),b(C)?-1:_(C)?0:1};function T(C){for(var y=C.g.length,v=[],E=0;E<y;E++)v[E]=~C.g[E];return new o(v,~C.h).add(f)}n.abs=function(){return b(this)?T(this):this},n.add=function(C){for(var y=Math.max(this.g.length,C.g.length),v=[],E=0,g=0;g<=y;g++){var S=E+(this.i(g)&65535)+(C.i(g)&65535),p=(S>>>16)+(this.i(g)>>>16)+(C.i(g)>>>16);E=p>>>16,S&=65535,p&=65535,v[g]=p<<16|S}return new o(v,v[v.length-1]&-2147483648?-1:0)};function D(C,y){return C.add(T(y))}n.j=function(C){if(_(this)||_(C))return d;if(b(this))return b(C)?T(this).j(T(C)):T(T(this).j(C));if(b(C))return T(this.j(T(C)));if(0>this.l(h)&&0>C.l(h))return l(this.m()*C.m());for(var y=this.g.length+C.g.length,v=[],E=0;E<2*y;E++)v[E]=0;for(E=0;E<this.g.length;E++)for(var g=0;g<C.g.length;g++){var S=this.i(E)>>>16,p=this.i(E)&65535,m=C.i(g)>>>16,O=C.i(g)&65535;v[2*E+2*g]+=p*O,k(v,2*E+2*g),v[2*E+2*g+1]+=S*O,k(v,2*E+2*g+1),v[2*E+2*g+1]+=p*m,k(v,2*E+2*g+1),v[2*E+2*g+2]+=S*m,k(v,2*E+2*g+2)}for(E=0;E<y;E++)v[E]=v[2*E+1]<<16|v[2*E];for(E=y;E<2*y;E++)v[E]=0;return new o(v,0)};function k(C,y){for(;(C[y]&65535)!=C[y];)C[y+1]+=C[y]>>>16,C[y]&=65535,y++}function P(C,y){this.g=C,this.h=y}function w(C,y){if(_(y))throw Error("division by zero");if(_(C))return new P(d,d);if(b(C))return y=w(T(C),y),new P(T(y.g),T(y.h));if(b(y))return y=w(C,T(y)),new P(T(y.g),y.h);if(30<C.g.length){if(b(C)||b(y))throw Error("slowDivide_ only works with positive integers.");for(var v=f,E=y;0>=E.l(C);)v=q(v),E=q(E);var g=z(v,1),S=z(E,1);for(E=z(E,2),v=z(v,2);!_(E);){var p=S.add(E);0>=p.l(C)&&(g=g.add(v),S=p),E=z(E,1),v=z(v,1)}return y=D(C,g.j(y)),new P(g,y)}for(g=d;0<=C.l(y);){for(v=Math.max(1,Math.floor(C.m()/y.m())),E=Math.ceil(Math.log(v)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),S=l(v),p=S.j(y);b(p)||0<p.l(C);)v-=E,S=l(v),p=S.j(y);_(S)&&(S=f),g=g.add(S),C=D(C,p)}return new P(g,C)}n.A=function(C){return w(this,C).h},n.and=function(C){for(var y=Math.max(this.g.length,C.g.length),v=[],E=0;E<y;E++)v[E]=this.i(E)&C.i(E);return new o(v,this.h&C.h)},n.or=function(C){for(var y=Math.max(this.g.length,C.g.length),v=[],E=0;E<y;E++)v[E]=this.i(E)|C.i(E);return new o(v,this.h|C.h)},n.xor=function(C){for(var y=Math.max(this.g.length,C.g.length),v=[],E=0;E<y;E++)v[E]=this.i(E)^C.i(E);return new o(v,this.h^C.h)};function q(C){for(var y=C.g.length+1,v=[],E=0;E<y;E++)v[E]=C.i(E)<<1|C.i(E-1)>>>31;return new o(v,C.h)}function z(C,y){var v=y>>5;y%=32;for(var E=C.g.length-v,g=[],S=0;S<E;S++)g[S]=0<y?C.i(S+v)>>>y|C.i(S+v+1)<<32-y:C.i(S+v);return new o(g,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,yE=FM.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=u,Nr=FM.Integer=o}).apply(typeof PM<"u"?PM:typeof self<"u"?self:typeof window<"u"?window:{});var Vs=zT(rk(),1),Uk=zT(hC(),1);import{randomBytes as z5}from"crypto";var ik="@firebase/firestore",sk="4.9.1";var ft=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ft.UNAUTHENTICATED=new ft(null);ft.GOOGLE_CREDENTIALS=new ft("google-credentials-uid");ft.FIRST_PARTY=new ft("first-party-uid");ft.MOCK_USER=new ft("mock-user");var G5="12.2.0";var Qa=G5;function W5(n){Qa=n}function K5(n){return $5(n,{depth:100})}var Us=new Uo("@firebase/firestore");function Da(){return Us.logLevel}function V(n,...e){if(Us.logLevel<=pe.DEBUG){let t=e.map(CT);Us.debug(`Firestore (${Qa}): ${n}`,...t)}}function Ln(n,...e){if(Us.logLevel<=pe.ERROR){let t=e.map(CT);Us.error(`Firestore (${Qa}): ${n}`,...t)}}function Ma(n,...e){if(Us.logLevel<=pe.WARN){let t=e.map(CT);Us.warn(`Firestore (${Qa}): ${n}`,...t)}}function CT(n){if(typeof n=="string")return n;try{return K5(n)}catch{return n}}function Y(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,jk(n,r,t)}function jk(n,e,t){let r=`FIRESTORE (${Qa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{let i=JSON.stringify(t);r+=" CONTEXT: "+i}catch{r+=" CONTEXT: "+t}throw Ln(r),new Error(r)}function Te(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||jk(e,i,r)}function X(n,e){return n}var x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},U=class extends wr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var kn=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Dp=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},$b=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ft.UNAUTHENTICATED))}shutdown(){}},zb=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Gb=class{constructor(e){this.authProvider=e,this.currentUser=ft.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){Te(this.tokenListener===void 0,42304);let r=this.tokenCounter,i=c=>this.tokenCounter!==r?(r=this.tokenCounter,t(c)):Promise.resolve(),s=new kn;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),s.resolve(),s=new kn,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),o())};this.authProvider.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.authProvider.getImmediate({optional:!0});c?a(c):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new kn)}},0),o()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.tokenCounter!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Te(typeof r.accessToken=="string",31837,{tokenData:r}),new Dp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string",2055,{currentUid:e}),new ft(e)}},Wb=class{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r,this.type="FirstParty",this.user=ft.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}},Kb=class{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r}getToken(){return Promise.resolve(new Wb(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(ft.FIRST_PARTY))}shutdown(){}invalidateToken(){}},wp=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Qb=class{constructor(e,t){this.appCheckProvider=t,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null,this.serverAppAppCheckToken=null,MM(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken)}start(e,t){Te(this.tokenListener===void 0,3512);let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.latestAppCheckToken;return this.latestAppCheckToken=s.token,V("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.tokenListener=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.appCheckProvider.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.serverAppAppCheckToken)return Promise.resolve(new wp(this.serverAppAppCheckToken));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Te(typeof t.token=="string",44558,{tokenResult:t}),this.latestAppCheckToken=t.token,new wp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}};function Q5(n){if(!n)return new $b;switch(n.type){case"firstParty":return new Kb(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new U(x.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function Y5(n){return z5(n)}var xa=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="",i=20;for(;r.length<i;){let s=Y5(40);for(let o=0;o<s.length;++o)r.length<i&&s[o]<t&&(r+=e.charAt(s[o]%e.length))}return r}};function ue(n,e){return n<e?-1:n>e?1:0}function bT(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),s=e.charAt(r);if(i!==s)return Lb(i)===Lb(s)?ue(i,s):Lb(i)?1:-1}return ue(n.length,e.length)}var Z5=55296,J5=57343;function Lb(n){let e=n.charCodeAt(0);return e>=Z5&&e<=J5}function js(n,e,t){return n.length!==e.length?!1:n.every((r,i)=>t(r,e[i]))}var ok="__name__",Ip=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&Y(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Y(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return ue(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):bT(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Nr.fromString(e.substring(4,e.length-2))}},Be=class n extends Ip{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new U(x.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},X5=/^[_a-zA-Z][_a-zA-Z0-9]*$/,en=class n extends Ip{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return X5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ok}static keyField(){return new n([ok])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new U(x.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new U(x.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(!(c==="\\"||c==="."||c==="`"))throw new U(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a==="."&&!o?(s(),i++):(r+=a,i++)}if(s(),o)throw new U(x.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var W=class n{constructor(e){this.path=e}static fromPath(e){return new n(Be.fromString(e))}static fromName(e){return new n(Be.fromString(e).popFirst(5))}static empty(){return new n(Be.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Be.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Be.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2===0}static fromSegments(e){return new n(new Be(e.slice()))}};function qk(n,e,t){if(!t)throw new U(x.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function eW(n,e,t,r){if(e===!0&&r===!0)throw new U(x.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ak(n){if(!W.isDocumentKey(n))throw new U(x.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ck(n){if(W.isDocumentKey(n))throw new U(x.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Hk(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ST(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=tW(n);return e?`a custom ${e} object`:"an object"}}else return typeof n=="function"?"a function":Y(12329,{type:typeof n})}function tW(n){return n.constructor?n.constructor.name:null}function Ap(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new U(x.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ST(n);throw new U(x.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Je(n,e){let t={typeString:n};return e&&(t.value=e),t}function cu(n,e){if(!Hk(n))throw new U(x.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}else if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new U(x.INVALID_ARGUMENT,t);return!0}var lk=-62135596800,uk=1e6,je=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-t*1e3)*uk);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new U(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new U(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<lk)throw new U(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return this.seconds*1e3+this.nanoseconds/uk}_compareTo(e){return this.seconds===e.seconds?ue(this.nanoseconds,e.nanoseconds):ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(cu(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-lk,t=String(e).padStart(12,"0"),r=String(this.nanoseconds).padStart(9,"0");return t+"."+r}};je._jsonSchemaVersion="firestore/timestamp/1.0";je._jsonSchema={type:Je("string",je._jsonSchemaVersion),seconds:Je("number"),nanoseconds:Je("number")};var ne=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new je(0,0))}static max(){return new n(new je(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return this.timestamp.seconds*1e6+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ql=-1;function nW(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ne.fromTimestamp(r===1e9?new je(t+1,0):new je(t,r));return new qs(i,W.empty(),e)}function rW(n){return new qs(n.readTime,n.key,Ql)}var qs=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(ne.min(),W.empty(),Ql)}static max(){return new n(ne.max(),W.empty(),Ql)}};function iW(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0||(t=W.comparator(n.documentKey,e.documentKey),t!==0)?t:ue(n.largestBatchId,e.largestBatchId)}var sW="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Yb=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Ya(n){if(n.code===x.FAILED_PRECONDITION&&n.message===sW)V("LocalStore","Unexpectedly lost primary lease");else throw n}var M=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Y(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(u=>{o[l]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function oW(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Za(n){return n.name==="IndexedDbTransactionError"}var cme=15*1e3,lme=60*1e3;var TT=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.setPreviousValue(i),this.writeNewSequenceNumber=i=>r.writeSequenceNumber(i))}setPreviousValue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t}}n.INVALID=-1;return n})(),bp="",aW="",cW="",lW="";function uW(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=dk(e)),e=dW(n.get(t),e);return dk(e)}function dW(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+=bp+cW;break;case bp:t+=bp+lW;break;default:t+=s}}return t}function dk(n){return n+bp+aW}var fW="remoteDocuments";var $k="owner";var zk="mutationQueues";var Gk="mutations";var Wk="documentMutations",hW="remoteDocumentsV14";var Kk="remoteDocumentGlobal";var Qk="targets";var Yk="targetDocuments";var Zk="targetGlobal",Jk="collectionParents";var Xk="clientMetadata";var eP="bundles";var tP="namedQueries";var pW="indexConfiguration";var gW="indexState";var mW="indexEntries";var nP="documentOverlays";var yW="globals";var vW=[zk,Gk,Wk,fW,Qk,$k,Zk,Yk],EW=vW,_W=[...EW,Xk],CW=[..._W,Kk],bW=[...CW,Jk],SW=[...bW,eP,tP],ume=[...SW,nP],TW=[zk,Gk,Wk,hW,Qk,$k,Zk,Yk,Xk,Kk,Jk,eP,tP,nP],DW=TW,wW=[...DW,pW,gW,mW];var dme=[...wW,yW];function fk(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ws(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function rP(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var qe=class n{constructor(e,t){this.comparator=e,this.root=t||Gl.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Gl.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gl.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Aa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Aa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Aa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Aa(this.root,e,this.comparator,!0)}},Aa=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)this.isReverse?e=e.left:e=e.right;else if(s===0){this.nodeStack.push(e);break}else this.nodeStack.push(e),this.isReverse?e=e.right:e=e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Gl=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let t=this;return!t.left.isRed()&&!t.left.left.isRed()&&(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let i,s=this;if(r(t,s.key)<0)!s.left.isEmpty()&&!s.left.isRed()&&!s.left.left.isRed()&&(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),!s.right.isEmpty()&&!s.right.isRed()&&!s.right.left.isRed()&&(s=s.moveRedRight()),r(t,s.key)===0){if(s.right.isEmpty())return n.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){let t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Y(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Y(14113,{key:this.key,value:this.value});let t=this.left.check();if(t!==this.right.check())throw Y(27949);return t+(this.isRed()?0:1)}}return n.EMPTY=null,n.RED=!0,n.BLACK=!1,n})(),Zb=class{constructor(){this.size=0}get key(){throw Y(57766)}get value(){throw Y(16141)}get color(){throw Y(16727)}get left(){throw Y(29726)}get right(){throw Y(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Gl(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};Gl.EMPTY=new Zb;var dt=class n{constructor(e){this.comparator=e,this.data=new qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(t!==void 0?r=this.data.getIteratorFrom(t):r=this.data.getIterator();r.hasNext();){let i=r.getNext();if(!e(i.key))return}}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Np(this.data.getIterator())}getIteratorFrom(e){return new Np(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Np=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var dr=class n{constructor(e){this.fields=e,e.sort(en.comparator)}static empty(){return new n([])}unionWith(e){let t=new dt(en.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return js(this.fields,e.fields,(t,r)=>t.isEqual(r))}};function IW(n){return Buffer.from(n,"base64").toString("binary")}function AW(n){return Buffer.from(n,"binary").toString("base64")}var At=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=IW(e);return new n(t)}static fromUint8Array(e){let t=NW(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return AW(this.binaryString)}toUint8Array(){return MW(this.binaryString)}approximateByteSize(){return this.binaryString.length*2}compareTo(e){return ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};At.EMPTY_BYTE_STRING=new At("");function NW(n){let e="";for(let t=0;t<n.length;++t)e+=String.fromCharCode(n[t]);return e}function MW(n){let e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}var RW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jr(n){if(Te(!!n,39018),typeof n=="string"){let e=0,t=RW.exec(n);if(Te(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}else{let e=Le(n.seconds),t=Le(n.nanos);return{seconds:e,nanos:t}}}function Le(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function qr(n){return typeof n=="string"?At.fromBase64String(n):At.fromUint8Array(n)}var iP="server_timestamp",sP="__type__",oP="__previous_value__",aP="__local_write_time__";function DT(n){return(n?.mapValue?.fields||{})[sP]?.stringValue===iP}function xW(n,e){let t={fields:{[sP]:{stringValue:iP},[aP]:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return e&&DT(e)&&(e=rg(e)),e&&(t.fields[oP]=e),{mapValue:t}}function rg(n){let e=n.mapValue.fields[oP];return DT(e)?rg(e):e}function Yl(n){let e=jr(n.mapValue.fields[aP].timestampValue);return new je(e.seconds,e.nanos)}var Jb=class{constructor(e,t,r,i,s,o,a,c,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=u}},Xb="(default)",Mp=class n{constructor(e,t){this.projectId=e,this.database=t||Xb}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Xb}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function OW(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new U(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mp(n.options.projectId,e)}var wT=-1;function ig(n){return n==null}function Zl(n){return n===0&&1/n===-1/0}function kW(n){return typeof n=="number"&&Number.isInteger(n)&&!Zl(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var IT="__type__",cP="__max__",Ep={mapValue:{fields:{__type__:{stringValue:cP}}}},AT="__vector__",Oa="value";function ki(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?DT(n)?4:dP(n)?9007199254740991:uP(n)?10:11:Y(28295,{value:n})}function Pn(n,e){if(n===e)return!0;let t=ki(n),r=ki(e);if(t!==r)return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yl(n).isEqual(Yl(e));case 3:return PW(n,e);case 5:return n.stringValue===e.stringValue;case 6:return LW(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return FW(n,e);case 2:return BW(n,e);case 9:return js(n.arrayValue.values||[],e.arrayValue.values||[],Pn);case 10:case 11:return VW(n,e);case 9007199254740991:return!0;default:return Y(52216,{left:n})}}function PW(n,e){if(typeof n.timestampValue=="string"&&typeof e.timestampValue=="string"&&n.timestampValue.length===e.timestampValue.length)return n.timestampValue===e.timestampValue;let t=jr(n.timestampValue),r=jr(e.timestampValue);return t.seconds===r.seconds&&t.nanos===r.nanos}function FW(n,e){return Le(n.geoPointValue.latitude)===Le(e.geoPointValue.latitude)&&Le(n.geoPointValue.longitude)===Le(e.geoPointValue.longitude)}function LW(n,e){return qr(n.bytesValue).isEqual(qr(e.bytesValue))}function BW(n,e){if("integerValue"in n&&"integerValue"in e)return Le(n.integerValue)===Le(e.integerValue);if("doubleValue"in n&&"doubleValue"in e){let t=Le(n.doubleValue),r=Le(e.doubleValue);return t===r?Zl(t)===Zl(r):isNaN(t)&&isNaN(r)}return!1}function VW(n,e){let t=n.mapValue.fields||{},r=e.mapValue.fields||{};if(fk(t)!==fk(r))return!1;for(let i in t)if(t.hasOwnProperty(i)&&(r[i]===void 0||!Pn(t[i],r[i])))return!1;return!0}function Jl(n,e){return(n.values||[]).find(t=>Pn(t,e))!==void 0}function ka(n,e){if(n===e)return 0;let t=ki(n),r=ki(e);if(t!==r)return ue(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ue(n.booleanValue,e.booleanValue);case 2:return UW(n,e);case 3:return hk(n.timestampValue,e.timestampValue);case 4:return hk(Yl(n),Yl(e));case 5:return bT(n.stringValue,e.stringValue);case 6:return HW(n.bytesValue,e.bytesValue);case 7:return jW(n.referenceValue,e.referenceValue);case 8:return qW(n.geoPointValue,e.geoPointValue);case 9:return lP(n.arrayValue,e.arrayValue);case 10:return $W(n.mapValue,e.mapValue);case 11:return zW(n.mapValue,e.mapValue);default:throw Y(23264,{leftType:t})}}function UW(n,e){let t=Le(n.integerValue||n.doubleValue),r=Le(e.integerValue||e.doubleValue);return t<r?-1:t>r?1:t===r?0:isNaN(t)?isNaN(r)?0:-1:1}function hk(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ue(n,e);let t=jr(n),r=jr(e),i=ue(t.seconds,r.seconds);return i!==0?i:ue(t.nanos,r.nanos)}function jW(n,e){let t=n.split("/"),r=e.split("/");for(let i=0;i<t.length&&i<r.length;i++){let s=ue(t[i],r[i]);if(s!==0)return s}return ue(t.length,r.length)}function qW(n,e){let t=ue(Le(n.latitude),Le(e.latitude));return t!==0?t:ue(Le(n.longitude),Le(e.longitude))}function HW(n,e){let t=qr(n),r=qr(e);return t.compareTo(r)}function lP(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=ka(t[i],r[i]);if(s)return s}return ue(t.length,r.length)}function $W(n,e){let t=n.fields||{},r=e.fields||{},i=t[Oa]?.arrayValue,s=r[Oa]?.arrayValue,o=ue(i?.values?.length||0,s?.values?.length||0);return o!==0?o:lP(i,s)}function zW(n,e){if(n===Ep.mapValue&&e===Ep.mapValue)return 0;if(n===Ep.mapValue)return 1;if(e===Ep.mapValue)return-1;let t=n.fields||{},r=Object.keys(t),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){let a=bT(r[o],s[o]);if(a!==0)return a;let c=ka(t[r[o]],i[s[o]]);if(c!==0)return c}return ue(r.length,s.length)}function Pa(n){return NT(n)}function NT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?WW(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?GW(n.bytesValue):"referenceValue"in n?QW(n.referenceValue):"geoPointValue"in n?KW(n.geoPointValue):"arrayValue"in n?ZW(n.arrayValue):"mapValue"in n?YW(n.mapValue):Y(61005,{value:n})}function GW(n){return qr(n).toBase64()}function WW(n){let e=jr(n);return`time(${e.seconds},${e.nanos})`}function KW(n){return`geo(${n.latitude},${n.longitude})`}function QW(n){return W.fromName(n).toString()}function YW(n){let e=Object.keys(n.fields||{}).sort(),t="{",r=!0;for(let i of e)r?r=!1:t+=",",t+=`${i}:${NT(n.fields[i])}`;return t+"}"}function ZW(n){let e="[",t=!0;for(let r of n.values||[])t?t=!1:e+=",",e+=NT(r);return e+"]"}function sg(n){switch(ki(n)){case 0:return 4;case 1:return 4;case 2:return 8;case 3:return 16;case 4:let e=rg(n);return e?16+sg(e):16;case 5:return n.stringValue.length*2;case 6:return qr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 8:return 16;case 9:return XW(n.arrayValue);case 10:case 11:return JW(n.mapValue);default:throw Y(13486,{value:n})}}function JW(n){let e=0;return Ws(n.fields,(t,r)=>{e+=t.length+sg(r)}),e}function XW(n){return(n.values||[]).reduce((e,t)=>e+sg(t),0)}function eS(n){return!!n&&"integerValue"in n}function e7(n){return!!n&&"doubleValue"in n}function t7(n){return eS(n)||e7(n)}function MT(n){return!!n&&"arrayValue"in n}function pk(n){return!!n&&"nullValue"in n}function gk(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Sp(n){return!!n&&"mapValue"in n}function uP(n){return(n?.mapValue?.fields||{})[IT]?.stringValue===AT}function Wl(n){if(n.geoPointValue)return{geoPointValue:K({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:K({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ws(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Wl(r)),e}else if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Wl(n.arrayValue.values[t]);return e}else return K({},n)}function dP(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===cP}var fme={mapValue:{fields:{[IT]:{stringValue:AT},[Oa]:{arrayValue:{}}}}};var On=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Sp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){let r=this.getFieldsMap(e.popLast());r[e.lastSegment()]=Wl(t)}setAll(e){let t=en.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Wl(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Sp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Pn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];(!Sp(i)||!i.mapValue.fields)&&(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ws(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Wl(this.value))}};function fP(n){let e=[];return Ws(n.fields,(t,r)=>{let i=new en([t]);if(Sp(r)){let o=fP(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new dr(e)}var Bn=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,ne.min(),ne.min(),ne.min(),On.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,ne.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,ne.min(),ne.min(),On.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ne.min(),ne.min(),On.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(ne.min())&&(this.documentType===2||this.documentType===0)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=On.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=On.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};function n7(n,e,t){let r=e.data.field(n),i=t.data.field(n);return r!==null&&i!==null?ka(r,i):Y(42886)}var Fa=class{constructor(e,t){this.position=e,this.inclusive=t}};function hP(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField())r=W.comparator(W.fromName(o.referenceValue),t.key);else{let a=t.data.field(s.field);r=ka(o,a)}if(s.dir==="desc"&&(r=r*-1),r!==0)break}return r}function r7(n,e,t){let r=hP(n,e,t);return n.inclusive?r>=0:r>0}function i7(n,e,t){let r=hP(n,e,t);return n.inclusive?r<=0:r<0}function mk(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++){let r=n.position[t],i=e.position[t];if(!Pn(r,i))return!1}return!0}var La=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function s7(n){return n.field.canonicalString()+n.dir}function o7(n){return`${n.field.canonicalString()} (${n.dir})`}function a7(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Rp=class{},tt=class n extends Rp{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new nS(e,t,r):t==="array-contains"?new sS(e,r):t==="in"?new oS(e,r):t==="not-in"?new aS(e,r):t==="array-contains-any"?new cS(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new rS(e,r):new iS(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ka(t,this.value)):t!==null&&ki(this.value)===ki(t)&&this.matchesComparison(ka(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},hr=class n extends Rp{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new n(e,t)}matches(e){return pP(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.memoizedFlattenedFilters!==null?this.memoizedFlattenedFilters:(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[]),this.memoizedFlattenedFilters)}getFilters(){return Object.assign([],this.filters)}};function pP(n){return n.op==="and"}function gP(n){return c7(n)&&pP(n)}function c7(n){for(let e of n.filters)if(e instanceof hr)return!1;return!0}function tS(n){if(n instanceof tt)return n.field.canonicalString()+n.op.toString()+Pa(n.value);if(gP(n))return n.filters.map(e=>tS(e)).join(",");{let e=n.filters.map(t=>tS(t)).join(",");return`${n.op}(${e})`}}function mP(n,e){if(n instanceof tt)return l7(n,e);if(n instanceof hr)return u7(n,e);Y(19439)}function l7(n,e){return e instanceof tt&&n.op===e.op&&n.field.isEqual(e.field)&&Pn(n.value,e.value)}function u7(n,e){return e instanceof hr&&n.op===e.op&&n.filters.length===e.filters.length?n.filters.reduce((r,i,s)=>r&&mP(i,e.filters[s]),!0):!1}function yP(n){return n instanceof tt?f7(n):n instanceof hr?d7(n):"Filter"}function d7(n){return n.op.toString()+" {"+n.getFilters().map(yP).join(" ,")+"}"}function f7(n){return`${n.field.canonicalString()} ${n.op} ${Pa(n.value)}`}var nS=class extends tt{constructor(e,t,r){super(e,t,r),this.key=W.fromName(r.referenceValue)}matches(e){let t=W.comparator(e.key,this.key);return this.matchesComparison(t)}},rS=class extends tt{constructor(e,t){super(e,"in",t),this.keys=vP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},iS=class extends tt{constructor(e,t){super(e,"not-in",t),this.keys=vP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function vP(n,e){return(e.arrayValue?.values||[]).map(t=>W.fromName(t.referenceValue))}var sS=class extends tt{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return MT(t)&&Jl(t.arrayValue,this.value)}},oS=class extends tt{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Jl(this.value.arrayValue,t)}},aS=class extends tt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Jl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Jl(this.value.arrayValue,t)}},cS=class extends tt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!MT(t)||!t.arrayValue.values?!1:t.arrayValue.values.some(r=>Jl(this.value.arrayValue,r))}};var lS=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}};function yk(n,e=null,t=[],r=[],i=null,s=null,o=null){return new lS(n,e,t,r,i,s,o)}function RT(n){let e=X(n);if(e.memoizedCanonicalId===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>tS(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>s7(r)).join(","),ig(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Pa(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Pa(r)).join(",")),e.memoizedCanonicalId=t}return e.memoizedCanonicalId}function h7(n){let e=n.path.canonicalString();return n.collectionGroup!==null&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>yP(t)).join(", ")}]`),ig(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>o7(t)).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>Pa(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>Pa(t)).join(",")),`Target(${e})`}function xT(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!a7(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!mP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup!==e.collectionGroup||!n.path.isEqual(e.path)||!mk(n.startAt,e.startAt)?!1:mk(n.endAt,e.endAt)}function uS(n){return W.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Ba=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}};function p7(n,e,t,r,i,s,o,a){return new Ba(n,e,t,r,i,s,o,a)}function EP(n){return new Ba(n)}function g7(n,e){return new Ba(e,null,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function vk(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function m7(n){let e=new dt(en.comparator);return n.filters.forEach(t=>{t.getFlattenedFilters().forEach(i=>{i.isInequality()&&(e=e.add(i.field))})}),e}function y7(n){return W.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function v7(n){return n.collectionGroup!==null}function Xl(n){let e=X(n);if(e.memoizedNormalizedOrderBy===null){e.memoizedNormalizedOrderBy=[];let t=new Set;for(let s of e.explicitOrderBy)e.memoizedNormalizedOrderBy.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";m7(e).forEach(s=>{!t.has(s.canonicalString())&&!s.isKeyField()&&e.memoizedNormalizedOrderBy.push(new La(s,r))}),t.has(en.keyField().canonicalString())||e.memoizedNormalizedOrderBy.push(new La(en.keyField(),r))}return e.memoizedNormalizedOrderBy}function Fn(n){let e=X(n);return e.memoizedTarget||(e.memoizedTarget=E7(e,Xl(n))),e.memoizedTarget}function E7(n,e){if(n.limitType==="F")return yk(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new La(i.field,s)});let t=n.endAt?new Fa(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Fa(n.startAt.position,n.startAt.inclusive):null;return yk(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function dS(n,e,t){return new Ba(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function og(n,e){return xT(Fn(n),Fn(e))&&n.limitType===e.limitType}function _P(n){return`${RT(Fn(n))}|lt:${n.limitType}`}function wa(n){return`Query(target=${h7(Fn(n))}; limitType=${n.limitType})`}function ag(n,e){return e.isFoundDocument()&&_7(n,e)&&C7(n,e)&&b7(n,e)&&S7(n,e)}function _7(n,e){let t=e.key.path;return n.collectionGroup!==null?e.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(t):W.isDocumentKey(n.path)?n.path.isEqual(t):n.path.isImmediateParentOf(t)}function C7(n,e){for(let t of Xl(n))if(!t.field.isKeyField()&&e.data.field(t.field)===null)return!1;return!0}function b7(n,e){for(let t of n.filters)if(!t.matches(e))return!1;return!0}function S7(n,e){return!(n.startAt&&!i7(n.startAt,Xl(n),e)||n.endAt&&!r7(n.endAt,Xl(n),e))}function T7(n){return n.collectionGroup||(n.path.length%2===1?n.path.lastSegment():n.path.get(n.path.length-2))}function CP(n){return(e,t)=>{let r=!1;for(let i of Xl(n)){let s=D7(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function D7(n,e,t){let r=n.field.isKeyField()?W.comparator(e.key,t.key):n7(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Y(19790,{direction:n.dir})}}var Hr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0){this.inner[r]=[[e,t]],this.innerSize++;return}for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e)){i[s]=[e,t];return}i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ws(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return rP(this.inner)}size(){return this.innerSize}};var w7=new qe(W.comparator);function $r(){return w7}var bP=new qe(W.comparator);function zl(...n){let e=bP;for(let t of n)e=e.insert(t.key,t);return e}function I7(){return eu()}function SP(n){let e=bP;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Fs(){return eu()}function TP(){return eu()}function eu(){return new Hr(n=>n.toString(),(n,e)=>n.isEqual(e))}var A7=new qe(W.comparator);function N7(){return A7}var M7=new dt(W.comparator);function le(...n){let e=M7;for(let t of n)e=e.add(t);return e}var R7=new dt(ue);function x7(){return R7}function OT(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zl(e)?"-0":e}}function DP(n){return{integerValue:""+n}}function O7(n,e){return kW(e)?DP(e):OT(n,e)}var Va=class{constructor(){this._=void 0}};function k7(n,e,t){return n instanceof Ua?xW(t,e):n instanceof Hs?IP(n,e):n instanceof $s?AP(n,e):L7(n,e)}function P7(n,e,t){return n instanceof Hs?IP(n,e):n instanceof $s?AP(n,e):t}function wP(n,e){return n instanceof ja?t7(e)?e:{integerValue:0}:null}function F7(n,e){return n instanceof Hs&&e instanceof Hs||n instanceof $s&&e instanceof $s?js(n.elements,e.elements,Pn):n instanceof ja&&e instanceof ja?Pn(n.operand,e.operand):n instanceof Ua&&e instanceof Ua}var Ua=class extends Va{},Hs=class extends Va{constructor(e){super(),this.elements=e}};function IP(n,e){let t=NP(e);for(let r of n.elements)t.some(i=>Pn(i,r))||t.push(r);return{arrayValue:{values:t}}}var $s=class extends Va{constructor(e){super(),this.elements=e}};function AP(n,e){let t=NP(e);for(let r of n.elements)t=t.filter(i=>!Pn(i,r));return{arrayValue:{values:t}}}var ja=class extends Va{constructor(e,t){super(),this.serializer=e,this.operand=t}};function L7(n,e){let t=wP(n,e),r=Ek(t)+Ek(n.operand);return eS(t)&&eS(n.operand)?DP(r):OT(n.serializer,r)}function Ek(n){return Le(n.integerValue||n.doubleValue)}function NP(n){return MT(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function B7(n,e){return n.field.isEqual(e.field)&&F7(n.transform,e.transform)}function V7(n,e){return n===void 0&&e===void 0?!0:n&&e?js(n,e,(t,r)=>B7(t,r)):!1}var fS=class{constructor(e,t){this.version=e,this.transformResults=t}},Bs=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function cg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists!==void 0?n.exists===e.isFoundDocument():!0}var qa=class{};function MP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new xp(n.key,Bs.none()):new zs(n.key,n.data,Bs.none());{let t=n.data,r=On.empty(),i=new dt(en.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new zr(n.key,r,new dr(i.toArray()),Bs.none())}}function U7(n,e,t){n instanceof zs?q7(n,e,t):n instanceof zr?$7(n,e,t):G7(n,e,t)}function Kl(n,e,t,r){return n instanceof zs?H7(n,e,t,r):n instanceof zr?z7(n,e,t,r):W7(n,e,t)}function j7(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=wP(r.transform,i||null);s!=null&&(t===null&&(t=On.empty()),t.set(r.field,s))}return t||null}function _k(n,e){return n.type!==e.type||!n.key.isEqual(e.key)||!n.precondition.isEqual(e.precondition)||!V7(n.fieldTransforms,e.fieldTransforms)?!1:n.type===0?n.value.isEqual(e.value):n.type===1?n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask):!0}var zs=class extends qa{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}};function q7(n,e,t){let r=n.value.clone(),i=xP(n.fieldTransforms,e,t.transformResults);r.setAll(i),e.convertToFoundDocument(t.version,r).setHasCommittedMutations()}function H7(n,e,t,r){if(!cg(n.precondition,e))return t;let i=n.value.clone(),s=OP(n.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}var zr=class extends qa{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function $7(n,e,t){if(!cg(n.precondition,e)){e.convertToUnknownDocument(t.version);return}let r=xP(n.fieldTransforms,e,t.transformResults),i=e.data;i.setAll(RP(n)),i.setAll(r),e.convertToFoundDocument(t.version,i).setHasCommittedMutations()}function z7(n,e,t,r){if(!cg(n.precondition,e))return t;let i=OP(n.fieldTransforms,r,e),s=e.data;return s.setAll(RP(n)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),t===null?null:t.unionWith(n.fieldMask.fields).unionWith(n.fieldTransforms.map(o=>o.field))}function RP(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function xP(n,e,t){let r=new Map;Te(n.length===t.length,32656,{serverTransformResultCount:t.length,fieldTransformCount:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,P7(o,a,t[i]))}return r}function OP(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,k7(s,o,e))}return r}var xp=class extends qa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};function G7(n,e,t){e.convertToNoDocument(t.version).setHasCommittedMutations()}function W7(n,e,t){return cg(n.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):t}var hS=class extends qa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var pS=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];if(s.key.isEqual(e.key)){let o=r[i];U7(s,e,o)}}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Kl(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Kl(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=TP();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=MP(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(ne.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),le())}isEqual(e){return this.batchId===e.batchId&&js(this.mutations,e.mutations,(t,r)=>_k(t,r))&&js(this.baseMutations,e.baseMutations,(t,r)=>_k(t,r))}},gS=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Te(e.mutations.length===r.length,58842,{mutationsSent:e.mutations.length,resultsReceived:r.length});let i=N7(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var mS=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var yS=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ut=(function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n})(ut||{});function K7(n){switch(n){case x.OK:return Y(64938);case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0;default:return Y(15467,{code:n})}}function Q7(n){return K7(n)&&n!==x.ABORTED}function Tp(n){if(n===void 0)return Ln("GRPC error has no .code"),x.UNKNOWN;switch(n){case ut.OK:return x.OK;case ut.CANCELLED:return x.CANCELLED;case ut.UNKNOWN:return x.UNKNOWN;case ut.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case ut.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case ut.INTERNAL:return x.INTERNAL;case ut.UNAVAILABLE:return x.UNAVAILABLE;case ut.UNAUTHENTICATED:return x.UNAUTHENTICATED;case ut.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case ut.NOT_FOUND:return x.NOT_FOUND;case ut.ALREADY_EXISTS:return x.ALREADY_EXISTS;case ut.PERMISSION_DENIED:return x.PERMISSION_DENIED;case ut.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case ut.ABORTED:return x.ABORTED;case ut.OUT_OF_RANGE:return x.OUT_OF_RANGE;case ut.UNIMPLEMENTED:return x.UNIMPLEMENTED;case ut.DATA_LOSS:return x.DATA_LOSS;default:return Y(39323,{code:n})}}var vS=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Y7=null;function kP(){return new H5}var Z7=new Nr([4294967295,4294967295],0);function Ck(n){let e=kP().encode(n),t=new yE;return t.update(e),new Uint8Array(t.digest())}function bk(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0),o=new Nr([t,r],0),a=new Nr([i,s],0);return[o,a]}var ES=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ls(`Invalid padding: ${t}`);if(r<0)throw new Ls(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ls(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ls(`Invalid padding when bitmap length is 0: ${t}`);this.bitCount=e.length*8-t,this.bitCountInInteger=Nr.fromNumber(this.bitCount)}getBitIndex(e,t,r){let i=e.add(t.multiply(Nr.fromNumber(r)));return i.compare(Z7)===1&&(i=new Nr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){let t=this.bitmap[Math.floor(e/8)],r=e%8;return(t&1<<r)!==0}mightContain(e){if(this.bitCount===0)return!1;let t=Ck(e),[r,i]=bk(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(r,i,s);if(!this.isBitSet(o))return!1}return!0}static create(e,t,r){let i=e%8===0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.bitCount===0)return;let t=Ck(e),[r,i]=bk(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(r,i,s);this.setBit(o)}}setBit(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Ls=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Op=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,tu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(ne.min(),i,new qe(ue),$r(),le())}},tu=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,le(),le(),le())}};var Ra=class{constructor(e,t,r,i){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=r,this.newDoc=i}},kp=class{constructor(e,t){this.targetId=e,this.existenceFilter=t}},Pp=class{constructor(e,t,r=At.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Fp=class{constructor(){this.pendingResponses=0,this.documentChanges=Sk(),this._resumeToken=At.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return this.pendingResponses!==0}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=le(),t=le(),r=le();return this.documentChanges.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Y(38017,{changeType:s})}}),new tu(this._resumeToken,this._current,e,t,r)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=Sk()}addDocumentChange(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,Te(this.pendingResponses>=0,3241,{pendingResponses:this.pendingResponses})}markCurrent(){this._hasPendingChanges=!0,this._current=!0}},J7="WatchChangeAggregator",_S=class{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=$r(),this.pendingDocumentUpdatesByTarget=_p(),this.pendingDocumentTargetMapping=_p(),this.pendingTargetResets=new qe(ue)}handleDocumentChange(e){for(let t of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(t,e.newDoc):this.removeDocumentFromTarget(t,e.key,e.newDoc);for(let t of e.removedTargetIds)this.removeDocumentFromTarget(t,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,t=>{let r=this.ensureTargetState(t);switch(e.state){case 0:this.isActiveTarget(t)&&r.updateResumeToken(e.resumeToken);break;case 1:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(e.resumeToken);break;case 2:r.recordTargetResponse(),r.isPending||this.removeTarget(t);break;case 3:this.isActiveTarget(t)&&(r.markCurrent(),r.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(t)&&(this.resetTarget(t),r.updateResumeToken(e.resumeToken));break;default:Y(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.targetStates.forEach((r,i)=>{this.isActiveTarget(i)&&t(i)})}handleExistenceFilter(e){let t=e.targetId,r=e.existenceFilter.count,i=this.targetDataForActiveTarget(t);if(i){let s=i.target;if(uS(s))if(r===0){let o=new W(s.path);this.removeDocumentFromTarget(t,o,Bn.newNoDocument(o,ne.min()))}else Te(r===1,20013,{expectedCount:r});else{let o=this.getCurrentDocumentCountForTarget(t);if(o!==r){let a=this.parseBloomFilter(e),c=a?this.applyBloomFilter(a,e,o):1;if(c!==0){this.resetTarget(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(t,l)}Y7?.notifyOnExistenceFilterMismatch(X7(o,e.existenceFilter,this.metadataProvider.getDatabaseId(),a,c))}}}}parseBloomFilter(e){let t=e.existenceFilter.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o;try{o=qr(r).toUint8Array()}catch(c){if(c instanceof vS)return Ma("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}let a;try{a=new ES(o,i,s)}catch(c){return c instanceof Ls?Ma("BloomFilter error: ",c):Ma("Applying bloom filter failed: ",c),null}return a.bitCount===0?null:a}applyBloomFilter(e,t,r){let i=t.existenceFilter.count,s=this.filterRemovedDocuments(e,t.targetId);return i===r-s?0:2}filterRemovedDocuments(e,t){let r=this.metadataProvider.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.metadataProvider.getDatabaseId(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.removeDocumentFromTarget(t,s,null),i++)}),i}createRemoteEvent(e){let t=new Map;this.targetStates.forEach((s,o)=>{let a=this.targetDataForActiveTarget(o);if(a){if(s.current&&uS(a.target)){let c=new W(a.target.path);!this.ensureDocumentUpdateByTarget(c).has(o)&&!this.targetContainsDocument(o,c)&&this.removeDocumentFromTarget(o,c,Bn.newNoDocument(c,e))}s.hasPendingChanges&&(t.set(o,s.toTargetChange()),s.clearPendingChanges())}});let r=le();this.pendingDocumentTargetMapping.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.targetDataForActiveTarget(c);return l&&l.purpose!=="TargetPurposeLimboResolution"?(a=!1,!1):!0}),a&&(r=r.add(s))}),this.pendingDocumentUpdates.forEach((s,o)=>o.setReadTime(e));let i=new Op(e,t,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=$r(),this.pendingDocumentUpdatesByTarget=_p(),this.pendingDocumentTargetMapping=_p(),this.pendingTargetResets=new qe(ue),i}addDocumentToTarget(e,t){if(!this.isActiveTarget(e))return;let r=this.targetContainsDocument(e,t.key)?2:0;this.ensureTargetState(e).addDocumentChange(t.key,r),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(t.key,this.ensureDocumentUpdateByTarget(t.key).add(e)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}removeDocumentFromTarget(e,t,r){if(!this.isActiveTarget(e))return;let i=this.ensureTargetState(e);this.targetContainsDocument(e,t)?i.addDocumentChange(t,1):i.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).add(e)),r&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,r))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let r=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let t=this.targetStates.get(e);return t||(t=new Fp,this.targetStates.set(e,t)),t}ensureDocumentTargetMapping(e){let t=this.pendingDocumentTargetMapping.get(e);return t||(t=new dt(ue),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t}ensureDocumentUpdateByTarget(e){let t=this.pendingDocumentUpdatesByTarget.get(e);return t||(t=new dt(ue),this.pendingDocumentUpdatesByTarget=this.pendingDocumentUpdatesByTarget.insert(e,t)),t}isActiveTarget(e){let t=this.targetDataForActiveTarget(e)!==null;return t||V(J7,"Detected inactive target",e),t}targetDataForActiveTarget(e){let t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new Fp),this.metadataProvider.getRemoteKeysForTarget(e).forEach(r=>{this.removeDocumentFromTarget(e,r,null)})}targetContainsDocument(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)}};function _p(){return new qe(W.comparator)}function Sk(){return new qe(W.comparator)}function X7(n,e,t,r,i){let s={localCacheCount:n,existenceFilterCount:e.count,databaseId:t.database,projectId:t.projectId},o=e.unchangedNames;return o&&(s.bloomFilter={applied:i===0,hashCount:o?.hashCount??0,bitmapLength:o?.bits?.bitmap?.length??0,padding:o?.bits?.padding??0,mightContain:a=>r?.mightContain(a)??!1}),s}var eK=(()=>{let n={};return n.asc="ASCENDING",n.desc="DESCENDING",n})(),tK=(()=>{let n={};return n["<"]="LESS_THAN",n["<="]="LESS_THAN_OR_EQUAL",n[">"]="GREATER_THAN",n[">="]="GREATER_THAN_OR_EQUAL",n["=="]="EQUAL",n["!="]="NOT_EQUAL",n["array-contains"]="ARRAY_CONTAINS",n.in="IN",n["not-in"]="NOT_IN",n["array-contains-any"]="ARRAY_CONTAINS_ANY",n})(),nK=(()=>{let n={};return n.and="AND",n.or="OR",n})();var Lp=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function rK(n){let e=n.code===void 0?x.UNKNOWN:Tp(n.code);return new U(e,n.message||"")}function CS(n,e){return n.useProto3Json||ig(e)?e:{value:e}}function iK(n){let e;return typeof n=="object"?e=n.value:e=n,ig(e)?null:e}function Ur(n,e){if(n.useProto3Json){let r=new Date(e.seconds*1e3).toISOString().replace(/\.\d*/,"").replace("Z",""),i=("000000000"+e.nanoseconds).slice(-9);return`${r}.${i}Z`}else return{seconds:""+e.seconds,nanos:e.nanoseconds}}function PP(n){let e=jr(n);return new je(e.seconds,e.nanos)}function FP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function sK(n,e){return n.useProto3Json?(Te(e===void 0||typeof e=="string",58123),At.fromBase64String(e||"")):(Te(e===void 0||e instanceof Buffer||e instanceof Uint8Array,16193),At.fromUint8Array(e||new Uint8Array))}function oK(n,e){return Ur(n,e.toTimestamp())}function fr(n){return Te(!!n,49232),ne.fromTimestamp(PP(n))}function kT(n,e){return bS(n,e).canonicalString()}function bS(n,e){let t=cK(n).child("documents");return e===void 0?t:t.child(e)}function LP(n){let e=Be.fromString(n);return Te(HP(e),10190,{key:e.toString()}),e}function nu(n,e){return kT(n.databaseId,e.path)}function Bb(n,e){let t=LP(e);if(t.get(1)!==n.databaseId.projectId)throw new U(x.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new U(x.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new W(VP(t))}function BP(n,e){return kT(n.databaseId,e)}function aK(n){let e=LP(n);return e.length===4?Be.emptyPath():VP(e)}function SS(n){return new Be(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function cK(n){return new Be(["projects",n.projectId,"databases",n.database])}function VP(n){return Te(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Tk(n,e,t){return{name:nu(n,e),fields:t.value.mapValue.fields}}function lK(n,e){let t;if("targetChange"in e){e.targetChange;let r=uK(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=sK(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&rK(o);t=new Pp(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Bb(n,r.document.name),s=fr(r.document.updateTime),o=r.document.createTime?fr(r.document.createTime):ne.min(),a=new On({mapValue:{fields:r.document.fields}}),c=Bn.newFoundDocument(i,s,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];t=new Ra(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Bb(n,r.document),s=r.readTime?fr(r.readTime):ne.min(),o=Bn.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Ra([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Bb(n,r.document),s=r.removedTargetIds||[];t=new Ra([],s,i,null)}else if("filter"in e){e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new yS(i,s),a=r.targetId;t=new kp(a,o)}else return Y(11601,{change:e});return t}function uK(n){return n==="NO_CHANGE"?0:n==="ADD"?1:n==="REMOVE"?2:n==="CURRENT"?3:n==="RESET"?4:Y(39313,{state:n})}function dK(n){if(!("targetChange"in n))return ne.min();let e=n.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?ne.min():fr(e.readTime)}function fK(n,e){let t;if(e instanceof zs)t={update:Tk(n,e.key,e.value)};else if(e instanceof xp)t={delete:nu(n,e.key)};else if(e instanceof zr)t={update:Tk(n,e.key,e.data),updateMask:HK(e.fieldMask)};else if(e instanceof hS)t={verify:nu(n,e.key)};else return Y(16599,{mutationType:e.type});return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>mK(n,r))),e.precondition.isNone||(t.currentDocument=hK(n,e.precondition)),t}function hK(n,e){return e.updateTime!==void 0?{updateTime:oK(n,e.updateTime)}:e.exists!==void 0?{exists:e.exists}:Y(27497)}function pK(n,e){let t=n.updateTime?fr(n.updateTime):fr(e);return t.isEqual(ne.min())&&(t=fr(e)),new fS(t,n.transformResults||[])}function gK(n,e){return n&&n.length>0?(Te(e!==void 0,14353),n.map(t=>pK(t,e))):[]}function mK(n,e){let t=e.transform;if(t instanceof Ua)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof Hs)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof $s)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof ja)return{fieldPath:e.field.canonicalString(),increment:t.operand};throw Y(20930,{transform:e.transform})}function yK(n,e){return{documents:[BP(n,e.path)]}}function UP(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=BP(n,i);let s=bK(e.filters);s&&(t.structuredQuery.where=s);let o=TK(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=CS(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=wK(e.startAt)),e.endAt&&(t.structuredQuery.endAt=IK(e.endAt)),{queryTarget:t,parent:i}}function vK(n){let e=aK(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Te(r===1,65062);let u=t.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=SK(t.where));let o=[];t.orderBy&&(o=DK(t.orderBy));let a=null;t.limit&&(a=iK(t.limit));let c=null;t.startAt&&(c=AK(t.startAt));let l=null;return t.endAt&&(l=NK(t.endAt)),p7(e,i,o,s,a,"F",c,l)}function EK(n,e){let t=_K(e.purpose);return t==null?null:{"goog-listen-tags":t}}function _K(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Y(28987,{purpose:n})}}function CK(n,e){let t,r=e.target;if(uS(r)?t={documents:yK(n,r)}:t={query:UP(n,r).queryTarget},t.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){t.resumeToken=FP(n,e.resumeToken);let i=CS(n,e.expectedCount);i!==null&&(t.expectedCount=i)}else if(e.snapshotVersion.compareTo(ne.min())>0){t.readTime=Ur(n,e.snapshotVersion.toTimestamp());let i=CS(n,e.expectedCount);i!==null&&(t.expectedCount=i)}return t}function bK(n){if(n.length!==0)return qP(hr.create(n,"and"))}function SK(n){let e=jP(n);return e instanceof hr&&gP(e)?e.getFilters():[e]}function jP(n){return n.unaryFilter!==void 0?UK(n):n.fieldFilter!==void 0?jK(n):n.compositeFilter!==void 0?qK(n):Y(30097,{filter:n})}function TK(n){if(n.length!==0)return n.map(e=>FK(e))}function DK(n){return n.map(e=>LK(e))}function wK(n){return{before:n.inclusive,values:n.position}}function IK(n){return{before:!n.inclusive,values:n.position}}function AK(n){let e=!!n.before,t=n.values||[];return new Fa(t,e)}function NK(n){let e=!n.before,t=n.values||[];return new Fa(t,e)}function MK(n){return eK[n]}function RK(n){switch(n){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function xK(n){return tK[n]}function OK(n){return nK[n]}function kK(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Y(58110);default:return Y(50506)}}function PK(n){switch(n){case"AND":return"and";case"OR":return"or";default:return Y(1026)}}function Ia(n){return{fieldPath:n.canonicalString()}}function Na(n){return en.fromServerFormat(n.fieldPath)}function FK(n){return{field:Ia(n.field),direction:MK(n.dir)}}function LK(n){return new La(Na(n.field),RK(n.direction))}function qP(n){return n instanceof tt?VK(n):n instanceof hr?BK(n):Y(54877,{filter:n})}function BK(n){let e=n.getFilters().map(t=>qP(t));return e.length===1?e[0]:{compositeFilter:{op:OK(n.op),filters:e}}}function VK(n){if(n.op==="=="){if(gk(n.value))return{unaryFilter:{field:Ia(n.field),op:"IS_NAN"}};if(pk(n.value))return{unaryFilter:{field:Ia(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(gk(n.value))return{unaryFilter:{field:Ia(n.field),op:"IS_NOT_NAN"}};if(pk(n.value))return{unaryFilter:{field:Ia(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ia(n.field),op:xK(n.op),value:n.value}}}function UK(n){switch(n.unaryFilter.op){case"IS_NAN":let e=Na(n.unaryFilter.field);return tt.create(e,"==",{doubleValue:NaN});case"IS_NULL":let t=Na(n.unaryFilter.field);return tt.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let r=Na(n.unaryFilter.field);return tt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=Na(n.unaryFilter.field);return tt.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Y(61313);default:return Y(60726)}}function jK(n){return tt.create(Na(n.fieldFilter.field),kK(n.fieldFilter.op),n.fieldFilter.value)}function qK(n){return hr.create(n.compositeFilter.filters.map(e=>jP(e)),PK(n.compositeFilter.op))}function HK(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function HP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var ru=class n{constructor(e,t,r,i,s=ne.min(),o=ne.min(),a=At.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var TS=class{constructor(e){this.remoteSerializer=e}};function $K(n){let e=vK({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?dS(e,e.limit,"L"):e}function zK(n){return{name:n.name,query:$K(n.bundledQuery),readTime:fr(n.readTime)}}function GK(n){return{id:n.id,version:n.version,createTime:fr(n.createTime)}}var WK=5,KK=10,QK=13,Vb=15,YK=20,ZK=25,JK=30,XK=37,eQ=45,tQ=50,nQ=53,rQ=55,iQ=60,sQ=2,Bp=class{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,WK);else if("booleanValue"in e)this.writeValueTypeLabel(t,KK),t.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(t,Vb),t.writeNumber(Le(e.integerValue));else if("doubleValue"in e){let r=Le(e.doubleValue);isNaN(r)?this.writeValueTypeLabel(t,QK):(this.writeValueTypeLabel(t,Vb),Zl(r)?t.writeNumber(0):t.writeNumber(r))}else if("timestampValue"in e){let r=e.timestampValue;this.writeValueTypeLabel(t,YK),typeof r=="string"&&(r=jr(r)),t.writeString(`${r.seconds||""}`),t.writeNumber(r.nanos||0)}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,JK),t.writeBytes(qr(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.writeValueTypeLabel(t,eQ),t.writeNumber(r.latitude||0),t.writeNumber(r.longitude||0)}else"mapValue"in e?dP(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):uP(e)?this.writeIndexVector(e.mapValue,t):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):Y(19022,{indexValue:e})}writeIndexString(e,t){this.writeValueTypeLabel(t,ZK),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let r=e.fields||{};this.writeValueTypeLabel(t,rQ);for(let i of Object.keys(r))this.writeIndexString(i,t),this.writeIndexValueAux(r[i],t)}writeIndexVector(e,t){let r=e.fields||{};this.writeValueTypeLabel(t,nQ);let i=Oa,s=r[i].arrayValue?.values?.length||0;this.writeValueTypeLabel(t,Vb),t.writeNumber(Le(s)),this.writeIndexString(i,t),this.writeIndexValueAux(r[i],t)}writeIndexArray(e,t){let r=e.values||[];this.writeValueTypeLabel(t,tQ);for(let i of r)this.writeIndexValueAux(i,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,XK),W.fromName(e).path.forEach(i=>{this.writeValueTypeLabel(t,iQ),this.writeUnlabeledIndexString(i,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(sQ)}};Bp.INSTANCE=new Bp;var DS=class{constructor(){this.collectionParentIndex=new wS}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),M.resolve()}getCollectionParents(e,t){return M.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return M.resolve()}deleteFieldIndex(e,t){return M.resolve()}deleteAllFieldIndexes(e){return M.resolve()}createTargetIndexes(e,t){return M.resolve()}getDocumentsMatchingTarget(e,t){return M.resolve(null)}getIndexType(e,t){return M.resolve(0)}getFieldIndexes(e,t){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,t){return M.resolve(qs.min())}getMinOffsetFromCollectionGroup(e,t){return M.resolve(qs.min())}updateCollectionGroup(e,t,r){return M.resolve()}updateIndexEntries(e,t){return M.resolve()}},wS=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new dt(Be.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new dt(Be.comparator)).toArray()}};var hme=new Uint8Array(0);var Ub=2,iu=class n{constructor(e){this.lastId=e}next(){return this.lastId+=Ub,this.lastId}static forTargetCache(){return new n(2-Ub)}static forSyncEngine(){return new n(1-Ub)}};var Dk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lg=-1,$P=40*1024*1024,En=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};En.DEFAULT_COLLECTION_PERCENTILE=10;En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3;En.DEFAULT=new En($P,En.DEFAULT_COLLECTION_PERCENTILE,En.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);En.DISABLED=new En(lg,0,0);var wk="LruGarbageCollector",Ik=1*1024*1024,oQ=60*1e3,aQ=300*1e3;function Ak([n,e],[t,r]){let i=ue(n,t);return i===0?ue(e,r):i}var IS=class{constructor(e){this.maxElements=e,this.buffer=new dt(Ak),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Ak(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},AS=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==lg&&this.scheduleGC(oQ)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return this.gcTask!==null}scheduleGC(e){V(wk,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Za(t)?V(wk,"Ignoring IndexedDB error during garbage collection: ",t):await Ya(t)}await this.scheduleGC(aQ)})}},NS=class{constructor(e,t){this.delegate=e,this.params=t}calculateTargetCount(e,t){return this.delegate.getSequenceNumberCount(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return M.resolve(TT.INVALID);let r=new IS(t);return this.delegate.forEachTarget(e,i=>r.addElement(i.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,i=>r.addElement(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.delegate.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.delegate.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===lg?(V("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(Dk)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Dk):this.runGarbageCollection(e,t))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,t){let r,i,s,o,a,c,l,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,t))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>{if(l=Date.now(),Da()<=pe.DEBUG){let f=`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in ${a-o}ms
	Removed ${s} targets in ${c-a}ms
	Removed ${d} documents in ${l-c}ms
Total Duration: ${l-u}ms`;V("LruGarbageCollector",f)}return M.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})})}};function cQ(n,e){return new NS(n,e)}var MS=class{constructor(){this.changes=new Hr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Bn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?M.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var RS=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var xS=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Kl(r.mutation,i,dr.empty(),je.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,le()).next(()=>r))}getLocalViewOfDocuments(e,t,r=le()){let i=Fs();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=zl();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Fs();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,le()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=$r(),o=eu(),a=I7();return t.forEach((c,l)=>{let u=r.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof zr)?s=s.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),Kl(u.mutation,l,u.mutation.getFieldMask(),je.now())):o.set(l.key,dr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),t.forEach((l,u)=>a.set(l,new RS(u,o.get(l)??null))),a))}recalculateAndSaveOverlays(e,t){let r=eu(),i=new qe((o,a)=>o-a),s=le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let u=r.get(c)||dr.empty();u=a.applyToLocalView(l,u),r.set(c,u);let d=(i.get(a.batchId)||le()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,u=c.value,d=TP();u.forEach(f=>{if(!s.has(f)){let h=MP(t.get(f),r.get(f));h!==null&&d.set(f,h),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return M.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return y7(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):v7(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):M.resolve(Fs()),a=Ql,c=s;return o.next(l=>M.forEach(l,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?M.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{c=c.insert(u,f)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,le())).next(u=>({batchId:a,changes:SP(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new W(t)).next(r=>{let i=zl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=zl();return this.indexManager.getCollectionParents(e,s).next(a=>M.forEach(a,c=>{let l=g7(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(u=>{u.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let u=l.getKey();o.get(u)===null&&(o=o.insert(u,Bn.newInvalidDocument(u)))});let a=zl();return o.forEach((c,l)=>{let u=s.get(c);u!==void 0&&Kl(u.mutation,l,dr.empty(),je.now()),ag(t,l)&&(a=a.insert(c,l))}),a})}};var OS=class{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return M.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,GK(t)),M.resolve()}getNamedQuery(e,t){return M.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,zK(t)),M.resolve()}};var kS=class{constructor(){this.overlays=new qe(W.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return M.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Fs();return M.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.saveOverlay(e,t,s)}),M.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.overlayByBatchId.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.overlayByBatchId.delete(r)),M.resolve()}getOverlaysForCollection(e,t,r){let i=Fs(),s=t.length+1,o=new W(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return M.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new qe((l,u)=>l-u),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let f=s.get(u.largestBatchId);f===null&&(f=Fs(),s=s.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}let a=Fs(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,f)=>a.set(d,f)),!(a.size()>=i)););return M.resolve(a)}saveOverlay(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.overlayByBatchId.get(i.largestBatchId).delete(r.key);this.overlayByBatchId.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new mS(t,r));let s=this.overlayByBatchId.get(t);s===void 0&&(s=le(),this.overlayByBatchId.set(t,s)),this.overlayByBatchId.set(t,s.add(r.key))}};var PS=class{constructor(){this.sessionToken=At.EMPTY_BYTE_STRING}getSessionToken(e){return M.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,M.resolve()}};var su=class{constructor(){this.refsByKey=new dt(Ze.compareByKey),this.refsByTarget=new dt(Ze.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let r=new Ze(e,t);this.refsByKey=this.refsByKey.add(r),this.refsByTarget=this.refsByTarget.add(r)}addReferences(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.removeRef(new Ze(e,t))}removeReferences(e,t){e.forEach(r=>this.removeReference(r,t))}removeReferencesForId(e){let t=new W(new Be([])),r=new Ze(t,e),i=new Ze(t,e+1),s=[];return this.refsByTarget.forEachInRange([r,i],o=>{this.removeRef(o),s.push(o.key)}),s}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new W(new Be([])),r=new Ze(t,e),i=new Ze(t,e+1),s=le();return this.refsByTarget.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ze(e,0),r=this.refsByKey.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ze=class{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return W.comparator(e.key,t.key)||ue(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return ue(e.targetOrBatchId,t.targetOrBatchId)||W.comparator(e.key,t.key)}};var FS=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new dt(Ze.compareByKey)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new pS(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Ze(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,t){return M.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.indexOfBatchId(r),s=i<0?0:i;return M.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?wT:this.nextBatchId-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ze(t,0),i=new Ze(t,Number.POSITIVE_INFINITY),s=[];return this.batchesByDocumentKey.forEachInRange([r,i],o=>{let a=this.findMutationBatch(o.targetOrBatchId);s.push(a)}),M.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dt(ue);return t.forEach(i=>{let s=new Ze(i,0),o=new Ze(i,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([s,o],a=>{r=r.add(a.targetOrBatchId)})}),M.resolve(this.findMutationBatches(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;W.isDocumentKey(s)||(s=s.child(""));let o=new Ze(new W(s),0),a=new dt(ue);return this.batchesByDocumentKey.forEachWhile(c=>{let l=c.key.path;return r.isPrefixOf(l)?(l.length===i&&(a=a.add(c.targetOrBatchId)),!0):!1},o),M.resolve(this.findMutationBatches(a))}findMutationBatches(e){let t=[];return e.forEach(r=>{let i=this.findMutationBatch(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){let r=this.indexOfExistingBatchId(t.batchId,"removed");Te(r===0,55003),this.mutationQueue.shift();let i=this.batchesByDocumentKey;return M.forEach(t.mutations,s=>{let o=new Ze(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.batchesByDocumentKey=i})}removeCachedMutationKeys(e){}containsKey(e,t){let r=new Ze(t,0),i=this.batchesByDocumentKey.firstAfterOrEqual(r);return M.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){if(this.mutationQueue.length===0)return 0;let t=this.mutationQueue[0].batchId;return e-t}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var lQ="-9223372036854775808";function uQ(){return new qe(W.comparator)}var LS=class{constructor(e){this.sizer=e,this.docs=uQ(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.sizer(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return M.resolve(r?r.document.mutableCopy():Bn.newInvalidDocument(t))}getEntries(e,t){let r=$r();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Bn.newInvalidDocument(i))}),M.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=$r(),o=t.path,a=new W(o.child("__id"+lQ+"__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||iW(rW(u),r)<=0||!i.has(u.key)&&!ag(t,u)||(s=s.insert(u.key,u.mutableCopy()))}return M.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Y(9500)}forEachDocumentKey(e,t){return M.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new BS(this)}getSize(e){return M.resolve(this.size)}};function dQ(n){return new LS(n)}var BS=class extends MS{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.documentCache.addEntry(e,i)):this.documentCache.removeEntry(r)}),M.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}};var VS=class{constructor(e){this.persistence=e,this.targets=new Hr(t=>RT(t),xT),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new su,this.targetCount=0,this.targetIdGenerator=iu.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((r,i)=>t(i)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),M.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new iu(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,M.resolve()}updateTargetData(e,t){return this.saveTargetData(t),M.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.targets.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.targets.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),M.waitFor(s).next(()=>i)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,t){let r=this.targets.get(t)||null;return M.resolve(r)}addMatchingKeys(e,t,r){return this.references.addReferences(t,r),M.resolve()}removeMatchingKeys(e,t,r){this.references.removeReferences(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),M.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),M.resolve()}getMatchingKeysForTargetId(e,t){let r=this.references.referencesForId(t);return M.resolve(r)}containsKey(e,t){return M.resolve(this.references.containsKey(t))}};var fQ="MemoryPersistence",Vp=class{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new TT(0),this._started=!1,this._started=!0,this.globalsCache=new PS,this.referenceDelegate=e(this),this.targetCache=new VS(this);let r=i=>this.referenceDelegate.documentSize(i);this.indexManager=new DS,this.remoteDocumentCache=dQ(r),this.serializer=new TS(t),this.bundleCache=new OS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kS,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.mutationQueues[e.toKey()];return r||(r=new FS(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=r),r}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,r){V(fQ,"Starting transaction:",e);let i=new US(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),r(i).next(s=>this.referenceDelegate.onTransactionCommitted(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}mutationQueuesContainKey(e,t){return M.or(Object.values(this.mutationQueues).map(r=>()=>r.containsKey(e,t)))}},US=class extends Yb{constructor(e){super(),this.currentSequenceNumber=e}},jS=class n{constructor(e){this.persistence=e,this.localViewReferences=new su,this._orphanedDocuments=null}static factory(e){return new n(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw Y(60996)}addReference(e,t,r){return this.localViewReferences.addReference(r,t),this.orphanedDocuments.delete(r.toString()),M.resolve()}removeReference(e,t,r){return this.localViewReferences.removeReference(r,t),this.orphanedDocuments.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),M.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(s=>this.orphanedDocuments.add(s.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.orphanedDocuments.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.orphanedDocuments,i=>{let s=W.fromPath(i);return this.isReferenced(e,s).next(o=>{o||r.removeEntry(s,ne.min())})}).next(()=>(this._orphanedDocuments=null,r.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(r=>{r?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return M.or([()=>M.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}},Up=class n{constructor(e,t){this.persistence=e,this.orphanedSequenceNumbers=new Hr(r=>uW(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=cQ(this,t)}static factory(e,t){return new n(e,t)}onTransactionStarted(){}onTransactionCommitted(e){return M.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(s=>i+s))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,r=>{t++}).next(()=>t)}forEachOrphanedDocumentSequenceNumber(e,t){return M.forEach(this.orphanedSequenceNumbers,(r,i)=>this.isPinned(e,r,i).next(s=>s?M.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.forEachDocumentKey(e,a=>this.isPinned(e,a,t).next(c=>{c||(r++,s.removeEntry(a,ne.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),M.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.orphanedSequenceNumbers.set(r,e.currentSequenceNumber),M.resolve()}removeReference(e,t,r){return this.orphanedSequenceNumbers.set(r,e.currentSequenceNumber),M.resolve()}updateLimboDocument(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),M.resolve()}documentSize(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=sg(e.data.value)),t}isPinned(e,t,r){return M.or([()=>this.persistence.mutationQueuesContainKey(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.orphanedSequenceNumbers.get(t);return M.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var pme=1800*1e3;function hQ(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}var PT="LocalStore",pQ=300*1e6,qS=class{constructor(e,t,r,i){this.persistence=e,this.queryEngine=t,this.serializer=i,this.targetDataByTarget=new qe(ue),this.targetIdByTarget=new Hr(s=>RT(s),xT),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(r)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xS(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}};function gQ(n,e,t,r){return new qS(n,e,t,r)}async function zP(n,e){let t=X(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next(o=>(s=o,t.initializeUserComponents(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let a=[],c=[],l=le();for(let u of s){a.push(u.batchId);for(let d of u.mutations)l=l.add(d.key)}for(let u of o){c.push(u.batchId);for(let d of u.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(i,l).next(u=>({affectedDocuments:u,removedBatchIds:a,addedBatchIds:c}))})})}function mQ(n,e){let t=X(n),r=je.now(),i=e.reduce((a,c)=>a.add(c.key),le()),s,o;return t.persistence.runTransaction("Locally write mutations","readwrite",a=>{let c=$r(),l=le();return t.remoteDocuments.getEntries(a,i).next(u=>{c=u,c.forEach((d,f)=>{f.isValidDocument()||(l=l.add(d))})}).next(()=>t.localDocuments.getOverlayedDocuments(a,c)).next(u=>{s=u;let d=[];for(let f of e){let h=j7(f,s.get(f.key).overlayedDocument);h!=null&&d.push(new zr(f.key,h,fP(h.value.mapValue),Bs.exists(!0)))}return t.mutationQueue.addMutationBatch(a,r,d,e)}).next(u=>{o=u;let d=u.applyToLocalDocumentSet(s,l);return t.documentOverlayCache.saveOverlays(a,u.batchId,d)})}).then(()=>({batchId:o.batchId,changes:SP(s)}))}function yQ(n,e){let t=X(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return IQ(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,vQ(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function vQ(n){let e=le();for(let t=0;t<n.mutationResults.length;++t)n.mutationResults[t].transformResults.length>0&&(e=e.add(n.batch.mutations[t].key));return e}function EQ(n,e){let t=X(n);return t.persistence.runTransaction("Reject batch","readwrite-primary",r=>{let i;return t.mutationQueue.lookupMutationBatch(r,e).next(s=>(Te(s!==null,37113),i=s.keys(),t.mutationQueue.removeMutationBatch(r,s))).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,i)).next(()=>t.localDocuments.getDocuments(r,i))})}function GP(n){let e=X(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.targetCache.getLastRemoteSnapshotVersion(t))}function _Q(n,e){let t=X(n),r=e.snapshotVersion,i=t.targetDataByTarget;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=t.targetDataByTarget;let a=[];e.targetChanges.forEach((u,d)=>{let f=i.get(d);if(!f)return;a.push(t.targetCache.removeMatchingKeys(s,u.removedDocuments,d).next(()=>t.targetCache.addMatchingKeys(s,u.addedDocuments,d)));let h=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?h=h.withResumeToken(At.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):u.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(u.resumeToken,r)),i=i.insert(d,h),bQ(f,h,u)&&a.push(t.targetCache.updateTargetData(s,h))});let c=$r(),l=le();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(CQ(s,o,e.documentUpdates).next(u=>{c=u.changedDocuments,l=u.existenceChangedKeys})),!r.isEqual(ne.min())){let u=t.targetCache.getLastRemoteSnapshotVersion(s).next(d=>t.targetCache.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return M.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.targetDataByTarget=i,s))}function CQ(n,e,t){let r=le(),i=le();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=$r();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(ne.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):V(PT,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{changedDocuments:o,existenceChangedKeys:i}})}function bQ(n,e,t){return n.resumeToken.approximateByteSize()===0||e.snapshotVersion.toMicroseconds()-n.snapshotVersion.toMicroseconds()>=pQ?!0:t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size>0}async function SQ(n,e){let t=X(n);try{await t.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>M.forEach(e,i=>M.forEach(i.addedKeys,s=>t.persistence.referenceDelegate.addReference(r,i.targetId,s)).next(()=>M.forEach(i.removedKeys,s=>t.persistence.referenceDelegate.removeReference(r,i.targetId,s)))))}catch(r){if(Za(r))V(PT,"Failed to update sequence numbers: "+r);else throw r}for(let r of e){let i=r.targetId;if(!r.fromCache){let s=t.targetDataByTarget.get(i),o=s.snapshotVersion,a=s.withLastLimboFreeSnapshotVersion(o);t.targetDataByTarget=t.targetDataByTarget.insert(i,a)}}}function TQ(n,e){let t=X(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=wT),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function DQ(n,e){let t=X(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.targetCache.getTargetData(r,e).next(s=>s?(i=s,M.resolve(i)):t.targetCache.allocateTargetId(r).next(o=>(i=new ru(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.targetCache.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.targetDataByTarget.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.targetDataByTarget=t.targetDataByTarget.insert(r.targetId,r),t.targetIdByTarget.set(e,r.targetId)),r})}function wQ(n,e,t){let r=X(n),i=r.targetIdByTarget.get(t);return i!==void 0?M.resolve(r.targetDataByTarget.get(i)):r.targetCache.getTargetData(e,t)}async function HS(n,e,t){let r=X(n),i=r.targetDataByTarget.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(Za(o))V(PT,`Failed to update sequence numbers for target ${e}: ${o}`);else throw o}r.targetDataByTarget=r.targetDataByTarget.remove(e),r.targetIdByTarget.delete(i.target)}function WP(n,e,t){let r=X(n),i=ne.min(),s=le();return r.persistence.runTransaction("Execute query","readwrite",o=>wQ(r,o,Fn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.targetCache.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.queryEngine.getDocumentsMatchingQuery(o,e,t?i:ne.min(),t?s:le())).next(a=>(AQ(r,T7(e),a),{documents:a,remoteKeys:s})))}function IQ(n,e,t,r){let i=t.batch,s=i.keys(),o=M.resolve();return s.forEach(a=>{o=o.next(()=>r.getEntry(e,a)).next(c=>{let l=t.docVersions.get(a);Te(l!==null,48541),c.version.compareTo(l)<0&&(i.applyToRemoteDocument(c,t),c.isValidDocument()&&(c.setReadTime(t.commitVersion),r.addEntry(c)))})}),o.next(()=>n.mutationQueue.removeMutationBatch(e,i))}function AQ(n,e,t){let r=n.collectionGroupReadTime.get(e)||ne.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.collectionGroupReadTime.set(e,r)}var $S=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var NQ=100;function MQ(){return gM()?8:oW(pM())>0?6:4}var zS=class{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=NQ,this.relativeIndexReadCostPerDocument=MQ()}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.performQueryUsingIndex(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.performQueryUsingRemoteKeys(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new $S;return this.executeFullCollectionScan(e,t,o).next(a=>{if(s.result=a,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,o,a.size)})}).next(()=>s.result)}createCacheIndexes(e,t,r,i){return r.documentReadCount<this.indexAutoCreationMinCollectionSize?(Da()<=pe.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",wa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),M.resolve()):(Da()<=pe.DEBUG&&V("QueryEngine","Query:",wa(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.relativeIndexReadCostPerDocument*i?(Da()<=pe.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",wa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fn(t))):M.resolve())}performQueryUsingIndex(e,t){if(vk(t))return M.resolve(null);let r=Fn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=dS(t,null,"F"),r=Fn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=le(...s);return this.localDocumentsView.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.applyQuery(t,a);return this.needsRefill(t,l,o,c.readTime)?this.performQueryUsingIndex(e,dS(t,null,"F")):this.appendRemainingResults(e,l,t,c)}))})))}performQueryUsingRemoteKeys(e,t,r,i){return vk(t)||i.isEqual(ne.min())?M.resolve(null):this.localDocumentsView.getDocuments(e,r).next(s=>{let o=this.applyQuery(t,s);return this.needsRefill(t,o,r,i)?M.resolve(null):(Da()<=pe.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wa(t)),this.appendRemainingResults(e,o,t,nW(i,Ql)).next(a=>a))})}applyQuery(e,t){let r=new dt(CP(e));return t.forEach((i,s)=>{ag(e,s)&&(r=r.add(s))}),r}needsRefill(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return s?s.hasPendingWrites||s.version.compareTo(i)>0:!1}executeFullCollectionScan(e,t,r){return Da()<=pe.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",wa(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,qs.min(),r)}appendRemainingResults(e,t,r,i){return this.localDocumentsView.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var jp=class{constructor(){this.activeTargetIds=x7()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var GS=class{constructor(){this.localState=new jp,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,r){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new jp,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var WS=class{addCallback(e){}shutdown(){}};var KS=class{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onConnected(e){this.wrappedOnConnected=e}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}};var Cp=null;function RQ(){return 268435456+Math.round(2147483648*Math.random())}function jb(){return Cp===null?Cp=RQ():Cp++,"0x"+Cp.toString(16)}function xQ(n){return new Promise((e,t)=>{n((r,i)=>{r?t(r):e(i)})})}var OQ="1.9.15",Lt="GrpcConnection",kQ=`gl-node/${process.versions.node} fire/${Qa} grpc/${OQ}`;function qb(n,e,t,r){Te(e===null||e.type==="OAuth",36936);let i=new Vs.Metadata;return e&&e.headers.forEach((s,o)=>i.set(o,s)),t&&t.headers.forEach((s,o)=>i.set(o,s)),r&&i.set("X-Firebase-GMPID",r),i.set("X-Goog-Api-Client",kQ),i.set("Google-Cloud-Resource-Prefix",n),i.set("x-goog-request-params",n),i}var QS=class{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){V(Lt,"Creating Firestore stub.");let e=this.databaseInfo.ssl?Vs.credentials.createSsl():Vs.credentials.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,r,i,s){let o=jb(),a=this.ensureActiveStub(),c=qb(this.databasePath,i,s,this.databaseInfo.appId),l=K({database:this.databasePath},r);return xQ(u=>(V(Lt,`RPC '${e}' ${o} invoked with request:`,r),a[e](l,c,(d,f)=>{d?(V(Lt,`RPC '${e}' ${o} failed with error:`,d),u(new U(Tp(d.code),d.message))):(V(Lt,`RPC '${e}' ${o} completed with response:`,f),u(void 0,f))})))}invokeStreamingRPC(e,t,r,i,s,o){let a=jb(),c=[],l=new kn;V(Lt,`RPC '${e}' ${a} invoked (streaming) with request:`,r);let u=this.ensureActiveStub(),d=qb(this.databasePath,i,s,this.databaseInfo.appId),f=Ce(K({},r),{database:this.databasePath}),h=u[e](f,d),_=!1;return h.on("data",b=>{V(Lt,`RPC ${e} ${a} received result:`,b),c.push(b),o!==void 0&&c.length===o&&(_=!0,l.resolve(c))}),h.on("end",()=>{V(Lt,`RPC '${e}' ${a} completed.`),_||(_=!0,l.resolve(c))}),h.on("error",b=>{V(Lt,`RPC '${e}' ${a} failed with error:`,b);let T=Tp(b.code);l.reject(new U(T,b.message))}),l.promise}openStream(e,t,r){let i=jb(),s=this.ensureActiveStub(),o=qb(this.databasePath,t,r,this.databaseInfo.appId),a=s[e](o),c=!1,l=f=>{c||(c=!0,u.callOnClose(f),a.end())},u=new KS({sendFn:f=>{if(c)V(Lt,`RPC '${e}' stream ${i} not sending because gRPC stream is closed:`,f);else{V(Lt,`RPC '${e}' stream ${i} sending:`,f);try{a.write(f)}catch(h){throw Ln("Failure sending:",f),Ln("Error:",h),h}}},closeFn:()=>{V(Lt,`RPC '${e}' stream ${i} closed locally via close().`),l()}}),d=!1;return a.on("data",f=>{c||(V(Lt,`RPC '${e}' stream ${i} received:`,f),d||(u.callOnConnected(),d=!0),u.callOnMessage(f))}),a.on("end",()=>{V(Lt,`RPC '${e}' stream ${i} ended.`),l()}),a.on("error",f=>{if(!c){Ma(Lt,`RPC '${e}' stream ${i} error. Code:`,f.code,"Message:",f.message);let h=Tp(f.code);l(new U(h,f.message))}}),V(Lt,`Opening RPC '${e}' stream ${i} to ${this.databaseInfo.host}`),setTimeout(()=>{u.callOnOpen()},0),u}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}},KP={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}},PQ={nested:KP},FQ=Object.freeze({__proto__:null,nested:KP,default:PQ});var LQ={longs:String,enums:String,defaults:!0,oneofs:!1};function BQ(){let n=Uk.fromJSON(FQ,LQ);return Vs.loadPackageDefinition(n)}function VQ(n){let e=BQ();return new QS(e,n)}function UQ(){return new WS}function ug(n){return new Lp(n,!1)}var jQ="ExponentialBackoff",qQ=1e3,HQ=1.5,$Q=60*1e3,qp=class{constructor(e,t,r=qQ,i=HQ,s=$Q){this.queue=e,this.timerId=t,this.initialDelayMs=r,this.backoffFactor=i,this.maxDelayMs=s,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,t-r);i>0&&V(jQ,`Backing off for ${i} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){this.timerPromise!==null&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){this.timerPromise!==null&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}};var Nk="PersistentStream",zQ=60*1e3,GQ=10*1e3,Hp=class{constructor(e,t,r,i,s,o,a,c){this.queue=e,this.idleTimerId=r,this.healthTimerId=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new qp(e,t)}isStarted(){return this.state===1||this.state===5||this.isOpen()}isOpen(){return this.state===2||this.state===3}start(){if(this.responseCount=0,this.state===4){this.performBackoff();return}this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&this.idleTimer===null&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,zQ,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(e,t){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,e!==4?this.backoff.reset():t&&t.code===x.RESOURCE_EXHAUSTED?(Ln(t.toString()),Ln("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===x.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,await this.listener.onClose(t)}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.closeCount===t&&this.startStream(r,i)},r=>{e(()=>{let i=new U(x.UNKNOWN,"Fetching auth token failed: "+r.message);return this.handleStreamClose(i)})})}startStream(e,t){let r=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onConnected(()=>{r(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{r(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,GQ,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(i=>{r(()=>this.handleStreamClose(i))}),this.stream.onMessage(i=>{r(()=>++this.responseCount===1?this.onFirst(i):this.onNext(i))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(e){return V(Nk,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(V(Nk,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},YS=class extends Hp{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}startRpc(e,t){return this.connection.openStream("Listen",e,t)}onFirst(e){return this.onNext(e)}onNext(e){this.backoff.reset();let t=lK(this.serializer,e),r=dK(e);return this.listener.onWatchChange(t,r)}watch(e){let t={};t.database=SS(this.serializer),t.addTarget=CK(this.serializer,e);let r=EK(this.serializer,e);r&&(t.labels=r),this.sendRequest(t)}unwatch(e){let t={};t.database=SS(this.serializer),t.removeTarget=e,this.sendRequest(t)}},ZS=class extends Hp{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(e,t){return this.connection.openStream("Write",e,t)}onFirst(e){return Te(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0,55816),this.listener.onHandshakeComplete()}onNext(e){Te(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.backoff.reset();let t=gK(e.writeResults,e.commitTime),r=fr(e.commitTime);return this.listener.onMutationResult(r,t)}writeHandshake(){let e={};e.database=SS(this.serializer),this.sendRequest(e)}writeMutations(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>fK(this.serializer,r))};this.sendRequest(t)}};var JS=class{},XS=class extends JS{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new U(x.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,t,r,i){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.invokeRPC(e,bS(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new U(x.UNKNOWN,s.toString())})}invokeStreamingRPC(e,t,r,i,s){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.invokeStreamingRPC(e,bS(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new U(x.UNKNOWN,o.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}};function WQ(n,e,t,r){return new XS(n,e,t,r)}function KQ(n,e,t){let r=X(n);return r.verifyInitialized(),new ZS(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,t)}function QQ(n,e,t){let r=X(n);return r.verifyInitialized(),new YS(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,t)}var YQ="OnlineStateTracker",Mk=1,Rk=10*1e3,eT=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){this.watchStreamFailures===0&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",Rk,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${Rk/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){this.state==="Online"?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=Mk&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${Mk} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e==="Online"&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(Ln(t),this.shouldWarnClientIsOffline=!1):V(YQ,t)}clearOnlineStateTimer(){this.onlineStateTimer!==null&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}};var Gs="RemoteStore",ZQ=10,tT=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=s,this.connectivityMonitor.addCallback(o=>{r.enqueueAndForget(async()=>{Ks(this)&&(V(Gs,"Restarting streams for network reachability change."),await hY(this))})}),this.onlineStateTracker=new eT(r,i)}};function JQ(n,e,t,r,i){return new tT(n,e,t,r,i)}async function dg(n){if(Ks(n))for(let e of n.onNetworkStatusChange)await e(!0)}async function lu(n){for(let e of n.onNetworkStatusChange)await e(!1)}async function XQ(n){let e=X(n);V(Gs,"RemoteStore shutting down."),e.offlineCauses.add(5),await lu(e),e.connectivityMonitor.shutdown(),e.onlineStateTracker.set("Unknown")}function QP(n,e){let t=X(n);t.listenTargets.has(e.targetId)||(t.listenTargets.set(e.targetId,e),VT(t)?BT(t):Ja(t).isOpen()&&LT(t,e))}function FT(n,e){let t=X(n),r=Ja(t);t.listenTargets.delete(e),r.isOpen()&&YP(t,e),t.listenTargets.size===0&&(r.isOpen()?r.markIdle():Ks(t)&&t.onlineStateTracker.set("Unknown"))}function LT(n,e){if(n.watchChangeAggregator.recordPendingTargetRequest(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ja(n).watch(e)}function YP(n,e){n.watchChangeAggregator.recordPendingTargetRequest(e),Ja(n).unwatch(e)}function BT(n){n.watchChangeAggregator=new _S({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),getTargetDataForTarget:e=>n.listenTargets.get(e)||null,getDatabaseId:()=>n.datastore.serializer.databaseId}),Ja(n).start(),n.onlineStateTracker.handleWatchStreamStart()}function VT(n){return Ks(n)&&!Ja(n).isStarted()&&n.listenTargets.size>0}function Ks(n){return X(n).offlineCauses.size===0}function ZP(n){n.watchChangeAggregator=void 0}async function eY(n){n.onlineStateTracker.set("Online")}async function tY(n){n.listenTargets.forEach((e,t)=>{LT(n,e)})}async function nY(n,e){ZP(n),VT(n)?(n.onlineStateTracker.handleWatchStreamFailure(e),BT(n)):n.onlineStateTracker.set("Unknown")}async function rY(n,e,t){if(n.onlineStateTracker.set("Online"),e instanceof Pp&&e.state===2&&e.cause){try{await sY(n,e)}catch(r){V(Gs,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await $p(n,r)}return}if(e instanceof Ra?n.watchChangeAggregator.handleDocumentChange(e):e instanceof kp?n.watchChangeAggregator.handleExistenceFilter(e):n.watchChangeAggregator.handleTargetChange(e),!t.isEqual(ne.min()))try{let r=await GP(n.localStore);t.compareTo(r)>=0&&await iY(n,t)}catch(r){V(Gs,"Failed to raise snapshot:",r),await $p(n,r)}}async function $p(n,e,t){if(Za(e))n.offlineCauses.add(1),await lu(n),n.onlineStateTracker.set("Offline"),t||(t=()=>GP(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{V(Gs,"Retrying IndexedDB access"),await t(),n.offlineCauses.delete(1),await dg(n)});else throw e}function JP(n,e){return e().catch(t=>$p(n,t,e))}function iY(n,e){let t=n.watchChangeAggregator.createRemoteEvent(e);return t.targetChanges.forEach((r,i)=>{if(r.resumeToken.approximateByteSize()>0){let s=n.listenTargets.get(i);s&&n.listenTargets.set(i,s.withResumeToken(r.resumeToken,e))}}),t.targetMismatches.forEach((r,i)=>{let s=n.listenTargets.get(r);if(!s)return;n.listenTargets.set(r,s.withResumeToken(At.EMPTY_BYTE_STRING,s.snapshotVersion)),YP(n,r);let o=new ru(s.target,r,i,s.sequenceNumber);LT(n,o)}),n.remoteSyncer.applyRemoteEvent(t)}async function sY(n,e){let t=e.cause;for(let r of e.targetIds)n.listenTargets.has(r)&&(await n.remoteSyncer.rejectListen(r,t),n.listenTargets.delete(r),n.watchChangeAggregator.removeTarget(r))}async function fg(n){let e=X(n),t=Vi(e),r=e.writePipeline.length>0?e.writePipeline[e.writePipeline.length-1].batchId:wT;for(;oY(e);)try{let i=await TQ(e.localStore,r);if(i===null){e.writePipeline.length===0&&t.markIdle();break}else r=i.batchId,aY(e,i)}catch(i){await $p(e,i)}XP(e)&&eF(e)}function oY(n){return Ks(n)&&n.writePipeline.length<ZQ}function aY(n,e){n.writePipeline.push(e);let t=Vi(n);t.isOpen()&&t.handshakeComplete&&t.writeMutations(e.mutations)}function XP(n){return Ks(n)&&!Vi(n).isStarted()&&n.writePipeline.length>0}function eF(n){Vi(n).start()}async function cY(n){Vi(n).writeHandshake()}async function lY(n){let e=Vi(n);for(let t of n.writePipeline)e.writeMutations(t.mutations)}async function uY(n,e,t){let r=n.writePipeline.shift(),i=gS.from(r,e,t);await JP(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await fg(n)}async function dY(n,e){e&&Vi(n).handshakeComplete&&await fY(n,e),XP(n)&&eF(n)}async function fY(n,e){if(Q7(e.code)){let t=n.writePipeline.shift();Vi(n).inhibitBackoff(),await JP(n,()=>n.remoteSyncer.rejectFailedWrite(t.batchId,e)),await fg(n)}}async function hY(n){let e=X(n);e.offlineCauses.add(4),await lu(e),e.onlineStateTracker.set("Unknown"),e.offlineCauses.delete(4),await dg(e)}async function xk(n,e){let t=X(n);t.asyncQueue.verifyOperationInProgress(),V(Gs,"RemoteStore received new credentials");let r=Ks(t);t.offlineCauses.add(3),await lu(t),r&&t.onlineStateTracker.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.offlineCauses.delete(3),await dg(t)}async function pY(n,e){let t=X(n);e?(t.offlineCauses.delete(2),await dg(t)):e||(t.offlineCauses.add(2),await lu(t),t.onlineStateTracker.set("Unknown"))}function Ja(n){return n.watchStream||(n.watchStream=QQ(n.datastore,n.asyncQueue,{onConnected:eY.bind(null,n),onOpen:tY.bind(null,n),onClose:nY.bind(null,n),onWatchChange:rY.bind(null,n)}),n.onNetworkStatusChange.push(async e=>{e?(n.watchStream.inhibitBackoff(),VT(n)?BT(n):n.onlineStateTracker.set("Unknown")):(await n.watchStream.stop(),ZP(n))})),n.watchStream}function Vi(n){return n.writeStream||(n.writeStream=KQ(n.datastore,n.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:cY.bind(null,n),onClose:dY.bind(null,n),onHandshakeComplete:lY.bind(null,n),onMutationResult:uY.bind(null,n)}),n.onNetworkStatusChange.push(async e=>{e?(n.writeStream.inhibitBackoff(),await fg(n)):(await n.writeStream.stop(),n.writePipeline.length>0&&(V(Gs,`Stopping write stream with ${n.writePipeline.length} pending writes`),n.writePipeline=[]))})),n.writeStream}var gY="AsyncQueue",nT=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new kn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(x.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function UT(n,e){if(Ln(gY,`${e}: ${n}`),Za(n))return new U(x.UNAVAILABLE,`${e}: ${n}`);throw n}var zp=class n{static emptySet(e){return new n(e.comparator)}constructor(e){e?this.comparator=(t,r)=>e(t,r)||W.comparator(t.key,r.key):this.comparator=(t,r)=>W.comparator(t.key,r.key),this.keyedMap=zl(),this.sortedSet=new qe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Gp=class{constructor(){this.changeMap=new qe(W.comparator)}track(e){let t=e.doc.key,r=this.changeMap.get(t);if(!r){this.changeMap=this.changeMap.insert(t,e);return}e.type!==0&&r.type===3?this.changeMap=this.changeMap.insert(t,e):e.type===3&&r.type!==1?this.changeMap=this.changeMap.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.changeMap=this.changeMap.remove(t):e.type===1&&r.type===2?this.changeMap=this.changeMap.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):Y(63341,{change:e,oldChange:r})}getChanges(){let e=[];return this.changeMap.inorderTraversal((t,r)=>{e.push(r)}),e}},Ha=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,zp.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!og(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var rT=class{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(e=>e.listensToRemoteStore())}};function mY(){return new iT}var iT=class{constructor(){this.queries=tF(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){bY(this,new U(x.ABORTED,"Firestore shutting down"))}};function tF(){return new Hr(n=>_P(n),og)}async function yY(n,e){let t=X(n),r=3,i=e.query,s=t.queries.get(i);s?!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(r=2):(s=new rT,r=e.listensToRemoteStore()?0:1);try{switch(r){case 0:s.viewSnap=await t.onListen(i,!0);break;case 1:s.viewSnap=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i);break;default:break}}catch(o){let a=UT(o,`Initialization of query '${wa(e.query)}' failed`);e.onError(a);return}t.queries.set(i,s),s.listeners.push(e),e.applyOnlineStateChange(t.onlineState),s.viewSnap&&e.onViewSnapshot(s.viewSnap)&&jT(t)}async function vY(n,e){let t=X(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),s.listeners.length===0?i=e.listensToRemoteStore()?0:1:!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function EY(n,e){let t=X(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.listeners)a.onViewSnapshot(i)&&(r=!0);o.viewSnap=i}}r&&jT(t)}function _Y(n,e,t){let r=X(n),i=r.queries.get(e);if(i)for(let s of i.listeners)s.onError(t);r.queries.delete(e)}function CY(n,e){let t=X(n);t.onlineState=e;let r=!1;t.queries.forEach((i,s)=>{for(let o of s.listeners)o.applyOnlineStateChange(e)&&(r=!0)}),r&&jT(t)}function bY(n,e){let t=X(n),r=t.queries;t.queries=tF(),r.forEach((i,s)=>{for(let o of s.listeners)o.onError(e)})}function jT(n){n.snapshotsInSyncListeners.forEach(e=>{e.next()})}var nF=(function(n){return n.Default="default",n.Cache="cache",n})(nF||{}),sT=class{constructor(e,t,r){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=r||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ha(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),t=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),t=!0),this.snap=e,t}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t}shouldRaiseInitialEvent(e,t){if(!e.fromCache||!this.listensToRemoteStore())return!0;let r=t!=="Offline";return this.options.waitForSyncWhenOnline&&r?!1:!e.docs.isEmpty()||e.hasCachedResults||t==="Offline"}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return e.syncStateChanged||t?this.options.includeMetadataChanges===!0:!1}raiseInitialEvent(e){e=Ha.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}listensToRemoteStore(){return this.options.source!==nF.Cache}};var oT=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.addedKeys=r,this.removedKeys=i}static fromSnapshot(e,t){let r=le(),i=le();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key);break}return new n(e,t.fromCache,r,i)}};var Wp=class{constructor(e){this.key=e}},Kp=class{constructor(e){this.key=e}},aT=class{constructor(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=le(),this.mutatedKeys=le(),this.docComparator=CP(e),this.documentSet=new zp(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,t){let r=t?t.changeSet:new Gp,i=t?t.documentSet:this.documentSet,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,d)=>{let f=i.get(u),h=ag(this.query,d)?d:null,_=f?this.mutatedKeys.has(f.key):!1,b=h?h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations:!1,T=!1;f&&h?f.data.isEqual(h.data)?_!==b&&(r.track({type:3,doc:h}),T=!0):this.shouldWaitForSyncedDocument(f,h)||(r.track({type:2,doc:h}),T=!0,(c&&this.docComparator(h,c)>0||l&&this.docComparator(h,l)<0)&&(a=!0)):!f&&h?(r.track({type:0,doc:h}),T=!0):f&&!h&&(r.track({type:1,doc:f}),T=!0,(c||l)&&(a=!0)),T&&(h?(o=o.add(h),b?s=s.add(u):s=s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{documentSet:o,changeSet:r,needsRefill:a,mutatedKeys:s}}shouldWaitForSyncedDocument(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let o=e.changeSet.getChanges();o.sort((d,f)=>SY(d.type,f.type)||this.docComparator(d.doc,f.doc)),this.applyTargetChange(r),i=i??!1;let a=t&&!i?this.updateLimboDocuments():[],l=this.limboDocuments.size===0&&this.current&&!i?1:0,u=l!==this.syncState;return this.syncState=l,o.length===0&&!u?{limboChanges:a}:{snapshot:new Ha(this.query,e.documentSet,s,o,e.mutatedKeys,l===0,u,!1,r?r.resumeToken.approximateByteSize()>0:!1),limboChanges:a}}applyOnlineStateChange(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Gp,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!(this._syncedDocuments.has(e)||!this.documentSet.has(e)||this.documentSet.get(e).hasLocalMutations)}applyTargetChange(e){e&&(e.addedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.delete(t)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=le(),this.documentSet.forEach(r=>{this.shouldBeInLimbo(r.key)&&(this.limboDocuments=this.limboDocuments.add(r.key))});let t=[];return e.forEach(r=>{this.limboDocuments.has(r)||t.push(new Kp(r))}),this.limboDocuments.forEach(r=>{e.has(r)||t.push(new Wp(r))}),t}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=le();let t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)}computeInitialSnapshot(){return Ha.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===0,this.hasCachedResults)}};function SY(n,e){let t=r=>{switch(r){case 0:return 1;case 2:return 2;case 3:return 2;case 1:return 0;default:return Y(20277,{change:r})}};return t(n)-t(e)}var qT="SyncEngine",cT=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},lT=class{constructor(e){this.key=e,this.receivedDocument=!1}},uT=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.syncEngineListener={},this.queryViewsByQuery=new Hr(a=>_P(a),og),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new qe(W.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new su,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=iu.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return this._isPrimaryClient===!0}};function TY(n,e,t,r,i,s,o){let a=new uT(n,e,t,r,i,s);return o&&(a._isPrimaryClient=!0),a}async function DY(n,e,t=!0){let r=lF(n),i,s=r.queryViewsByQuery.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.computeInitialSnapshot()):i=await rF(r,e,t,!0),i}async function wY(n,e){let t=lF(n);await rF(t,e,!0,!1)}async function rF(n,e,t,r){let i=await DQ(n.localStore,Fn(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=await IY(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&QP(n.remoteStore,i),a}async function IY(n,e,t,r,i){n.applyDocChanges=(d,f,h)=>LY(n,d,f,h);let s=await WP(n.localStore,e,!0),o=new aT(e,s.remoteKeys),a=o.computeDocChanges(s.documents),c=tu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);cF(n,t,l.limboChanges);let u=new cT(e,t,o);return n.queryViewsByQuery.set(e,u),n.queriesByTarget.has(t)?n.queriesByTarget.get(t).push(e):n.queriesByTarget.set(t,[e]),l.snapshot}async function AY(n,e,t){let r=X(n),i=r.queryViewsByQuery.get(e),s=r.queriesByTarget.get(i.targetId);if(s.length>1){r.queriesByTarget.set(i.targetId,s.filter(o=>!og(o,e))),r.queryViewsByQuery.delete(e);return}r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await HS(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&FT(r.remoteStore,i.targetId),dT(r,i.targetId)}).catch(Ya)):(dT(r,i.targetId),await HS(r.localStore,i.targetId,!0))}async function NY(n,e){let t=X(n),r=t.queryViewsByQuery.get(e),i=t.queriesByTarget.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),FT(t.remoteStore,r.targetId))}async function MY(n,e,t){let r=UY(n);try{let i=await mQ(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),PY(r,i.batchId,t),await uu(r,i.changes),await fg(r.remoteStore)}catch(i){let s=UT(i,"Failed to persist write");t.reject(s)}}async function iF(n,e){let t=X(n);try{let r=await _Q(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.activeLimboResolutionsByTarget.get(s);o&&(Te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.receivedDocument=!0:i.modifiedDocuments.size>0?Te(o.receivedDocument,14607):i.removedDocuments.size>0&&(Te(o.receivedDocument,42227),o.receivedDocument=!1))}),await uu(t,r,e)}catch(r){await Ya(r)}}function Ok(n,e,t){let r=X(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.queryViewsByQuery.forEach((s,o)=>{let a=o.view.applyOnlineStateChange(e);a.snapshot&&i.push(a.snapshot)}),CY(r.eventManager,e),i.length&&r.syncEngineListener.onWatchChange(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function RY(n,e,t){let r=X(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.activeLimboResolutionsByTarget.get(e),s=i&&i.key;if(s){let o=new qe(W.comparator);o=o.insert(s,Bn.newNoDocument(s,ne.min()));let a=le().add(s),c=new Op(ne.min(),new Map,new qe(ue),o,a);await iF(r,c),r.activeLimboTargetsByKey=r.activeLimboTargetsByKey.remove(s),r.activeLimboResolutionsByTarget.delete(e),HT(r)}else await HS(r.localStore,e,!1).then(()=>dT(r,e,t)).catch(Ya)}async function xY(n,e){let t=X(n),r=e.batch.batchId;try{let i=await yQ(t.localStore,e);oF(t,r,null),sF(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await uu(t,i)}catch(i){await Ya(i)}}async function OY(n,e,t){let r=X(n);try{let i=await EQ(r.localStore,e);oF(r,e,t),sF(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await uu(r,i)}catch(i){await Ya(i)}}function sF(n,e){(n.pendingWritesCallbacks.get(e)||[]).forEach(t=>{t.resolve()}),n.pendingWritesCallbacks.delete(e)}function kY(n,e){n.pendingWritesCallbacks.forEach(t=>{t.forEach(r=>{r.reject(new U(x.CANCELLED,e))})}),n.pendingWritesCallbacks.clear()}function PY(n,e,t){let r=n.mutationUserCallbacks[n.currentUser.toKey()];r||(r=new qe(ue)),r=r.insert(e,t),n.mutationUserCallbacks[n.currentUser.toKey()]=r}function oF(n,e,t){let r=X(n),i=r.mutationUserCallbacks[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.mutationUserCallbacks[r.currentUser.toKey()]=i}}function dT(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.queriesByTarget.get(e))n.queryViewsByQuery.delete(r),t&&n.syncEngineListener.onWatchError(r,t);n.queriesByTarget.delete(e),n.isPrimaryClient&&n.limboDocumentRefs.removeReferencesForId(e).forEach(i=>{n.limboDocumentRefs.containsKey(i)||aF(n,i)})}function aF(n,e){n.enqueuedLimboResolutions.delete(e.path.canonicalString());let t=n.activeLimboTargetsByKey.get(e);t!==null&&(FT(n.remoteStore,t),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.remove(e),n.activeLimboResolutionsByTarget.delete(t),HT(n))}function cF(n,e,t){for(let r of t)r instanceof Wp?(n.limboDocumentRefs.addReference(r.key,e),FY(n,r)):r instanceof Kp?(V(qT,"Document no longer in limbo: "+r.key),n.limboDocumentRefs.removeReference(r.key,e),n.limboDocumentRefs.containsKey(r.key)||aF(n,r.key)):Y(19791,{limboChange:r})}function FY(n,e){let t=e.key,r=t.path.canonicalString();!n.activeLimboTargetsByKey.get(t)&&!n.enqueuedLimboResolutions.has(r)&&(V(qT,"New document in limbo: "+t),n.enqueuedLimboResolutions.add(r),HT(n))}function HT(n){for(;n.enqueuedLimboResolutions.size>0&&n.activeLimboTargetsByKey.size<n.maxConcurrentLimboResolutions;){let e=n.enqueuedLimboResolutions.values().next().value;n.enqueuedLimboResolutions.delete(e);let t=new W(Be.fromString(e)),r=n.limboTargetIdGenerator.next();n.activeLimboResolutionsByTarget.set(r,new lT(t)),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.insert(t,r),QP(n.remoteStore,new ru(Fn(EP(t.path)),r,"TargetPurposeLimboResolution",TT.INVALID))}}async function uu(n,e,t){let r=X(n),i=[],s=[],o=[];r.queryViewsByQuery.isEmpty()||(r.queryViewsByQuery.forEach((a,c)=>{o.push(r.applyDocChanges(c,e,t).then(l=>{if((l||t)&&r.isPrimaryClient){let u=l?!l.fromCache:t?.targetChanges.get(c.targetId)?.current;r.sharedClientState.updateQueryState(c.targetId,u?"current":"not-current")}if(l){i.push(l);let u=oT.fromSnapshot(c.targetId,l);s.push(u)}}))}),await Promise.all(o),r.syncEngineListener.onWatchChange(i),await SQ(r.localStore,s))}async function LY(n,e,t,r){let i=e.view.computeDocChanges(t);i.needsRefill&&(i=await WP(n.localStore,e.query,!1).then(({documents:c})=>e.view.computeDocChanges(c,i)));let s=r&&r.targetChanges.get(e.targetId),o=r&&r.targetMismatches.get(e.targetId)!=null,a=e.view.applyChanges(i,n.isPrimaryClient,s,o);return cF(n,e.targetId,a.limboChanges),a.snapshot}async function BY(n,e){let t=X(n);if(!t.currentUser.isEqual(e)){V(qT,"User change. New user:",e.toKey());let i=await zP(t.localStore,e);t.currentUser=e,kY(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await uu(t,i.affectedDocuments)}}function VY(n,e){let t=X(n),r=t.activeLimboResolutionsByTarget.get(e);if(r&&r.receivedDocument)return le().add(r.key);{let i=le(),s=t.queriesByTarget.get(e);if(!s)return i;for(let o of s){let a=t.queryViewsByQuery.get(o);i=i.unionWith(a.view.syncedDocuments)}return i}}function lF(n){let e=X(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=iF.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VY.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RY.bind(null,e),e.syncEngineListener.onWatchChange=EY.bind(null,e.eventManager),e.syncEngineListener.onWatchError=_Y.bind(null,e.eventManager),e}function UY(n){let e=X(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xY.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=OY.bind(null,e),e}var uF=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=ug(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,r){return null}createIndexBackfillerScheduler(t,r){return null}createLocalStore(t){return gQ(this.persistence,new zS,t.initialUser,this.serializer)}createPersistence(t){return new Vp(jS.factory,this.serializer)}createSharedClientState(t){return new GS}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),fT=class extends uF{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){Te(this.persistence.referenceDelegate instanceof Up,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new AS(r,e.asyncQueue,t)}createPersistence(e){let t=this.cacheSizeBytes!==void 0?En.withCacheSize(this.cacheSizeBytes):En.DEFAULT;return new Vp(r=>Up.factory(r,t),this.serializer)}};var jY=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Ok(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=BY.bind(null,this.syncEngine),await pY(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return mY()}createDatastore(t){let r=ug(t.databaseInfo.databaseId),i=VQ(t.databaseInfo);return WQ(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return JQ(this.localStore,this.datastore,t.asyncQueue,r=>Ok(this.syncEngine,r,0),UQ())}createSyncEngine(t,r){return TY(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){await XQ(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}n.provider={build:()=>new n};return n})();var hT=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,e):Ln("Uncaught Error in snapshot listener:",e.toString()))}mute(){this.muted=!0}scheduleEvent(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Pi="FirestoreClient",qY=100,HY=11,$Y=20,zY=22,pT=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ft.UNAUTHENTICATED,this.clientId=xa.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{V(Pi,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(V(Pi,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:qY}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new kn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=UT(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Hb(n,e){n.asyncQueue.verifyOperationInProgress(),V(Pi,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await zP(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function kk(n,e){n.asyncQueue.verifyOperationInProgress();let t=await WY(n);V(Pi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>xk(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>xk(e.remoteStore,i)),n._onlineComponents=e}function GY(n){return n.name==="FirebaseError"?n.code===x.FAILED_PRECONDITION||n.code===x.UNIMPLEMENTED:typeof DOMException<"u"&&n instanceof DOMException?n.code===zY||n.code===$Y||n.code===HY:!0}async function WY(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V(Pi,"Using user provided OfflineComponentProvider");try{await Hb(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!GY(t))throw t;Ma("Error using user provided cache. Falling back to memory cache: "+t),await Hb(n,new uF)}}else V(Pi,"Using default OfflineComponentProvider"),await Hb(n,new fT(void 0));return n._offlineComponents}async function dF(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(V(Pi,"Using user provided OnlineComponentProvider"),await kk(n,n._uninitializedComponentsProvider._online)):(V(Pi,"Using default OnlineComponentProvider"),await kk(n,new jY))),n._onlineComponents}function KY(n){return dF(n).then(e=>e.syncEngine)}async function QY(n){let e=await dF(n),t=e.eventManager;return t.onListen=DY.bind(null,e.syncEngine),t.onUnlisten=AY.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wY.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=NY.bind(null,e.syncEngine),t}function YY(n,e,t={}){let r=new kn;return n.asyncQueue.enqueueAndForget(async()=>{let i=await QY(n);return JY(i,n.asyncQueue,e,t,r)}),r.promise}function ZY(n,e){let t=new kn;return n.asyncQueue.enqueueAndForget(async()=>{let r=await KY(n);return MY(r,e,t)}),t.promise}function JY(n,e,t,r,i){let s=new hT({next:a=>{s.mute(),e.enqueueAndForget(()=>vY(n,o)),a.fromCache&&r.source==="server"?i.reject(new U(x.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(a)},error:a=>i.reject(a)}),o=new sT(t,s,{includeMetadataChanges:!0,waitForSyncWhenOnline:!0});return yY(n,o)}function XY(n,e){return n.timeoutSeconds===e.timeoutSeconds}function fF(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var eZ="ComponentProvider",Pk=new Map;function tZ(n){let e=Pk.get(n);e&&(V(eZ,"Removing Datastore"),Pk.delete(n),e.terminate())}function nZ(n,e,t,r){return new Jb(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,fF(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}var hF="firestore.googleapis.com",Fk=!0,Lk=5,Bk=30,rZ=!0,Qp=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new U(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hF,this.ssl=Fk}else this.host=e.host,this.ssl=e.ssl??Fk;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$P;else{if(e.cacheSizeBytes!==lg&&e.cacheSizeBytes<Ik)throw new U(x.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${Ik}`);this.cacheSizeBytes=e.cacheSizeBytes}eW("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=rZ:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fF(e.experimentalLongPollingOptions??{}),iZ(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&XY(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};function iZ(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new U(x.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<Lk)throw new U(x.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is ${Lk})`);if(n.timeoutSeconds>Bk)throw new U(x.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is ${Bk})`)}}var $a=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qp({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new U(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new U(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qp(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=Q5(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return tZ(this),Promise.resolve()}};function sZ(n,e,t,r={}){n=Ap(n,$a);let i=tE(e),s=n._getSettings(),o=Ce(K({},s),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;i&&(dM(`https://${a}`),hM("Firestore",!0)),s.host!==hF&&s.host!==a&&Ma("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let c=Ce(K({},s),{host:a,ssl:i,emulatorOptions:r});if(!Bo(c,o)&&(n._setSettings(c),r.mockUserToken)){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=ft.MOCK_USER;else{l=fM(r.mockUserToken,n._app?.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new U(x.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new ft(d)}n._authCredentials=new zb(new Dp(l,u))}}var Yp=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},$t=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Oi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(cu(t,n._jsonSchema))return new n(e,r||null,new W(Be.fromString(t.referencePath)))}};$t._jsonSchemaVersion="firestore/documentReference/1.0";$t._jsonSchema={type:Je("string",$t._jsonSchemaVersion),referencePath:Je("string")};var Oi=class n extends Yp{constructor(e,t,r){super(e,t,EP(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new $t(this.firestore,null,new W(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function gme(n,e,...t){if(n=Vo(n),qk("collection","path",e),n instanceof $a){let r=Be.fromString(e,...t);return ck(r),new Oi(n,null,r)}else{if(!(n instanceof $t)&&!(n instanceof Oi))throw new U(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Be.fromString(e,...t));return ck(r),new Oi(n.firestore,null,r)}}function oZ(n,e,...t){if(n=Vo(n),arguments.length===1&&(e=xa.newId()),qk("doc","path",e),n instanceof $a){let r=Be.fromString(e,...t);return ak(r),new $t(n,null,new W(r))}else{if(!(n instanceof $t)&&!(n instanceof Oi))throw new U(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Be.fromString(e,...t));return ak(r),new $t(n.firestore,n instanceof Oi?n.converter:null,new W(r))}}var aZ="AsyncQueue",Zp=class{constructor(e=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new qp(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=e}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new kn;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}async retryNextOp(){if(this.retryableOps.length!==0){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(Za(e))V(aZ,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(r=>{this.failure=r,this.operationInProgress=!1;let i=Vk(r);throw Ln("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.operationInProgress=!1,r))));return this.tail=t,t}enqueueAfterDelay(e,t,r){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let i=nT.createAndSchedule(this,e,t,r,s=>this.removeDelayedOperation(s));return this.delayedOperations.push(i),i}verifyNotFailed(){this.failure&&Y(47125,{messageOrStack:Vk(this.failure)})}verifyOperationInProgress(){}async drain(){let e;do e=this.tail,await e;while(e!==this.tail)}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{this.delayedOperations.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.delayedOperations)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}};function Vk(n){let e=n.message||"";return n.stack&&(n.stack.includes(n.message)?e=n.stack:e=n.message+`
`+n.stack),e}var ou=class extends $a{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Zp,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Zp(e),this._firestoreClient=void 0,await e}}};function mme(n,e){let t=typeof n=="object"?n:xM(),r=typeof n=="string"?n:e||Xb,i=NM(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=uM("firestore");s&&sZ(i,...s)}return i}function pF(n){if(n._terminated)throw new U(x.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||cZ(n),n._firestoreClient}function cZ(n){let e=n._freezeSettings(),t=nZ(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new pT(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&lZ(n._componentsProvider))}function lZ(n){let e=n?._online.build();return{_offline:n?._offline.build(e),_online:e}}function uZ(n,e=!0){W5(RM),sl(new Ir("firestore",(t,{instanceIdentifier:r,options:i})=>{let s=t.getProvider("app").getImmediate(),o=new ou(new Gb(t.getProvider("auth-internal")),new Qb(s,t.getProvider("app-check-internal")),OW(s,r),s);return i=K({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),oi(ik,sk,n),oi(ik,sk,"esm2020")}var Fi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(At.fromBase64String(e))}catch(t){throw new U(x.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(At.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(cu(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Fi._jsonSchemaVersion="firestore/bytes/1.0";Fi._jsonSchema={type:Je("string",Fi._jsonSchemaVersion),bytes:Je("string")};var au=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new U(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new en(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Jp=class{constructor(e){this._methodName=e}};var Li=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new U(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new U(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ue(this._lat,e._lat)||ue(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(cu(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Li._jsonSchemaVersion="firestore/geoPoint/1.0";Li._jsonSchema={type:Je("string",Li._jsonSchemaVersion),latitude:Je("number"),longitude:Je("number")};var Bi=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return hQ(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(cu(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new U(x.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Bi._jsonSchemaVersion="firestore/vectorValue/1.0";Bi._jsonSchema={type:Je("string",Bi._jsonSchemaVersion),vectorValues:Je("object")};var dZ=/^__.*__$/,gT=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new zr(e,this.data,this.fieldMask,t,this.fieldTransforms):new zs(e,this.data,t,this.fieldTransforms)}};function gF(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y(40011,{dataSource:n})}}var mT=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(K(K({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return eg(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(gF(this.dataSource)&&dZ.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},Xp=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ug(e)}createContext(e,t,r,i=!1){return new mT({dataSource:e,methodName:t,targetDoc:r,path:en.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function fZ(n){let e=n._freezeSettings(),t=ug(n._databaseId);return new Xp(n._databaseId,!!e.ignoreUndefinedProperties,t)}function hZ(n,e,t,r,i,s={}){let o=n.createContext(s.merge||s.mergeFields?2:0,e,t,i);vF("Data must be an object, but it was:",o,r);let a=$T(r,o),c,l;if(s.merge)c=new dr(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let d of s.mergeFields){let f=vZ(e,d,t);if(!o.contains(f))throw new U(x.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);_Z(u,f)||u.push(f)}c=new dr(u),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new gT(new On(a),c,l)}function mF(n,e){if(n=Vo(n),yF(n))return vF("Unsupported field value:",e,n),$T(n,e);if(n instanceof Jp)return gZ(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return pZ(n,e)}else return mZ(n,e)}function $T(n,e){let t={};return rP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ws(n,(r,i)=>{let s=mF(i,e.childContextForField(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function pZ(n,e){let t=[],r=0;for(let i of n){let s=mF(i,e.childContextForArray(r));s==null&&(s={nullValue:"NULL_VALUE"}),t.push(s),r++}return{arrayValue:{values:t}}}function gZ(n,e){if(!gF(e.dataSource))throw e.createError(`${n._methodName}() can only be used with update() and set()`);if(!e.path)throw e.createError(`${n._methodName}() is not currently supported inside arrays`);let t=n._toFieldTransform(e);t&&e.fieldTransforms.push(t)}function mZ(n,e){if(n=Vo(n),n===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return O7(e.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let t=je.fromDate(n);return{timestampValue:Ur(e.serializer,t)}}else if(n instanceof je){let t=new je(n.seconds,Math.floor(n.nanoseconds/1e3)*1e3);return{timestampValue:Ur(e.serializer,t)}}else{if(n instanceof Li)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Fi)return{bytesValue:FP(e.serializer,n._byteString)};if(n instanceof $t){let t=e.databaseId,r=n.firestore._databaseId;if(!r.isEqual(t))throw e.createError(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${t.projectId}/${t.database}`);return{referenceValue:kT(n.firestore._databaseId||e.databaseId,n._key.path)}}else{if(n instanceof Bi)return yZ(n,e);throw e.createError(`Unsupported field value: ${ST(n)}`)}}}function yZ(n,e){return{mapValue:{fields:{[IT]:{stringValue:AT},[Oa]:{arrayValue:{values:n.toArray().map(r=>{if(typeof r!="number")throw e.createError("VectorValues must only contain numeric values.");return OT(e.serializer,r)})}}}}}}function yF(n){return typeof n=="object"&&n!==null&&!(n instanceof Array)&&!(n instanceof Date)&&!(n instanceof je)&&!(n instanceof Li)&&!(n instanceof Fi)&&!(n instanceof $t)&&!(n instanceof Jp)&&!(n instanceof Bi)}function vF(n,e,t){if(!yF(t)||!Hk(t)){let r=ST(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function vZ(n,e,t){if(e=Vo(e),e instanceof au)return e._internalPath;if(typeof e=="string")return EF(n,e);throw eg("Field path arguments must be of type string or ",n,!1,void 0,t)}var EZ=new RegExp("[~\\*/\\[\\]]");function EF(n,e,t){if(e.search(EZ)>=0)throw eg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new au(...e.split("."))._internalPath}catch{throw eg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function eg(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new U(x.INVALID_ARGUMENT,a+n+c)}function _Z(n,e){return n.some(t=>t.isEqual(e))}var tg=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new $t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document)if(this._converter){let e=new yT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}else return this._userDataWriter.convertValue(this._document.data.value);else return}get(e){if(this._document){let t=this._document.data.field(_F("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},yT=class extends tg{data(){return super.data()}};function _F(n,e){return typeof e=="string"?EF(n,e):e instanceof au?e._internalPath:e._delegate._internalPath}function CZ(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new U(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var vT=class{convertValue(e,t="none"){switch(ki(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(qr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Y(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Ws(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){let t=e.fields?.[Oa].arrayValue?.values?.map(r=>Le(r.doubleValue));return new Bi(t)}convertGeoPoint(e){return new Li(Le(e.latitude),Le(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=rg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Yl(e));default:return null}}convertTimestamp(e){let t=jr(e);return new je(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Be.fromString(e);Te(HP(r),9688,{name:e});let i=new Mp(r.get(1),r.get(3)),s=new W(r.popFirst(5));return i.isEqual(t)||Ln(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function bZ(n,e,t){let r;return n?t&&(t.merge||t.mergeFields)?r=n.toFirestore(e,t):r=n.toFirestore(e):r=e,r}var ET=kP();function Ui(n){let e=JSON.stringify(n);return`${ET.encode(e).byteLength}${e}`}var SZ={metadata:{id:"test-bundle",createTime:{seconds:1577836805,nanos:6},version:1,totalDocuments:1,totalBytes:416}};Ui(SZ);var TZ={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",readTime:{seconds:5,nanos:6},exists:!0}};Ui(TZ);var DZ={document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value"},bar:{integerValue:-42}}}};Ui(DZ);var wZ={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",readTime:{seconds:5,nanos:6},exists:!0}};Ui(wZ);var IZ={document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value1"},bar:{integerValue:42},emptyArray:{arrayValue:{}},emptyMap:{mapValue:{}}}}};Ui(IZ);var AZ={documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/nodoc",readTime:{seconds:5,nanos:6},exists:!1}};Ui(AZ);var NZ={namedQuery:{name:"limitQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"DESCENDING"}],limit:{value:1}},limitType:"FIRST"},readTime:{seconds:1590011379,nanos:191164e3}}};Ui(NZ);var MZ={namedQuery:{name:"limitToLastQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"ASCENDING"}],limit:{value:1}},limitType:"LAST"},readTime:{seconds:1590011379,nanos:543063e3}}};Ui(MZ);var RZ=1,ng=class{constructor(e,t){this.firestore=e,this.bundleId=t,this.documents=new Map,this.namedQueries=new Map,this.latestReadTime=new je(0,0),this.databaseId=e._databaseId,this.serializer=new Lp(this.databaseId,!0),this.userDataReader=new Xp(this.databaseId,!0,this.serializer)}addBundleDocument(e,t){let r=this.documents.get(e.documentPath),i=r?.metadata.queries,s=e.readTime,o=r?.metadata.readTime?PP(r.metadata.readTime):null,a=!s&&o==null,c=s!==void 0&&(o==null||o<s);if((a||c)&&this.documents.set(e.documentPath,{document:this.toBundleDocument(e),metadata:{name:nu(this.serializer,e.documentKey),readTime:s?Ur(this.serializer,s):void 0,exists:e.documentExists}}),s&&s>this.latestReadTime&&(this.latestReadTime=s),t){let l=this.documents.get(e.documentPath);l.metadata.queries=i||[],l.metadata.queries.push(t)}}addBundleQuery(e){if(this.namedQueries.has(e.name))throw new Error(`Query name conflict: ${name} has already been added.`);let t=new je(0,0);for(let s of e.docBundleDataArray)this.addBundleDocument(s,e.name),s.readTime&&s.readTime>t&&(t=s.readTime);let r=UP(this.serializer,Fn(e.query)),i={parent:e.parent,structuredQuery:r.queryTarget.structuredQuery};this.namedQueries.set(e.name,{name:e.name,bundledQuery:i,readTime:Ur(this.serializer,t)})}toBundleDocument(e){let t=this.userDataReader.createContext(4,"internal toBundledDocument"),r=$T(e.documentData,t);return{name:nu(this.serializer,e.documentKey),fields:r.mapValue.fields,updateTime:Ur(this.serializer,e.versionTime),createTime:Ur(this.serializer,e.createdTime)}}lengthPrefixedString(e){let t=JSON.stringify(e);return`${ET.encode(t).byteLength}${t}`}build(){let e="";for(let r of this.namedQueries.values())e+=this.lengthPrefixedString({namedQuery:r});for(let r of this.documents.values()){let i=r.metadata;e+=this.lengthPrefixedString({documentMetadata:i});let s=r.document;s&&(e+=this.lengthPrefixedString({document:s}))}let t={id:this.bundleId,createTime:Ur(this.serializer,this.latestReadTime),version:RZ,totalDocuments:this.documents.size,totalBytes:ET.encode(e).length};return e=this.lengthPrefixedString({metadata:t})+e,e}};function xZ(n,e,t,r){let i=new ng(n,xa.newId());return i.addBundleDocument(CF(r,t,e)),i.build()}function OZ(n,e,t,r,i,s,o){let a=[];for(let u=0;u<s.length;u++)a.push(CF(i[u],o[u],s[u]));let c={name:t,query:e,parent:r,docBundleDataArray:a},l=new ng(n,t);return l.addBundleQuery(c),l.build()}function CF(n,e,t){return{documentData:e,documentKey:t.mutableCopy().key,documentPath:n,documentExists:!0,createdTime:t.createTime.toTimestamp(),readTime:t.readTime.toTimestamp(),versionTime:t.version.toTimestamp()}}var za=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ga=class n extends tg{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document)if(this._converter){let t=new Wa(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}else return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);else return}get(e,t={}){if(this._document){let r=this._document.data.field(_F("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new U(x.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};if(t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument())return t;let r=this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous");return t.bundle=xZ(this._firestore,e,r,this.ref.path),t}};Ga._jsonSchemaVersion="firestore/documentSnapshot/1.0";Ga._jsonSchema={type:Je("string",Ga._jsonSchemaVersion),bundleSource:Je("string","DocumentSnapshot"),bundleName:Je("string"),bundle:Je("string")};var Wa=class extends Ga{data(e={}){return super.data(e)}},Ka=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new za(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Wa(this._firestore,this._userDataWriter,r.key,r,new za(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new U(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return(!this._cachedChanges||this._cachedChangesIncludeMetadataChanges!==t)&&(this._cachedChanges=kZ(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new U(x.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xa.newId();let t=this._firestore._databaseId.database,i=`projects/${this._firestore._databaseId.projectId}/databases/${t}/documents`,s=[],o=[],a=[];return this.docs.forEach(c=>{c._document!==null&&(s.push(c._document),o.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),a.push(c.ref.path))}),e.bundle=OZ(this._firestore,this.query._query,e.bundleName,i,a,s,o),e}};Ka._jsonSchemaVersion="firestore/querySnapshot/1.0";Ka._jsonSchema={type:Je("string",Ka._jsonSchemaVersion),bundleSource:Je("string","QuerySnapshot"),bundleName:Je("string"),bundle:Je("string")};function kZ(n,e){if(n._snapshot.oldDocs.isEmpty()){let t=0;return n._snapshot.docChanges.map(r=>{let i=new Wa(n._firestore,n._userDataWriter,r.doc.key,r.doc,new za(n._snapshot.mutatedKeys.has(r.doc.key),n._snapshot.fromCache),n.query.converter);return r.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}})}else{let t=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(r=>e||r.type!==3).map(r=>{let i=new Wa(n._firestore,n._userDataWriter,r.doc.key,r.doc,new za(n._snapshot.mutatedKeys.has(r.doc.key),n._snapshot.fromCache),n.query.converter),s=-1,o=-1;return r.type!==0&&(s=t.indexOf(r.doc.key),t=t.delete(r.doc.key)),r.type!==1&&(t=t.add(r.doc),o=t.indexOf(r.doc.key)),{type:PZ(r.type),doc:i,oldIndex:s,newIndex:o}})}}function PZ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y(61501,{type:n})}}var _T=class extends vT{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new $t(this.firestore,null,t)}};function yme(n){n=Ap(n,Yp);let e=Ap(n.firestore,ou),t=pF(e),r=new _T(e);return CZ(n._query),YY(t,n._query).then(i=>new Ka(e,r,n,i))}function vme(n,e){let t=Ap(n.firestore,ou),r=oZ(n),i=bZ(n.converter,e),s=fZ(n.firestore),a=hZ(s,"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Bs.exists(!1));return FZ(t,[a]).then(()=>r)}function FZ(n,e){let t=pF(n);return ZY(t,e)}uZ("node");var Sme={production:!1,firebaseConfig:{apiKey:"AIzaSyBga623ULNDTfLSee4rBo1mvRtmrpqEBjY",authDomain:"astro-site-5f426.firebaseapp.com",projectId:"astro-site-5f426",storageBucket:"astro-site-5f426.firebasestorage.app",messagingSenderId:"263641164662",appId:"1:263641164662:web:3cbca6c215ada4de122857",measurementId:"G-F2VDCYLTEB"}};export{rt as a,PF as b,ye as c,Mg as d,Rg as e,Cn as f,sc as g,oc as h,nX as i,Un as j,zF as k,GF as l,WF as m,$i as n,gr as o,tL as p,zi as q,$u as r,rL as s,ac as t,bD as u,iL as v,cc as w,Og as x,oL as y,aL as z,kg as A,cL as B,lL as C,uL as D,dL as E,fL as F,hL as G,Q as H,ve as I,mL as J,$ as K,$e as L,G as M,lo as N,hm as O,tn as P,ed as Q,XD as R,ew as S,gw as T,nn as U,cs as V,ls as W,Zi as X,bn as Y,jL as Z,Jr as _,Xr as $,yw as aa,XL as ba,ms as ca,Fc as da,w2 as ea,mI as fa,yI as ga,A2 as ha,N2 as ia,M2 as ja,Fd as ka,Uy as la,AI as ma,hs as na,dB as oa,Mc as pa,Rc as qa,No as ra,de as sa,qc as ta,Sr as ua,J0 as va,eA as wa,mU as xa,st as ya,sA as za,fv as Aa,St as Ba,gt as Ca,LU as Da,mA as Ea,BU as Fa,Ro as Ga,CA as Ha,Es as Ia,UU as Ja,jU as Ka,HU as La,$U as Ma,SA as Na,Sv as Oa,Tv as Pa,TA as Qa,DA as Ra,wA as Sa,QU as Ta,xo as Ua,ZU as Va,JU as Wa,zc as Xa,gj as Ya,OA as Za,wv as _a,kA as $a,Ej as ab,PA as bb,Ij as cb,Aj as db,Rj as eb,Zd as fb,Tn as gb,Gue as hb,Kc as ib,Wue as jb,Zj as kb,nN as lb,t3 as mb,tf as nb,Kue as ob,Que as pb,Yue as qb,Zue as rb,Jue as sb,Xue as tb,ede as ub,tde as vb,nde as wb,rde as xb,ide as yb,Cs as zb,E3 as Ab,Lv as Bb,Bv as Cb,vN as Db,_N as Eb,SN as Fb,S3 as Gb,T3 as Hb,D3 as Ib,Vv as Jb,w3 as Kb,Hfe as Lb,$fe as Mb,zfe as Nb,Uv as Ob,kN as Pb,TN as Qb,phe as Rb,ghe as Sb,Y3 as Tb,X3 as Ub,yhe as Vb,t4 as Wb,r4 as Xb,o4 as Yb,c4 as Zb,vhe as _b,Ehe as $b,_he as ac,SM as bc,gq as cc,hC as dc,rk as ec,gme as fc,mme as gc,yme as hc,vme as ic,Sme as jc};
